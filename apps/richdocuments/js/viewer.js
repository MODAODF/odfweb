!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/js/",n(n.s=114)}([function(e,t,n){(function(t){var n="object",i=function(e){return e&&e.Math==Math&&e};e.exports=i(typeof globalThis==n&&globalThis)||i(typeof window==n&&window)||i(typeof self==n&&self)||i(typeof t==n&&t)||Function("return this")()}).call(this,n(22))},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){"use strict";
/*
 * @copyright Copyright (c) 2019 Julius Härtl <jus@bitgrid.net>
 *
 * @author Julius Härtl <jus@bitgrid.net>
 *
 * @license GNU AGPL version 3 or any later version
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 *
 */var i=new(function(){function e(){this.values={},this.loadFromGlobal("userId"),this.loadFromGlobal("urlsrc"),this.loadFromGlobal("directEdit"),this.loadFromGlobal("permissions"),this.loadFromGlobal("instanceId")}return e.prototype.loadFromGlobal=function(e){this.values[e]=window["richdocuments_"+e]},e.prototype.update=function(e,t){this.values[e]=t},e.prototype.get=function(e){return void 0===this.values[e]&&this.loadFromGlobal(e),this.values[e]},e}());t.a=i},function(e,t,n){var i=n(1);e.exports=!i((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var i=n(3),r=n(29),o=n(25);e.exports=i?function(e,t,n){return r.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var i=n(9);e.exports=function(e){if(!i(e))throw TypeError(String(e)+" is not an object");return e}},function(e,t,n){var i=n(0),r=n(10),o=n(5),a=n(4),s=n(18),c=n(30),l=n(44),d=l.get,u=l.enforce,f=String(c).split("toString");r("inspectSource",(function(e){return c.call(e)})),(e.exports=function(e,t,n,r){var c=!!r&&!!r.unsafe,l=!!r&&!!r.enumerable,d=!!r&&!!r.noTargetGet;"function"==typeof n&&("string"!=typeof t||a(n,"name")||o(n,"name",t),u(n).source=f.join("string"==typeof t?t:"")),e!==i?(c?!d&&e[t]&&(l=!0):delete e[t],l?e[t]=n:o(e,t,n)):l?e[t]=n:s(t,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&d(this).source||c.call(this)}))},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){var i=n(0),r=n(18),o=n(43),a=i["__core-js_shared__"]||r("__core-js_shared__",{});(e.exports=function(e,t){return a[e]||(a[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.2.1",mode:o?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(e,t){var n=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:n)(e)}},function(e,t,n){"use strict";var i=n(14),r=n(70),o=n(2);n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return d}));
/*
 * @copyright Copyright (c) 2019 Julius Härtl <jus@bitgrid.net>
 *
 * @author Julius Härtl <jus@bitgrid.net>
 *
 * @license GNU AGPL version 3 or any later version
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 *
 */
var a=function(e){var t=new RegExp("[?&]"+e+"=([^&#]*)").exec(window.location.href);return null===t?null:decodeURI(t[1])||0},s=function(e){var t=e.fileId,n=e.title,a=e.readOnly,s=e.closeButton,c=e.revisionHistory,l=window.location.protocol+"//"+window.location.host+Object(i.getRootUrl)()+"/index.php/apps/richdocuments/wopi/files/"+t;console.debug("[getWopiUrl] "+l);var d=encodeURIComponent(l);return o.a.get("urlsrc")+"WOPISrc="+d+"&title="+encodeURIComponent(n)+"&lang="+Object(r.getLanguage)().replace(/^([a-z]{2}).*_([A-Z]{2})$/,(function(e,t,n){return t+"-"+n.toLowerCase()}))+(s?"&closebutton=1":"")+(c?"&revisionhistory=1":"")+(a?"&permission=readonly":"")},c=function(e,t,n,i){return OC.generateUrl("apps/richdocuments/indexTemplate?templateId={templateId}&fileName={fileName}&dir={dir}&requesttoken={requesttoken}",{templateId:e,fileName:t,dir:n,requesttoken:OC.requestToken})},l=function(e,t){return OC.generateUrl("apps/richdocuments/public?shareToken={shareToken}&fileName={fileName}&requesttoken={requesttoken}&fileId={fileId}",{shareToken:document.getElementById("sharingToken").value,fileName:e,fileId:t,requesttoken:OC.requestToken})},d=function(e,t){return OC.generateUrl("apps/richdocuments/index?fileId={fileId}&requesttoken={requesttoken}",{fileId:t,dir:e,requesttoken:OC.requestToken})}},,function(e,t,n){"use strict";n(41),n(55),n(56),n(59),n(63),n(64),n(65),Object.defineProperty(t,"__esModule",{value:!0}),t.getRootUrl=t.generateFilePath=t.imagePath=t.generateUrl=t.generateOcsUrl=t.generateRemoteUrl=t.linkTo=void 0;t.linkTo=function(e,t){return i(e,"",t)};t.generateRemoteUrl=function(e){return window.location.protocol+"//"+window.location.host+function(e){return r()+"/remote.php/"+e}(e)};t.generateOcsUrl=function(e,t){return t=2!==t?1:2,window.location.protocol+"//"+window.location.host+r()+"/ocs/v"+t+".php/"+e+"/"};t.generateUrl=function(e,t,n){var i=Object.assign({escape:!0,noRewrite:!1},n||{}),o=function(e,t){return t=t||{},e.replace(/{([^{}]*)}/g,(function(e,n){var r=t[n];return i.escape?"string"==typeof r||"number"==typeof r?encodeURIComponent(r.toString()):encodeURIComponent(e):"string"==typeof r||"number"==typeof r?r.toString():e}))};return"/"!==e.charAt(0)&&(e="/"+e),!0!==OC.config.modRewriteWorking||i.noRewrite?r()+"/index.php"+o(e,t||{}):r()+o(e,t||{})};t.imagePath=function(e,t){return-1===t.indexOf(".")?i(e,"img",t+".svg"):i(e,"img",t)};var i=function(e,t,n){var i=-1!==OC.coreApps.indexOf(e),o=r();return"php"!==n.substring(n.length-3)||i?"php"===n.substring(n.length-3)||i?(o+="settings"!==e&&"core"!==e&&"search"!==e||"ajax"!==t?"/":"/index.php/",i||(o+="apps/"),""!==e&&(o+=e+="/"),t&&(o+=t+"/"),o+=n):(o=OC.appswebroots[e],t&&(o+="/"+t+"/"),"/"!==o.substring(o.length-1)&&(o+="/"),o+=n):(o+="/index.php/apps/"+e,"index.php"!==n&&(o+="/",t&&(o+=encodeURI(t+"/")),o+=n)),o};t.generateFilePath=i;var r=function(){return OC.webroot};t.getRootUrl=r},function(e,t,n){var i=n(0),r=n(23).f,o=n(5),a=n(7),s=n(18),c=n(47),l=n(53);e.exports=function(e,t){var n,d,u,f,p,m=e.target,h=e.global,v=e.stat;if(n=h?i:v?i[m]||s(m,{}):(i[m]||{}).prototype)for(d in t){if(f=t[d],u=e.noTargetGet?(p=r(n,d))&&p.value:n[d],!l(h?d:m+(v?".":"#")+d,e.forced)&&void 0!==u){if(typeof f==typeof u)continue;c(f,u)}(e.sham||u&&u.sham)&&o(f,"sham",!0),a(n,d,f,e)}}},function(e,t,n){var i=n(26),r=n(8);e.exports=function(e){return i(r(e))}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var i=n(0),r=n(5);e.exports=function(e,t){try{r(i,e,t)}catch(n){i[e]=t}return t}},function(e,t,n){var i=n(0),r=n(10),o=n(31),a=n(62),s=i.Symbol,c=r("wks");e.exports=function(e){return c[e]||(c[e]=a&&s[e]||(a?s:o)("Symbol."+e))}},function(e,t,n){"use strict";var i,r,o=n(39),a=RegExp.prototype.exec,s=String.prototype.replace,c=a,l=(i=/a/,r=/b*/g,a.call(i,"a"),a.call(r,"a"),0!==i.lastIndex||0!==r.lastIndex),d=void 0!==/()??/.exec("")[1];(l||d)&&(c=function(e){var t,n,i,r,c=this;return d&&(n=new RegExp("^"+c.source+"$(?!\\s)",o.call(c))),l&&(t=c.lastIndex),i=a.call(c,e),l&&i&&(c.lastIndex=c.global?i.index+i[0].length:t),d&&i&&i.length>1&&s.call(i[0],n,(function(){for(r=1;r<arguments.length-2;r++)void 0===arguments[r]&&(i[r]=void 0)})),i}),e.exports=c},,function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var i=n(3),r=n(24),o=n(25),a=n(16),s=n(27),c=n(4),l=n(28),d=Object.getOwnPropertyDescriptor;t.f=i?d:function(e,t){if(e=a(e),t=s(t,!0),l)try{return d(e,t)}catch(e){}if(c(e,t))return o(!r.f.call(e,t),e[t])}},function(e,t,n){"use strict";var i={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,o=r&&!i.call({1:2},1);t.f=o?function(e){var t=r(this,e);return!!t&&t.enumerable}:i},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var i=n(1),r=n(17),o="".split;e.exports=i((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==r(e)?o.call(e,""):Object(e)}:Object},function(e,t,n){var i=n(9);e.exports=function(e,t){if(!i(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!i(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){var i=n(3),r=n(1),o=n(42);e.exports=!i&&!r((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var i=n(3),r=n(28),o=n(6),a=n(27),s=Object.defineProperty;t.f=i?s:function(e,t,n){if(o(e),t=a(t,!0),o(n),r)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var i=n(10);e.exports=i("native-function-to-string",Function.toString)},function(e,t){var n=0,i=Math.random();e.exports=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++n+i).toString(36)}},function(e,t){e.exports={}},function(e,t,n){var i=n(4),r=n(16),o=n(34).indexOf,a=n(32);e.exports=function(e,t){var n,s=r(e),c=0,l=[];for(n in s)!i(a,n)&&i(s,n)&&l.push(n);for(;t.length>c;)i(s,n=t[c++])&&(~o(l,n)||l.push(n));return l}},function(e,t,n){var i=n(16),r=n(35),o=n(52),a=function(e){return function(t,n,a){var s,c=i(t),l=r(c.length),d=o(a,l);if(e&&n!=n){for(;l>d;)if((s=c[d++])!=s)return!0}else for(;l>d;d++)if((e||d in c)&&c[d]===n)return e||d||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},function(e,t,n){var i=n(11),r=Math.min;e.exports=function(e){return e>0?r(i(e),9007199254740991):0}},function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var i=n(8);e.exports=function(e){return Object(i(e))}},function(e,t,n){"use strict";var i=n(6);e.exports=function(){var e=i(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},,function(e,t,n){"use strict";var i=n(15),r=n(34).indexOf,o=n(54),a=[].indexOf,s=!!a&&1/[1].indexOf(1,-0)<0,c=o("indexOf");i({target:"Array",proto:!0,forced:s||c},{indexOf:function(e){return s?a.apply(this,arguments)||0:r(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var i=n(0),r=n(9),o=i.document,a=r(o)&&r(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},function(e,t){e.exports=!1},function(e,t,n){var i,r,o,a=n(45),s=n(0),c=n(9),l=n(5),d=n(4),u=n(46),f=n(32),p=s.WeakMap;if(a){var m=new p,h=m.get,v=m.has,g=m.set;i=function(e,t){return g.call(m,e,t),t},r=function(e){return h.call(m,e)||{}},o=function(e){return v.call(m,e)}}else{var w=u("state");f[w]=!0,i=function(e,t){return l(e,w,t),t},r=function(e){return d(e,w)?e[w]:{}},o=function(e){return d(e,w)}}e.exports={set:i,get:r,has:o,enforce:function(e){return o(e)?r(e):i(e,{})},getterFor:function(e){return function(t){var n;if(!c(t)||(n=r(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}}},function(e,t,n){var i=n(0),r=n(30),o=i.WeakMap;e.exports="function"==typeof o&&/native code/.test(r.call(o))},function(e,t,n){var i=n(10),r=n(31),o=i("keys");e.exports=function(e){return o[e]||(o[e]=r(e))}},function(e,t,n){var i=n(4),r=n(48),o=n(23),a=n(29);e.exports=function(e,t){for(var n=r(t),s=a.f,c=o.f,l=0;l<n.length;l++){var d=n[l];i(e,d)||s(e,d,c(t,d))}}},function(e,t,n){var i=n(49),r=n(51),o=n(37),a=n(6);e.exports=i("Reflect","ownKeys")||function(e){var t=r.f(a(e)),n=o.f;return n?t.concat(n(e)):t}},function(e,t,n){var i=n(50),r=n(0),o=function(e){return"function"==typeof e?e:void 0};e.exports=function(e,t){return arguments.length<2?o(i[e])||o(r[e]):i[e]&&i[e][t]||r[e]&&r[e][t]}},function(e,t,n){e.exports=n(0)},function(e,t,n){var i=n(33),r=n(36).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return i(e,r)}},function(e,t,n){var i=n(11),r=Math.max,o=Math.min;e.exports=function(e,t){var n=i(e);return n<0?r(n+t,0):o(n,t)}},function(e,t,n){var i=n(1),r=/#|\.prototype\./,o=function(e,t){var n=s[a(e)];return n==l||n!=c&&("function"==typeof t?i(t):!!t)},a=o.normalize=function(e){return String(e).replace(r,".").toLowerCase()},s=o.data={},c=o.NATIVE="N",l=o.POLYFILL="P";e.exports=o},function(e,t,n){"use strict";var i=n(1);e.exports=function(e,t){var n=[][e];return!n||!i((function(){n.call(null,t||function(){throw 1},1)}))}},function(e,t,n){var i=n(7),r=Date.prototype,o=r.toString,a=r.getTime;new Date(NaN)+""!="Invalid Date"&&i(r,"toString",(function(){var e=a.call(this);return e==e?o.call(this):"Invalid Date"}))},function(e,t,n){var i=n(15),r=n(57);i({target:"Object",stat:!0,forced:Object.assign!==r},{assign:r})},function(e,t,n){"use strict";var i=n(3),r=n(1),o=n(58),a=n(37),s=n(24),c=n(38),l=n(26),d=Object.assign;e.exports=!d||r((function(){var e={},t={},n=Symbol();return e[n]=7,"abcdefghijklmnopqrst".split("").forEach((function(e){t[e]=e})),7!=d({},e)[n]||"abcdefghijklmnopqrst"!=o(d({},t)).join("")}))?function(e,t){for(var n=c(e),r=arguments.length,d=1,u=a.f,f=s.f;r>d;)for(var p,m=l(arguments[d++]),h=u?o(m).concat(u(m)):o(m),v=h.length,g=0;v>g;)p=h[g++],i&&!f.call(m,p)||(n[p]=m[p]);return n}:d},function(e,t,n){var i=n(33),r=n(36);e.exports=Object.keys||function(e){return i(e,r)}},function(e,t,n){var i=n(7),r=n(60),o=Object.prototype;r!==o.toString&&i(o,"toString",r,{unsafe:!0})},function(e,t,n){"use strict";var i=n(61),r={};r[n(19)("toStringTag")]="z",e.exports="[object z]"!==String(r)?function(){return"[object "+i(this)+"]"}:r.toString},function(e,t,n){var i=n(17),r=n(19)("toStringTag"),o="Arguments"==i(function(){return arguments}());e.exports=function(e){var t,n,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),r))?n:o?i(t):"Object"==(a=i(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t,n){var i=n(1);e.exports=!!Object.getOwnPropertySymbols&&!i((function(){return!String(Symbol())}))},function(e,t,n){"use strict";var i=n(15),r=n(20);i({target:"RegExp",proto:!0,forced:/./.exec!==r},{exec:r})},function(e,t,n){"use strict";var i=n(7),r=n(6),o=n(1),a=n(39),s=RegExp.prototype,c=s.toString,l=o((function(){return"/a/b"!=c.call({source:"a",flags:"b"})})),d="toString"!=c.name;(l||d)&&i(RegExp.prototype,"toString",(function(){var e=r(this),t=String(e.source),n=e.flags;return"/"+t+"/"+String(void 0===n&&e instanceof RegExp&&!("flags"in s)?a.call(e):n)}),{unsafe:!0})},function(e,t,n){"use strict";var i=n(66),r=n(6),o=n(38),a=n(35),s=n(11),c=n(8),l=n(67),d=n(69),u=Math.max,f=Math.min,p=Math.floor,m=/\$([$&'`]|\d\d?|<[^>]*>)/g,h=/\$([$&'`]|\d\d?)/g;i("replace",2,(function(e,t,n){return[function(n,i){var r=c(this),o=null==n?void 0:n[e];return void 0!==o?o.call(n,r,i):t.call(String(r),n,i)},function(e,o){var c=n(t,e,this,o);if(c.done)return c.value;var p=r(e),m=String(this),h="function"==typeof o;h||(o=String(o));var v=p.global;if(v){var g=p.unicode;p.lastIndex=0}for(var w=[];;){var y=d(p,m);if(null===y)break;if(w.push(y),!v)break;""===String(y[0])&&(p.lastIndex=l(m,a(p.lastIndex),g))}for(var b,x="",O=0,C=0;C<w.length;C++){y=w[C];for(var F=String(y[0]),I=u(f(s(y.index),m.length),0),M=[],_=1;_<y.length;_++)M.push(void 0===(b=y[_])?b:String(b));var E=y.groups;if(h){var S=[F].concat(M,I,m);void 0!==E&&S.push(E);var $=String(o.apply(void 0,S))}else $=i(F,m,I,M,E,o);I>=O&&(x+=m.slice(O,I)+$,O=I+F.length)}return x+m.slice(O)}];function i(e,n,i,r,a,s){var c=i+e.length,l=r.length,d=h;return void 0!==a&&(a=o(a),d=m),t.call(s,d,(function(t,o){var s;switch(o.charAt(0)){case"$":return"$";case"&":return e;case"`":return n.slice(0,i);case"'":return n.slice(c);case"<":s=a[o.slice(1,-1)];break;default:var d=+o;if(0===d)return t;if(d>l){var u=p(d/10);return 0===u?t:u<=l?void 0===r[u-1]?o.charAt(1):r[u-1]+o.charAt(1):t}s=r[d-1]}return void 0===s?"":s}))}}))},function(e,t,n){"use strict";var i=n(5),r=n(7),o=n(1),a=n(19),s=n(20),c=a("species"),l=!o((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),d=!o((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));e.exports=function(e,t,n,u){var f=a(e),p=!o((function(){var t={};return t[f]=function(){return 7},7!=""[e](t)})),m=p&&!o((function(){var t=!1,n=/a/;return n.exec=function(){return t=!0,null},"split"===e&&(n.constructor={},n.constructor[c]=function(){return n}),n[f](""),!t}));if(!p||!m||"replace"===e&&!l||"split"===e&&!d){var h=/./[f],v=n(f,""[e],(function(e,t,n,i,r){return t.exec===s?p&&!r?{done:!0,value:h.call(t,n,i)}:{done:!0,value:e.call(n,t,i)}:{done:!1}})),g=v[0],w=v[1];r(String.prototype,e,g),r(RegExp.prototype,f,2==t?function(e,t){return w.call(e,this,t)}:function(e){return w.call(e,this)}),u&&i(RegExp.prototype[f],"sham",!0)}}},function(e,t,n){"use strict";var i=n(68).charAt;e.exports=function(e,t,n){return t+(n?i(e,t).length:1)}},function(e,t,n){var i=n(11),r=n(8),o=function(e){return function(t,n){var o,a,s=String(r(t)),c=i(n),l=s.length;return c<0||c>=l?e?"":void 0:(o=s.charCodeAt(c))<55296||o>56319||c+1===l||(a=s.charCodeAt(c+1))<56320||a>57343?e?s.charAt(c):o:e?s.slice(c,c+2):a-56320+(o-55296<<10)+65536}};e.exports={codeAt:o(!1),charAt:o(!0)}},function(e,t,n){var i=n(17),r=n(20);e.exports=function(e,t){var n=e.exec;if("function"==typeof n){var o=n.call(e,t);if("object"!=typeof o)throw TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==i(e))throw TypeError("RegExp#exec called on incompatible receiver");return r.call(e,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLocale=function(){return OC.getLocale()},t.getLanguage=function(){return OC.getLanguage()},t.translate=function(e,t,n,i,r){return OC.L10N.translate(e,t,n,i,r)},t.translatePlural=function(e,t,n,i,r,o){return OC.L10N.translatePlural(e,t,n,i,r,o)}},function(e,t,n){"use strict";var i=function(){function e(e){var t=this;this.postMessageHandlers=[],this.targets=e,window.addEventListener("message",(function(e){t.handlePostMessage(e.data)}),!1)}return e.prototype.sendPostMessage=function(e,t,n){void 0===n&&(n="*"),("function"==typeof this.targets[e]?this.targets[e]():this.targets[e]).postMessage(t,n),console.debug("PostMessageService.sendPostMessage",e,t)},e.prototype.sendWOPIPostMessage=function(e,t,n){void 0===n&&(n={});var i={MessageId:t,SendTime:Date.now(),Values:n};this.sendPostMessage(e,JSON.stringify(i))},e.parsePostMessage=function(e){var t,n,i;try{var r=JSON.parse(e);t=r.MessageId,n=r.Values,i=!!r.Values.Deprecated}catch(n){t=e}return{msgId:t,args:n,deprecated:i}},e.prototype.registerPostMessageHandler=function(e){this.postMessageHandlers.push(e)},e.prototype.unregisterPostMessageHandler=function(e){var t=this.postMessageHandlers.findIndex((function(t){return t===e}));delete this.postMessageHandlers[t]},e.prototype.handlePostMessage=function(t){var n=e.parsePostMessage(t);void 0!==n&&this.postMessageHandlers.forEach((function(e){n.deprecated?console.debug("PostMessageService.handlePostMessage","Ignoring deprecated post message",n.msgId):e({data:t,parsed:n})}))},e}();t.a=i},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,n,i){"use strict";i.r(n);var r=i(12),o=i(71),a=i(2),s=function(e,t){var n={document:{extension:"odt",mime:"application/vnd.oasis.opendocument.text"},spreadsheet:{extension:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"},presentation:{extension:"odp",mime:"application/vnd.oasis.opendocument.presentation"}};return t&&(n={document:{extension:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"},spreadsheet:{extension:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},presentation:{extension:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"}}),n[e]},c=document.getElementById("isPublic")&&"1"===document.getElementById("isPublic").value,l={fileModel:null,views:{},followingEditor:!1,following:null,init:function(e){var t=e.fileName,n=e.fileId,i=e.sendPostMessage;this.fileName=t,this.fileId=n,this.sendPostMessage=i},initAfterReady:function(){void 0!==this.getFileList()&&this.getFileModel();var e=document.querySelector("#header .header-right"),t=document.createElement("div");t.id="richdocuments-header",e.insertBefore(t,e.firstChild),this._addAvatarList(),c||(this._addHeaderShareButton(),this._addHeaderFileActions(),this.addVersionSidebarEvents())},close:function(){this.fileModel=null,c||this.removeVersionSidebarEvents(),$("#richdocuments-header").remove()},share:function(){c&&console.error("[FilesAppIntegration] Sharing is not supported"),FileList.showDetailsView(this.fileName,"shareTabView"),OC.Apps.showAppSidebar()},insertGraphic:function(e){c&&console.error("[FilesAppIntegration] insertGraphic is not supported"),OC.dialogs.filepicker(t("richdocuments","Insert from {name}",{name:OC.theme.name}),(function(t,n){if(n===OC.dialogs.FILEPICKER_TYPE_CHOOSE){var i=t.substring(t.lastIndexOf("/")+1);$.ajax({type:"POST",url:OC.generateUrl("apps/richdocuments/assets"),data:{path:t}}).done((function(t){e(i,t.url)}))}}),!1,["image/png","image/gif","image/jpeg","image/svg"],!0,OC.dialogs.FILEPICKER_TYPE_CHOOSE)},getFileList:function(){return OCA.Files.App?OCA.Files.App.fileList:OCA.Sharing.PublicApp?OCA.Sharing.PublicApp.fileList:null},getFileModel:function(){var e=this;return null!==this.fileModel?this.fileModel:(this.getFileList()._updateDetailsView(this.fileName,!1),this.fileModel=this.getFileList().getModelForFile(this.fileName),null!==this.fileModel&&this.fileModel.on("change",(function(){e._addHeaderFileActions()})),this.fileModel)},setViews:function(e){var t=this;this.views={},e.forEach((function(e){t.views[e.ViewId]=e})),this.renderAvatars()},followReset:function(e){this.sendPostMessage("Action_FollowUser",{Follow:!1}),this.following=null,this.followingEditor=!1,this.renderAvatars()},followCurrentEditor:function(e){this.sendPostMessage("Action_FollowUser",{Follow:!0}),this.following=null,this.followingEditor=!0,this.renderAvatars()},followView:function(e){this.sendPostMessage("Action_FollowUser",{ViewId:e.ViewId,Follow:!0}),this.following=e.ViewId,this.followingEditor=!1,this.renderAvatars()},_addAvatarList:function(){var e=$('<div id="richdocuments-avatars">');e.on("click",(function(e){e.stopPropagation(),$("#editors-menu").toggle()})),$("#richdocuments-header").append(e)},_addHeaderShareButton:function(){var e=this;if($("header").length){var t=$('<div id="richdocuments-sharing"><a class="icon-shared icon-white"></a></div>');$("#richdocuments-header").append(t),t.on("click",(function(){if(!$("#app-sidebar").is(":visible"))return e.share();OC.Apps.hideAppSidebar()})),$(".searchbox").hide()}},_addHeaderFileActions:function(){var e=this;console.debug("[FilesAppIntegration] Adding header file actions"),OC.unregisterMenu($("#richdocuments-actions .icon-more"),$("#richdocuments-actions-menu")),$("#richdocuments-actions").remove();var n,i=$('<div id="richdocuments-actions"><div class="icon-more icon-white"></div><ul id="richdocuments-actions-menu" class="popovermenu"></ul></div>'),r=i.find("#richdocuments-actions-menu").empty(),o={$file:this.getFileList().$el.find("[data-id="+this.originalFileId+"]").first(),fileActions:this.getFileList().fileActions,fileList:this.getFileList(),fileInfoModel:this.getFileModel()},a=$("<li><a></a></li>").click((function(t){a.find("a").removeClass("icon-starred").removeClass("icon-star-dark").addClass("icon-loading-small"),e.getFileList().fileActions.triggerAction("Favorite",e.getFileModel(),e.getFileList()),e.getFileModel().trigger("change",e.getFileModel())}));(n=o.fileInfoModel).get("tags")&&n.get("tags").indexOf(OC.TAG_FAVORITE)>=0?(a.find("a").text(t("files","Remove from favorites")),a.find("a").addClass("icon-starred")):(a.find("a").text(t("files","Add to favorites")),a.find("a").addClass("icon-star-dark"));var s=$('<li><a class="icon-info"></a></li>').click((function(){e.getFileList().fileActions.actions.all.Details.action(e.fileName,o),OC.hideMenus()}));s.find("a").text(t("files","Details"));var c=$('<li><a class="icon-download">Download</a></li>').click((function(){e.getFileList().fileActions.actions.all.Download.action(e.fileName,o),OC.hideMenus()}));c.find("a").text(t("files","Download")),r.append(a).append(s).append(c),$("#richdocuments-header").append(i),OC.registerMenu($("#richdocuments-actions .icon-more"),$("#richdocuments-actions-menu"),!1,!0)},_userEntry:function(e){var n=this,i=$("<li></li>");i.append(this._avatarForView(e));var r=$('<div class="label"></div>');r.text(e.UserName),"1"===e.ReadOnly&&r.text(e.UserName+" "+t("richdocuments","(read only)")),r.click((function(t){t.stopPropagation(),n.followView(e)})),this.following===e.ViewId&&($("#editors-menu").find("li").removeClass("active"),i.addClass("active")),i.append(r);var o=!c&&this.getFileModel()&&void 0===this.getFileModel().get("shareOwner"),a=this.getFileModel()&&!!(this.getFileModel().get("permissions")&OC.PERMISSION_UPDATE);if(o&&a&&!e.IsCurrentView){var s=$('<div class="icon-close" title="Remove user"/>');s.click((function(){n.sendPostMessage("Action_RemoveView",{ViewId:e.ViewId})})),i.append(s)}return i},_avatarForView:function(e){var n=""===e.UserId?e.UserName:e.UserId,i=$('<div class="richdocuments-avatar"><div class="avatar" title="'+e.UserName+'" data-user="'+n+'"></div></div>'),r=i.find(".avatar");return r.css({"border-color":e.Color,"border-width":"2px","border-style":"solid"}),"1"===e.ReadOnly?(i.addClass("read-only"),$(r).attr("title",e.UserName+" "+t("richdocuments","(read only)"))):$(r).attr("title",e.UserName),$(r).avatar(n,32,void 0,!0,void 0,e.UserName),i},renderAvatars:function(){var e=this,n=$("#header .header-right #richdocuments-avatars");n.empty();var i=$('<div id="editors-menu" class="popovermenu menu-center"><ul></ul></div>'),r=[],o=0;for(var a in this.views){var s=this.views[a];s.UserName=""!==s.UserName?s.UserName:t("richdocuments","Guest"),i.find("ul").append(this._userEntry(s)),s.UserId!==OC.currentUser&&(""!==s.UserId&&r.indexOf(s.UserId)>-1||(r.push(s.UserId),o++<3&&n.append(this._avatarForView(s))))}var c=$('<li><input type="checkbox" class="checkbox" /><label class="label">'+t("richdocuments","Follow current editor")+"</label></li>");c.find("label").click((function(t){t.stopPropagation(),e.followingEditor?e.followReset():e.followCurrentEditor()})),c.find(".checkbox").prop("checked",this.followingEditor),i.find("ul").append(c),n.append(i)},addVersionSidebarEvents:function(){$(document.querySelector("#content")).on("click.revisions","#app-sidebar .preview-container",this.showVersionPreview.bind(this)),$(document.querySelector("#content")).on("click.revisions","#app-sidebar .downloadVersion",this.showVersionPreview.bind(this)),$(document.querySelector("#content")).on("mousedown.revisions","#app-sidebar .revertVersion",this.restoreVersion.bind(this))},removeVersionSidebarEvents:function(){$(document.querySelector("#content")).off("click.revisions"),$(document.querySelector("#content")).off("click.revisions"),$(document.querySelector("#content")).off("mousedown.revisions")},addCurrentVersion:function(){if(this.getFileModel()){var e=OC.MimeType.getIconUrl(this.getFileModel().get("mimetype")),n=this.getFileModel().get("mtime");$("#versionsTabView").prepend('<ul id="lastSavedVersion"><li data-revision="0"><div><div class="preview-container"><img src="'+e+'" width="44" /></div><div class="version-container">\n<div><a class="downloadVersion">'+t("richdocuments","Last saved version")+'<span class="versiondate has-tooltip live-relative-timestamp" data-timestamp="'+n+'"></span></div></div></li></ul>'),$("#versionsTabView").prepend('<ul id="currentVersion"><li data-revision="" class="active"><div><div class="preview-container"><img src="'+e+'" width="44" /></div><div class="version-container">\n<div><a class="downloadVersion">'+t("richdocuments","Current version")+"</a></div></div></li></ul>"),$(".live-relative-timestamp").each((function(){$(this).text(OC.Util.relativeModifiedDate(parseInt($(this).attr("data-timestamp"),10)))}))}},showRevHistory:function(){FileList.showDetailsView(this.fileName,"versionsTabView"),this.addCurrentVersion()},showVersionPreview:function(e){e.preventDefault();var t=e.currentTarget.parentElement.parentElement;$(e.currentTarget).hasClass("downloadVersion")&&(t=e.currentTarget.parentElement.parentElement.parentElement.parentElement);var n=t.dataset.revision,i=this.fileId,r=this.fileName;console.debug("[FilesAppIntegration] showVersionPreview",n,i,r),this.sendPostMessage("Action_loadRevViewer",{fileId:i,title:r,version:n}),$(t.parentElement.parentElement).find("li").removeClass("active"),$(t).addClass("active")},restoreVersion:function(e){var t=this;e.preventDefault(),e.stopPropagation(),this.sendPostMessage("Host_VersionRestore",{Status:"Pre_Restore"});var n=e.currentTarget.parentElement.parentElement.dataset.revision;return this._restoreVersionCallback=function(){t._restoreDAV(n),t._restoreVersionCallback=null},!1},restoreVersionExecute:function(){null!==this._restoreVersionCallback&&this._restoreVersionCallback()},restoreVersionAbort:function(){this._restoreVersionCallback=null},_restoreSuccess:function(e){"error"===e.status&&OC.Notification.showTemporary(t("richdocuments","Failed to revert the document to older version")),document.getElementById("richdocumentsframe").src=document.getElementById("richdocumentsframe").src,OC.Apps.hideAppSidebar()},_restoreError:function(){OC.Notification.showTemporary(t("richdocuments","Failed to revert the document to older version"))},_restoreDAV:function(e){var t=OC.linkToRemoteBase("dav")+"/versions/"+OC.getCurrentUser().uid+"/versions/"+this.fileId+"/"+e;$.ajax({type:"MOVE",url:t,headers:{Destination:OC.linkToRemote("dav")+"/versions/"+OC.getCurrentUser().uid+"/restore/target"},success:this._restoreSuccess.bind(this),error:this._restoreError.bind(this)})},createNewFile:function(e){OC.dialogs.prompt(t("richdocuments","Please enter the filename for the new document"),t("richdocuments","Save As"),(function(t,n){if(!0===t&&n){"text"===e&&(e="document");var i=parent.$("#dir").val(),r=OC.generateUrl("/apps/files/?dir="+i+"&richdocuments_create="+e+"&richdocuments_filename="+encodeURI(n));window.open(r,"_blank")}}),!0,t("richdocuments","New filename"),!1).then((function(){var e=parent.$(".oc-dialog:visible").find("button");e.eq(0).text(t("richdocuments","Cancel")),e.eq(1).text(t("richdocuments","Create a new document"))}))}},d=new o.a({FRAME_DOCUMENT:function(){return document.getElementById("richdocumentsframe").contentWindow}}),u=Object(r.d)("richdocuments_create"),f=Object(r.d)("richdocuments_open"),p={};u&&(p.create={type:Object(r.d)("richdocuments_create"),filename:Object(r.d)("richdocuments_filename")}),f&&(p.open={filename:f,id:Object(r.d)("richdocuments_fileId"),dir:Object(r.d)("dir")});var m=document.getElementById("hideDownload")&&"true"===document.getElementById("hideDownload").value,h=document.getElementById("isPublic")&&"1"===document.getElementById("isPublic").value,v={open:!1,receivedLoading:!1,supportedMimes:OC.getCapabilities().richdocuments.mimetypes.concat(OC.getCapabilities().richdocuments.mimetypesNoDefaultOpen),excludeMimeFromDefaultOpen:OC.getCapabilities().richdocuments.mimetypesNoDefaultOpen,hideDownloadMimes:["image/jpeg","image/svg+xml","image/cgm","image/vnd.dxf","image/x-emf","image/x-wmf","image/x-wpg","image/x-freehand","image/bmp","image/png","image/gif","image/tiff","image/jpg","image/jpeg","text/plain"],register:function(){var e="Edit with "+OC.getCapabilities().richdocuments.productName,n=!0,i=!1,r=void 0;try{for(var o,a=v.supportedMimes[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;OCA.Files.fileActions.register(s,e,0,OC.imagePath("core","actions/rename"),this.onEdit,t("richdocuments","Edit with {productName}",{productName:OC.getCapabilities().richdocuments.productName})),(-1===v.excludeMimeFromDefaultOpen.indexOf(s)||m)&&OCA.Files.fileActions.setDefault(s,e)}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}},onEdit:function(e,n){if(!0!==v.open){if(v.open=!0,n){var i=n.dir,o=n.fileId||n.$file.attr("data-id"),a=n.templateId;FileList.setViewerMode(!0),FileList.setPageTitle(e),FileList.showMask()}v.receivedLoading=!1;var s=Object(r.a)(i,o);h&&(s=Object(r.b)(e,o)),void 0!==a&&(s=Object(r.c)(a,e,i));n&&function(e){var t=p.open?parseInt(p.open.id):-1,n=FileList.findFile(e),i=n.shareOwnerId;if(void 0!==i){var r=i.lastIndexOf("@");-1!==i.substr(r).indexOf("/")&&n.id!==t&&function(e,t){var n=!1,i=document.createElement("iframe");i.setAttribute("src",e),i.setAttribute("onload",(function(){n=!0})),document.body.appendChild(i),setTimeout((function(){n||t(),document.body.removeChild(i)}),50)}("https://"+i.substr(r)+"/status.php",(function(){window.location=OC.generateUrl("/apps/richdocuments/open?fileId="+o)}))}}(e),OC.addStyle("richdocuments","mobile");var c=$('<iframe id="richdocumentsframe" nonce="'+btoa(OC.requestToken)+'" scrolling="no" allowfullscreen src="'+s+'" />');v.loadingTimeout=setTimeout((function(){v.receivedLoading||(v.onClose(),OC.Notification.showTemporary(t("richdocuments","Failed to load {productName} - please try again later",{productName:OC.getCapabilities().richdocuments.productName||"Collabora Online"})))}),15e3),c.src=s,$("body").css("overscroll-behavior-y","none"),document.querySelector("meta[name=viewport]").setAttribute("content","width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"),h?($("#preview").append(c).css({height:"100%"}),$("body").css({height:"100%"}),$("#content").addClass("full-height"),$("footer").addClass("hidden"),$("#imgframe").addClass("hidden"),$(".directLink").addClass("hidden"),$(".directDownload").addClass("hidden"),$("#controls").addClass("hidden"),$("#content").addClass("loading")):($("body").css("overflow","hidden"),$("#app-content").append(c),c.hide()),$("#app-content #controls").addClass("hidden"),setTimeout((function(){l.init({fileName:e,fileId:o,sendPostMessage:function(e,t){d.sendWOPIPostMessage("FRAME_DOCUMENT",e,t)}})}))}},onReceiveLoading:function(){v.receivedLoading=!0,$("#richdocumentsframe").show(),$("html, body").scrollTop(0),$("#content").removeClass("loading"),"undefined"!=typeof FileList&&FileList.hideMask(),l.initAfterReady()},onClose:function(){v.open=!1,clearTimeout(v.loadingTimeout),"undefined"!=typeof FileList&&(FileList.setViewerMode(!1),FileList.reload()),v.receivedLoading=!1,$('link[href*="richdocuments/css/mobile"]').remove(),$("#app-content #controls").removeClass("hidden"),$("#richdocumentsframe").remove(),$(".searchbox").show(),$("body").css("overflow","auto"),h&&($("#content").removeClass("full-height"),$("footer").removeClass("hidden"),$("#imgframe").removeClass("hidden"),$(".directLink").removeClass("hidden"),$(".directDownload").removeClass("hidden")),OC.Util.History.replaceState(),location.hash="",l.close()},registerFilesMenu:function(e){a.a.update("ooxml","ooxml"===e.doc_format);var n=function(e){e.FilesLOMenu={attach:function(e){var n=this,i=a.a.get("ooxml"),r=s("document",i),o=s("spreadsheet",i),c=s("presentation",i);e.addMenuEntry({id:"add-"+r.extension,displayName:t("richdocuments","New Document"),templateName:t("richdocuments","New Document")+"."+r.extension,iconClass:"icon-filetype-document",fileType:"x-office-document",actionHandler:function(e){OC.getCapabilities().richdocuments.templates?n._openTemplatePicker("document",r.mime,e):n._createDocument(r.mime,e)}}),e.addMenuEntry({id:"add-"+o.extension,displayName:t("richdocuments","New Spreadsheet"),templateName:t("richdocuments","New Spreadsheet")+"."+o.extension,iconClass:"icon-filetype-spreadsheet",fileType:"x-office-spreadsheet",actionHandler:function(e){OC.getCapabilities().richdocuments.templates?n._openTemplatePicker("spreadsheet",o.mime,e):n._createDocument(o.mime,e)}}),e.addMenuEntry({id:"add-"+c.extension,displayName:t("richdocuments","New Presentation"),templateName:t("richdocuments","New Presentation")+"."+c.extension,iconClass:"icon-filetype-presentation",fileType:"x-office-presentation",actionHandler:function(e){OC.getCapabilities().richdocuments.templates?n._openTemplatePicker("presentation",c.mime,e):n._createDocument(c.mime,e)}})},_createDocument:function(n,i){e.Files.Files.isFileNameValid(i),i=FileList.getUniqueName(i),$.post(OC.generateUrl("apps/richdocuments/ajax/documents/create"),{mimetype:n,filename:i,dir:$("#dir").val()},(function(e){e&&"success"===e.status?FileList.add(e.data,{animate:!0,scrollTo:!0}):OC.dialogs.alert(e.data.message,t("core","Could not create file"))}))},_createDocumentFromTemplate:function(n,i,r){e.Files.Files.isFileNameValid(r),r=FileList.getUniqueName(r),$.post(OC.generateUrl("apps/richdocuments/ajax/documents/create"),{mimetype:i,filename:r,dir:$("#dir").val()},(function(e){e&&"success"===e.status?(FileList.add(e.data,{animate:!1,scrollTo:!1}),v.onEdit(r,{fileId:-1,dir:$("#dir").val(),templateId:n})):OC.dialogs.alert(e.data.message,t("core","Could not create file"))}))},_openTemplatePicker:function(e,n,i){var r=this;$.ajax({url:OC.linkToOCS("apps/richdocuments/api/v1/templates",2)+e,dataType:"json"}).then((function(e){if(1!==e.ocs.data.length)r._buildTemplatePicker(e.ocs.data).then((function(){var e=[{text:t("core","Cancel"),classes:"cancel",click:function(){$(this).ocdialog("close")}},{text:t("richdocuments","Create"),classes:"primary",click:function(){var e=this.dataset.templateId;r._createDocumentFromTemplate(e,n,i),$(this).ocdialog("close")}}];$("#template-picker").ocdialog({closeOnEscape:!0,modal:!0,buttons:e})}));else{var o=e.ocs.data[0].id;r._createDocumentFromTemplate(o,n,i)}}))},_buildTemplatePicker:function(e){var n=this;return $.get(OC.filePath("richdocuments","templates","templatePicker.html"),(function(i){var r=$(i).octemplate({dialog_name:"template-picker",dialog_title:t("richdocuments","Select template")});_.values(e).forEach((function(e){n._appendTemplateFromData(r[0],e)})),$("body").append(r)}))},_appendTemplateFromData:function(e,t){var n=e.querySelector(".template-model").cloneNode(!0);n.className="",n.querySelector("img").src=OC.generateUrl("apps/richdocuments/template/preview/"+t.id),n.querySelector("h2").textContent=t.name,n.onclick=function(){e.dataset.templateId=t.id},e.dataset.templateId||(e.dataset.templateId=t.id),e.querySelector(".template-container").appendChild(n)}}};if(n(OCA),OC.Plugins.register("OCA.Files.NewFileMenu",OCA.FilesLOMenu),p.create&&p.create.type&&p.create.filename){var i=s(p.create.type,a.a.get("ooxml"));OCA.FilesLOMenu._openTemplatePicker(p.create.type,i.mime,p.create.filename+"."+i.extension)}p.open&&FileList.$fileList.one("updated",(function(){v.onEdit(p.open.filename,{fileId:p.open.id,dir:document.getElementById("dir").value})}))}};window.OCA.RichDocuments={},$(document).ready((function(){"undefined"!=typeof OCA&&void 0!==OCA.Files&&void 0!==OCA.Files.fileActions&&(void 0===OCA.Files_Texteditor&&void 0===OCA.Text&&v.supportedMimes.push("text/plain"),v.register(),$.get(OC.filePath("richdocuments","ajax","settings.php")).done((function(e){v.registerFilesMenu(e)})));var e=h&&-1!==v.supportedMimes.indexOf($("#mimetype").val()),n=h&&m&&-1!==v.hideDownloadMimes.indexOf($("#mimetype").val());(e||n)&&v.onEdit(document.getElementById("filename").value),d.registerPostMessageHandler((function(e){var n=e.parsed;console.debug("[viewer] Received post message",n);var i=n.msgId,r=n.args;if(!n.deprecated){switch(i){case"loading":v.onReceiveLoading();break;case"App_LoadingStatus":"Timeout"===r.Status&&(v.onClose(),OC.Notification.showTemporary(t("richdocuments","Failed to connect to {productName}. Please try again later or contact your server administrator.",{productName:OC.getCapabilities().richdocuments.productName})));break;case"UI_Share":l.share();break;case"UI_CreateFile":l.createNewFile(r.DocumentType);break;case"UI_InsertGraphic":l.insertGraphic((function(e,t){d.sendWOPIPostMessage("FRAME_DOCUMENT","postAsset",{FileName:e,Url:t})}));break;case"File_Rename":FileList.reload(),OC.Apps.hideAppSidebar(),l.fileName=r.NewName;break;case"close":v.onClose();break;case"Get_Views_Resp":case"Views_List":l.setViews(r);break;case"UI_FileVersions":case"rev-history":l.showRevHistory();break;case"App_VersionRestore":"Pre_Restore_Ack"===r.Status&&l.restoreVersionExecute()}"View_Added"===i?(l.views[r.ViewId]=r,l.renderAvatars()):"View_Removed"===i?(delete l.views[r.ViewId],l.renderAvatars()):"FollowUser_Changed"===i&&(r.IsFollowEditor?l.followingEditor=!0:l.followingEditor=!1,r.IsFollowUser?l.following=r.FollowedViewId:l.following=null,l.renderAvatars())}})),window.FilesAppIntegration=l}))}]);
//# sourceMappingURL=viewer.js.map