!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/js/",n(n.s=840)}([function(t,e,n){(function(e){var n=function(t){return t&&t.Math==Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e&&e)||function(){return this}()||Function("return this")()}).call(this,n(11))},function(t,e,n){var r=n(0),i=n(160),o=n(9),a=n(92),s=n(165),c=n(318),l=i("wks"),u=r.Symbol,f=c?u:u&&u.withoutSetter||a;t.exports=function(t){return o(l,t)||(s&&o(u,t)?l[t]=u[t]:l[t]=f("Symbol."+t)),l[t]}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},,function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},,,function(t,e,n){(function(e){var n=function(t){return t&&t.Math==Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e&&e)||Function("return this")()}).call(this,n(11))},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){(function(e){var n=function(t){return t&&t.Math==Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e&&e)||Function("return this")()}).call(this,n(11))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var r=n(21),i=n(157),o=n(22),a=n(87),s=Object.defineProperty;e.f=r?s:function(t,e,n){if(o(t),e=a(e,!0),o(n),i)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},,function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}
/*
 * @copyright Copyright (c) 2019 Julius Härtl <jus@bitgrid.net>
 *
 * @author Julius Härtl <jus@bitgrid.net>
 *
 * @license GNU AGPL version 3 or any later version
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 *
 */
var i=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.values={},this.loadFromGlobal("userId"),this.loadFromGlobal("urlsrc"),this.loadFromGlobal("directEdit"),this.loadFromGlobal("permissions"),this.loadFromGlobal("instanceId")}var e,n,i;return e=t,(n=[{key:"loadFromGlobal",value:function(t){this.values[t]=window["richdocuments_"+t]}},{key:"update",value:function(t,e){this.values[t]=e}},{key:"get",value:function(t){return void 0===this.values[t]&&this.loadFromGlobal(t),this.values[t]}}])&&r(e.prototype,n),i&&r(e,i),t}());e.a=i},function(t,e,n){var r=n(21),i=n(12),o=n(54);t.exports=r?function(t,e,n){return i.f(t,e,o(1,n))}:function(t,e,n){return t[e]=n,t}},,function(e,n,r){"use strict";var i=r(49),o=r(106),a=r(108),s=r(14),c=r(399);function l(t,e){return function(t){if(Array.isArray(t))return t}
/*
 * @copyright Copyright (c) 2019 Julius Härtl <jus@bitgrid.net>
 *
 * @author Julius Härtl <jus@bitgrid.net>
 *
 * @license GNU AGPL version 3 or any later version
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 *
 */(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var f=document.getElementById("isPublic")&&"1"===document.getElementById("isPublic").value;n.a={fileModel:null,fileList:void 0,filePath:void 0,views:{},followingEditor:!1,following:null,handlers:{},startLoading:function(){this.getFileList()&&(this.getFileList().setViewerMode&&this.getFileList().setViewerMode(!0),this.getFileList().showMask&&this.getFileList().showMask())},init:function(t){var e=this,n=t.fileName,r=t.fileId,i=t.filePath,o=t.sendPostMessage,a=t.fileList,s=t.fileModel;this.fileName=n,this.fileId=r,this.fileList=a,this.filePath=i,this.fileModel=s,this.sendPostMessage=o,this.fileModel&&this.fileModel.on&&this.fileModel.on("change",(function(){e._addHeaderFileActions()}))},registerHandler:function(t,e){this.handlers[t]=e},initAfterReady:function(){if(!this.handlers.initAfterReady||!this.handlers.initAfterReady(this)){this.getFileList()&&(this.getFileModel(),this.getFileList().hideMask&&this.getFileList().hideMask(),this.getFileList().setPageTitle&&this.getFileList().setPageTitle(this.fileName));var t=document.querySelector("#header .header-right");if(!document.getElementById("richdocuments-header")){var e=document.createElement("div");e.id="richdocuments-header",t.insertBefore(e,t.firstChild),this._addAvatarList(),f||(this._addHeaderShareButton(),this._addHeaderFileActions(),this.addVersionSidebarEvents())}}},close:function(){this.handlers.close&&this.handlers.close(this)||(this.getFileList()&&(this.getFileList().setViewerMode&&this.getFileList().setViewerMode(!1),this.getFileList().reload&&this.getFileList().reload()),this.fileModel=null,f||this.removeVersionSidebarEvents(),$("#richdocuments-header").remove())},saveAs:function(){this.handlers.saveAs&&this.handlers.saveAs(this)||this.getFileList()&&this.getFileList().reload()},share:function(){this.handlers.share&&this.handlers.share(this)||(!f&&this.getFileList()?(this.getFileList().showDetailsView&&this.getFileList().showDetailsView(this.fileName,"shareTabView"),OC.Apps.showAppSidebar()):console.error("[FilesAppIntegration] Sharing is not supported"))},rename:function(t){this.fileName=t,this.handlers.rename&&this.handlers.rename(this)||this.getFileList()&&(this.getFileList().reload&&this.getFileList().reload(),OC.Apps.hideAppSidebar())},insertGraphic:function(e){f&&console.error("[FilesAppIntegration] insertGraphic is not supported");var n=function(t){var n=t.substring(t.lastIndexOf("/")+1);$.ajax({type:"POST",url:OC.generateUrl("apps/richdocuments/assets"),data:{path:t}}).done((function(t){e(n,t.url)}))};this.handlers.insertGraphic&&this.handlers.insertGraphic(this,{insertFileFromPath:n})||OC.dialogs.filepicker(t("richdocuments","Insert from {name}",{name:OC.theme.name}),(function(t,e){e===OC.dialogs.FILEPICKER_TYPE_CHOOSE&&n(t)}),!1,["image/png","image/gif","image/jpeg","image/svg"],!0,OC.dialogs.FILEPICKER_TYPE_CHOOSE)},getFileList:function(){return this.fileList?this.fileList:OCA.Files&&OCA.Files.App?OCA.Files.App.fileList:OCA.Sharing&&OCA.Sharing.PublicApp?OCA.Sharing.PublicApp.fileList:null},getFileModel:function(){var t=this;return this.fileModel?this.fileModel:this.getFileList()?(this.getFileList()._updateDetailsView&&this.getFileList()._updateDetailsView(this.fileName,!1),this.fileModel=this.getFileList().getModelForFile(this.fileName),this.fileModel&&this.fileModel.on&&this.fileModel.on("change",(function(){t._addHeaderFileActions()})),this.fileModel):null},setViews:function(t){var e=this;this.views={},t.forEach((function(t){e.views[t.ViewId]=t})),this.renderAvatars()},followReset:function(t){this.sendPostMessage("Action_FollowUser",{Follow:!1}),this.following=null,this.followingEditor=!1,this.renderAvatars()},followCurrentEditor:function(t){this.sendPostMessage("Action_FollowUser",{Follow:!0}),this.following=null,this.followingEditor=!0,this.renderAvatars()},followView:function(t){this.sendPostMessage("Action_FollowUser",{ViewId:t.ViewId,Follow:!0}),this.following=t.ViewId,this.followingEditor=!1,this.renderAvatars()},_addAvatarList:function(){var t=$('<div id="richdocuments-avatars">');t.on("click",(function(t){t.stopPropagation(),$("#editors-menu").toggle()})),$("#richdocuments-header").append(t)},_addHeaderShareButton:function(){var t=this;if($("header").length){var e=$('<div id="richdocuments-sharing"><a class="icon-shared icon-white"></a></div>');$("#richdocuments-header").append(e),e.on("click",(function(){if(!$("#app-sidebar").is(":visible"))return t.share();OC.Apps.hideAppSidebar()})),$(".searchbox").hide()}},_addHeaderFileActions:function(){var e=this;console.debug("[FilesAppIntegration] Adding header file actions"),OC.unregisterMenu($("#richdocuments-actions .icon-more"),$("#richdocuments-actions-menu")),$("#richdocuments-actions").remove();var n,r=$('<div id="richdocuments-actions"><div class="icon-more icon-white"></div><ul id="richdocuments-actions-menu" class="popovermenu"></ul></div>'),i=r.find("#richdocuments-actions-menu").empty(),o=function(){return{$file:e.getFileList().$el?e.getFileList().$el.find("[data-id="+e.fileId+"]").first():null,fileActions:e.getFileList().fileActions,fileList:e.getFileList(),fileInfoModel:e.getFileModel()}},a=$("<li><a></a></li>").click((function(t){a.find("a").removeClass("icon-starred").removeClass("icon-star-dark").addClass("icon-loading-small"),e.handlers.actionFavorite&&e.handlers.actionFavorite(e)||(e.getFileList().fileActions.triggerAction("Favorite",e.getFileModel(),e.getFileList()),e.getFileModel().trigger("change",e.getFileModel()))}));(n=this.getFileModel()).get("tags")&&n.get("tags").indexOf(OC.TAG_FAVORITE)>=0?(a.find("a").text(t("files","Remove from favorites")),a.find("a").addClass("icon-starred")):(a.find("a").text(t("files","Add to favorites")),a.find("a").addClass("icon-star-dark"));var s=$('<li><a class="icon-info"></a></li>').click((function(){e.handlers.actionDetails&&e.handlers.actionDetails(e)||(e.getFileList().fileActions.actions.all.Details.action(e.fileName,o()),OC.hideMenus())}));s.find("a").text(t("files","Details"));var c=$('<li><a class="icon-download">Download</a></li>').click((function(){e.handlers.actionDownload&&e.handlers.actionDownload(e)||(e.getFileList().fileActions.actions.all.Download.action(e.fileName,o()),OC.hideMenus())}));c.find("a").text(t("files","Download")),i.append(a).append(s).append(c),$("#richdocuments-header").append(r),OC.registerMenu($("#richdocuments-actions .icon-more"),$("#richdocuments-actions-menu"),!1,!0)},_userEntry:function(e){var n=this,r=$("<li></li>");r.append(this._avatarForView(e));var i=$('<div class="label"></div>');i.text(e.UserName),"1"===e.ReadOnly&&i.text(e.UserName+" "+t("richdocuments","(read only)")),i.click((function(t){t.stopPropagation(),n.followView(e)})),this.following===e.ViewId&&($("#editors-menu").find("li").removeClass("active"),r.addClass("active")),r.append(i);var o=!f&&this.getFileModel()&&void 0===this.getFileModel().get("shareOwner"),a=this.getFileModel()&&!!(this.getFileModel().get("permissions")&OC.PERMISSION_UPDATE);if(o&&a&&!e.IsCurrentView){var s=$('<div class="icon-close" title="'+t("richdocuments","Remove user")+'"/>');s.click((function(){n.sendPostMessage("Action_RemoveView",{ViewId:e.ViewId})})),r.append(s)}return r},_avatarForView:function(e){var n=""===e.UserId?e.UserName:e.UserId,r=$('<div class="richdocuments-avatar"><div class="avatar" title="'+e.UserName+'" data-user="'+n+'"></div></div>'),i=r.find(".avatar");return i.css({"border-color":"#"+("000000"+Number(e.Color).toString(16)).substr(-6),"border-width":"2px","border-style":"solid"}),"1"===e.ReadOnly?(r.addClass("read-only"),$(i).attr("title",e.UserName+" "+t("richdocuments","(read only)"))):$(i).attr("title",e.UserName),$(i).avatar(n,32,void 0,!0,void 0,e.UserName),r},renderAvatars:function(){var e=this,n=$("#header .header-right #richdocuments-avatars");n.empty();var r=$('<div id="editors-menu" class="popovermenu menu-center"><ul></ul></div>'),i=[],o=0;for(var a in this.views){var s=this.views[a];s.UserName=""!==s.UserName?s.UserName:t("richdocuments","Guest"),r.find("ul").append(this._userEntry(s)),s.UserId!==OC.currentUser&&(""!==s.UserId&&i.indexOf(s.UserId)>-1||(i.push(s.UserId),o++<4&&n.append(this._avatarForView(s))))}var c=$('<li><input type="checkbox" class="checkbox" /><label class="label">'+t("richdocuments","Follow current editor")+"</label></li>");c.find("label").click((function(t){t.stopPropagation(),e.followingEditor?e.followReset():e.followCurrentEditor()})),c.find(".checkbox").prop("checked",this.followingEditor),r.find("ul").append(c),n.append(r)},_originalOnClickRevertVersion:null,addVersionSidebarEvents:function(){var t=OCA.Files.App.fileList._detailsView._tabViews.find((function(t){return"versionsTabView"===t.el.id}));t&&(this._originalOnClickRevertVersion=t._onClickRevertVersion,OCA.Files.App.fileList._detailsView._tabViews.find((function(t){return"versionsTabView"===t.el.id}))._onClickRevertVersion=function(){}),$(document.querySelector("#content")).on("click.revisions","#app-sidebar .preview-container",this.showVersionPreview.bind(this)),$(document.querySelector("#content")).on("click.revisions","#app-sidebar .downloadVersion",this.showVersionPreview.bind(this)),$(document.querySelector("#content")).on("mousedown.revisions","#app-sidebar .revertVersion",this.restoreVersion.bind(this)),$(document.querySelector("#content")).on("click.revisionsTab","#app-sidebar [data-tabid=versionsTabView]",this.addCurrentVersion.bind(this))},removeVersionSidebarEvents:function(){var t=OCA.Files.App.fileList._detailsView._tabViews.find((function(t){return"versionsTabView"===t.el.id}));t&&(t._onClickRevertVersion=this._originalOnClickRevertVersion),$(document.querySelector("#content")).off("click.revisions"),$(document.querySelector("#content")).off("click.revisions"),$(document.querySelector("#content")).off("mousedown.revisions"),$(document.querySelector("#content")).off("click.revisionsTab")},addCurrentVersion:function(){if($("#lastSavedVersion").remove(),$("#currentVersion").remove(),this.getFileModel()){var e=OC.MimeType.getIconUrl(this.getFileModel().get("mimetype")),n=this.getFileModel().get("mtime");$("#versionsTabView").prepend('<ul id="lastSavedVersion"><li data-revision="0"><div><div class="preview-container"><img src="'+e+'" width="44" /></div><div class="version-container">\n<div><a class="downloadVersion">'+t("richdocuments","Last saved version")+'<br /><span class="versiondate has-tooltip live-relative-timestamp" data-timestamp="'+n+'"></span></div></div></li></ul>'),$("#versionsTabView").prepend('<ul id="currentVersion"><li data-revision="" class="active"><div><div class="preview-container"><img src="'+e+'" width="44" /></div><div class="version-container">\n<div><a class="downloadVersion">'+t("richdocuments","Current version")+"</a></div></div></li></ul>"),$(".live-relative-timestamp").each((function(){$(this).text(OC.Util.relativeModifiedDate(parseInt($(this).attr("data-timestamp"),10)))}))}},showRevHistory:function(){this.handlers.showRevHistory&&this.handlers.showRevHistory(this)||this.getFileList()&&(this.getFileList().showDetailsView(this.fileName,"versionsTabView"),this.addCurrentVersion())},showVersionPreview:function(t){t.preventDefault();var e=t.currentTarget.parentElement.parentElement;$(t.currentTarget).hasClass("downloadVersion")&&(e=t.currentTarget.parentElement.parentElement.parentElement.parentElement);var n=e.dataset.revision,r=this.fileId,i=this.fileName;console.debug("[FilesAppIntegration] showVersionPreview",n,r,i),this.sendPostMessage("Action_loadRevViewer",{fileId:r,title:i,version:n}),$(e.parentElement.parentElement).find("li").removeClass("active"),$(e).addClass("active")},restoreVersion:function(t){var e=this;t.preventDefault(),t.stopPropagation(),this.sendPostMessage("Host_VersionRestore",{Status:"Pre_Restore"});var n=t.currentTarget.parentElement.parentElement.dataset.revision;return this._restoreVersionCallback=function(){e._restoreDAV(n),e._restoreVersionCallback=null},!1},restoreVersionExecute:function(){null!==this._restoreVersionCallback&&this._restoreVersionCallback()},restoreVersionAbort:function(){this._restoreVersionCallback=null},_restoreSuccess:function(e){"error"===e.status&&OC.Notification.showTemporary(t("richdocuments","Failed to revert the document to older version")),document.getElementById("richdocumentsframe").src=document.getElementById("richdocumentsframe").src,OC.Apps.hideAppSidebar()},_restoreError:function(){OC.Notification.showTemporary(t("richdocuments","Failed to revert the document to older version"))},_restoreDAV:function(t){var e=OC.linkToRemoteBase("dav")+"/versions/"+OC.getCurrentUser().uid+"/versions/"+this.fileId+"/"+t;$.ajax({type:"MOVE",url:e,headers:{Destination:OC.linkToRemote("dav")+"/versions/"+OC.getCurrentUser().uid+"/restore/target"},success:this._restoreSuccess.bind(this),error:this._restoreError.bind(this)})},createNewFile:function(e){this.handlers.createNewFile&&this.handlers.createNewFile(this,{type:e})||OC.dialogs.prompt(t("richdocuments","Please enter the filename for the new document"),t("richdocuments","Save As"),(function(t,n){if(!0===t&&n){"text"===e&&(e="document");var r=parent.$("#dir").val(),i=OC.generateUrl("/apps/files/?dir="+r+"&richdocuments_create="+e+"&richdocuments_filename="+encodeURI(n));window.open(i,"_blank")}}),!0,t("richdocuments","New filename"),!1).then((function(){var e=parent.$(".oc-dialog:visible").find("button");e.eq(0).text(t("richdocuments","Cancel")),e.eq(1).text(t("richdocuments","Create a new document"))}))},preloadOpen:function(){if(!this.handlers.preloadOpen||!this.handlers.preloadOpen(this)){var t=i.a.open.id,e=i.a.open.filename;setTimeout((function(){window.FileList.$fileList.one("updated",(function(){var n=l(Object(o.b)(e),2)[1],r=FileList.getModelForFile(n);OCA.RichDocuments.open({path:e,fileId:t,fileModel:r,fileList:window.FileList})}))}),250)}},preloadCreate:function(){this.handlers.preloadCreate&&this.handlers.preloadCreate(this)||setTimeout((function(){window.FileList.$fileList.one("updated",(function(){var t=a.a.getFileType(i.a.create.type,s.a.get("ooxml"));c.a._openTemplatePicker(i.a.create.type,t.mime,i.a.create.filename+"."+t.extension)}))}),250)},loggingContext:function(){var t,e,n;return{currentUser:null===(t=OC.getCurrentUser())||void 0===t?void 0:t.uid,file:{sharingToken:null===(e=document.getElementById("sharingToken"))||void 0===e?void 0:e.value,fileId:this.fileId,filePath:(null!==(n=this.filePath)&&void 0!==n?n:"")+"/"+this.fileName}}}}},,function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var r=n(2);t.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(t,e,n){var r=n(8);t.exports=function(t){if(!r(t))throw TypeError(String(t)+" is not an object");return t}},,,function(t,e,n){var r=n(4);t.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},,function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},,,,function(t,e,n){"use strict";n.d(e,"d",(function(){return a})),n.d(e,"e",(function(){return s})),n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return l})),n.d(e,"a",(function(){return u}));var r=n(65),i=n(106),o=n(14),a=function(t){var e=new RegExp("[?&]"+t+"=([^&#]*)").exec(window.location.href);return null===e?null:decodeURI(e[1])||""},s=function(t){var e=t.fileId,n=t.title,a=t.readOnly,s=t.closeButton,c=t.revisionHistory,l=window.location.protocol+"//"+window.location.host+Object(r.getRootUrl)()+"/index.php/apps/richdocuments/wopi/files/"+e;console.debug("[getWopiUrl] "+l);var u=encodeURIComponent(l);return o.a.get("urlsrc")+"WOPISrc="+u+"&title="+encodeURIComponent(n)+"&lang="+Object(i.a)()+(s?"&closebutton=1":"")+(c?"&revisionhistory=1":"")+(a?"&permission=readonly":"")},c=function(t,e,n,r){return OC.generateUrl("apps/richdocuments/indexTemplate?templateId={templateId}&fileName={fileName}&dir={dir}&requesttoken={requesttoken}",{templateId:t,fileName:e,dir:n,requesttoken:OC.requestToken})},l=function(t,e){return OC.generateUrl("apps/richdocuments/public?shareToken={shareToken}&fileName={fileName}&requesttoken={requesttoken}&fileId={fileId}",{shareToken:document.getElementById("sharingToken").value,fileName:t,fileId:e,requesttoken:OC.requestToken})},u=function(t,e){return OC.generateUrl("apps/richdocuments/index?fileId={fileId}&requesttoken={requesttoken}",{fileId:e,dir:t,requesttoken:OC.requestToken})}},,function(t,e,n){var r=n(25),i=n(136),o=n(132);t.exports=r?function(t,e,n){return i.f(t,e,o(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var r=n(51);t.exports=function(t){if(!r(t))throw TypeError(String(t)+" is not an object");return t}},function(t,e,n){var r=n(0),i=n(155).f,o=n(15),a=n(36),s=n(88),c=n(310),l=n(162);t.exports=function(t,e){var n,u,f,d,p,h=t.target,v=t.global,m=t.stat;if(n=v?r:m?r[h]||s(h,{}):(r[h]||{}).prototype)for(u in e){if(d=e[u],f=t.noTargetGet?(p=i(n,u))&&p.value:n[u],!l(v?u:h+(m?".":"#")+u,t.forced)&&void 0!==f){if(typeof d==typeof f)continue;c(d,f)}(t.sham||f&&f.sham)&&o(d,"sham",!0),a(n,u,d,t)}}},function(t,e,n){var r=n(0),i=n(15),o=n(9),a=n(88),s=n(159),c=n(56),l=c.get,u=c.enforce,f=String(String).split("String");(t.exports=function(t,e,n,s){var c,l=!!s&&!!s.unsafe,d=!!s&&!!s.enumerable,p=!!s&&!!s.noTargetGet;"function"==typeof n&&("string"!=typeof e||o(n,"name")||i(n,"name",e),(c=u(n)).source||(c.source=f.join("string"==typeof e?e:""))),t!==r?(l?!p&&t[e]&&(d=!0):delete t[e],d?t[e]=n:i(t,e,n)):d?t[e]=n:a(e,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&l(this).source||s(this)}))},function(t,e){t.exports={}},,,,,function(t,e,n){var r=n(61),i=n(191),o=n(188);t.exports=r?function(t,e,n){return i.f(t,e,o(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){"use strict";var r,i=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},o=function(){var t={};return function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}t[e]=n}return t[e]}}(),a=[];function s(t){for(var e=-1,n=0;n<a.length;n++)if(a[n].identifier===t){e=n;break}return e}function c(t,e){for(var n={},r=[],i=0;i<t.length;i++){var o=t[i],c=e.base?o[0]+e.base:o[0],l=n[c]||0,u="".concat(c," ").concat(l);n[c]=l+1;var f=s(u),d={css:o[1],media:o[2],sourceMap:o[3]};-1!==f?(a[f].references++,a[f].updater(d)):a.push({identifier:u,updater:m(d,e),references:1}),r.push(u)}return r}function l(t){var e=document.createElement("style"),r=t.attributes||{};if(void 0===r.nonce){var i=n.nc;i&&(r.nonce=i)}if(Object.keys(r).forEach((function(t){e.setAttribute(t,r[t])})),"function"==typeof t.insert)t.insert(e);else{var a=o(t.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(e)}return e}var u,f=(u=[],function(t,e){return u[t]=e,u.filter(Boolean).join("\n")});function d(t,e,n,r){var i=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(t.styleSheet)t.styleSheet.cssText=f(e,i);else{var o=document.createTextNode(i),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(o,a[e]):t.appendChild(o)}}function p(t,e,n){var r=n.css,i=n.media,o=n.sourceMap;if(i?t.setAttribute("media",i):t.removeAttribute("media"),o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}var h=null,v=0;function m(t,e){var n,r,i;if(e.singleton){var o=v++;n=h||(h=l(e)),r=d.bind(null,n,o,!1),i=d.bind(null,n,o,!0)}else n=l(e),r=p.bind(null,n,e),i=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(n)};return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else i()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=i());var n=c(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var r=0;r<n.length;r++){var i=s(n[r]);a[i].references--}for(var o=c(t,e),l=0;l<n.length;l++){var u=s(n[l]);0===a[u].references&&(a[u].updater(),a.splice(u,1))}n=o}}}},function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}t.exports=function(t){var e=r(t,4),n=e[1],i=e[3];if("function"==typeof btoa){var o=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),a="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o),s="/*# ".concat(a," */"),c=i.sources.map((function(t){return"/*# sourceURL=".concat(i.sourceRoot||"").concat(t," */")}));return[n].concat(c).concat([s]).join("\n")}return[n].join("\n")}},function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=t(e);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n,r){"string"==typeof t&&(t=[[null,t,""]]);var i={};if(r)for(var o=0;o<this.length;o++){var a=this[o][0];null!=a&&(i[a]=!0)}for(var s=0;s<t.length;s++){var c=[].concat(t[s]);r&&i[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),e.push(c))}},e}},,,function(t,e,n){var r=n(63);t.exports=function(t){if(!r(t))throw TypeError(String(t)+" is not an object");return t}},function(t,e,n){"use strict";var r=n(31),i=Object(r.d)("richdocuments_create"),o=Object(r.d)("richdocuments_open"),a={};
/*
 * @copyright Copyright (c) 2020 Julius Härtl <jus@bitgrid.net>
 *
 * @author Julius Härtl <jus@bitgrid.net>
 *
 * @license GNU AGPL version 3 or any later version
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 *
 */i&&(a.create={type:Object(r.d)("richdocuments_create"),filename:Object(r.d)("richdocuments_filename")}),o&&(a.open={filename:o,id:Object(r.d)("richdocuments_fileId")}),e.a=a},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){var r=n(7),i=n(33),o=n(20),a=n(80),s=n(137),c=n(272),l=c.get,u=c.enforce,f=String(String).split("String");(t.exports=function(t,e,n,s){var c=!!s&&!!s.unsafe,l=!!s&&!!s.enumerable,d=!!s&&!!s.noTargetGet;"function"==typeof n&&("string"!=typeof e||o(n,"name")||i(n,"name",e),u(n).source=f.join("string"==typeof e?e:"")),t!==r?(c?!d&&t[e]&&(l=!0):delete t[e],l?t[e]=n:i(t,e,n)):l?t[e]=n:a(e,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&l(this).source||s(this)}))},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var r=n(156),i=n(86);t.exports=function(t){return r(i(t))}},function(t,e,n){var r,i,o,a=n(309),s=n(0),c=n(8),l=n(15),u=n(9),f=n(89),d=n(90),p=n(57),h=s.WeakMap;if(a){var v=f.state||(f.state=new h),m=v.get,g=v.has,A=v.set;r=function(t,e){return e.facade=t,A.call(v,t,e),e},i=function(t){return m.call(v,t)||{}},o=function(t){return g.call(v,t)}}else{var y=d("state");p[y]=!0,r=function(t,e){return e.facade=t,l(t,y,e),e},i=function(t){return u(t,y)?t[y]:{}},o=function(t){return u(t,y)}}t.exports={set:r,get:i,has:o,enforce:function(t){return o(t)?i(t):r(t,{})},getterFor:function(t){return function(e){var n;if(!c(e)||(n=i(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}}}},function(t,e){t.exports={}},function(t,e,n){var r=n(312),i=n(0),o=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?o(r[t])||o(i[t]):r[t]&&r[t][e]||i[t]&&i[t][e]}},function(t,e,n){var r=n(93),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},,function(t,e,n){var r=n(19);t.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e,n){"use strict";n(270),n(285),n(288),n(149),n(293),n(294),Object.defineProperty(e,"__esModule",{value:!0}),e.getRootUrl=e.generateFilePath=e.imagePath=e.generateUrl=e.generateOcsUrl=e.generateRemoteUrl=e.linkTo=void 0;e.linkTo=function(t,e){return r(t,"",e)};e.generateRemoteUrl=function(t){return window.location.protocol+"//"+window.location.host+function(t){return i()+"/remote.php/"+t}(t)};e.generateOcsUrl=function(t,e){return e=2!==e?1:2,window.location.protocol+"//"+window.location.host+i()+"/ocs/v"+e+".php/"+t+"/"};e.generateUrl=function(t,e,n){var r=Object.assign({escape:!0,noRewrite:!1},n||{}),o=function(t,e){return e=e||{},t.replace(/{([^{}]*)}/g,(function(t,n){var i=e[n];return r.escape?"string"==typeof i||"number"==typeof i?encodeURIComponent(i.toString()):encodeURIComponent(t):"string"==typeof i||"number"==typeof i?i.toString():t}))};return"/"!==t.charAt(0)&&(t="/"+t),!0!==OC.config.modRewriteWorking||r.noRewrite?i()+"/index.php"+o(t,e||{}):i()+o(t,e||{})};e.imagePath=function(t,e){return-1===e.indexOf(".")?r(t,"img",e+".svg"):r(t,"img",e)};var r=function(t,e,n){var r=-1!==OC.coreApps.indexOf(t),o=i();return"php"!==n.substring(n.length-3)||r?"php"===n.substring(n.length-3)||r?(o+="settings"!==t&&"core"!==t&&"search"!==t||"ajax"!==e?"/":"/index.php/",r||(o+="apps/"),""!==t&&(o+=t+="/"),e&&(o+=e+"/"),o+=n):(o=OC.appswebroots[t],e&&(o+="/"+e+"/"),"/"!==o.substring(o.length-1)&&(o+="/"),o+=n):(o+="/index.php/apps/"+t,"index.php"!==n&&(o+="/",e&&(o+=encodeURI(e+"/")),o+=n)),o};e.generateFilePath=r;var i=function(){return OC.webroot};e.getRootUrl=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.subscribe=function(t,e){o.subscribe(t,e)},e.unsubscribe=function(t,e){o.unsubscribe(t,e)},e.emit=function(t,e){o.emit(t,e)};var r=n(301),i=n(306);var o=(void 0!==window.OC&&window.OC._eventBus&&void 0===window._nc_event_bus&&(console.warn("found old event bus instance at OC._eventBus. Update your version!"),window._nc_event_bus=window.OC._eventBus),void 0!==window._nc_event_bus?new r.ProxyBus(window._nc_event_bus):window._nc_event_bus=new i.SimpleBus)},,,,,,,,,,,function(t,e,n){var r=n(7),i=n(130).f,o=n(33),a=n(52),s=n(80),c=n(276),l=n(282);t.exports=function(t,e){var n,u,f,d,p,h=t.target,v=t.global,m=t.stat;if(n=v?r:m?r[h]||s(h,{}):(r[h]||{}).prototype)for(u in e){if(d=e[u],f=t.noTargetGet?(p=i(n,u))&&p.value:n[u],!l(v?u:h+(m?".":"#")+u,t.forced)&&void 0!==f){if(typeof d==typeof f)continue;c(d,f)}(t.sham||f&&f.sham)&&o(d,"sham",!0),a(n,u,d,t)}}},function(t,e,n){var r=n(133),i=n(50);t.exports=function(t){return r(i(t))}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){var r=n(7),i=n(33);t.exports=function(t,e){try{i(r,t,e)}catch(n){r[t]=e}return e}},function(t,e,n){var r={};r[n(82)("toStringTag")]="z",t.exports="[object z]"===String(r)},function(t,e,n){var r=n(7),i=n(139),o=n(20),a=n(140),s=n(148),c=n(289),l=i("wks"),u=r.Symbol,f=c?u:u&&u.withoutSetter||a;t.exports=function(t){return o(l,t)||(s&&o(u,t)?l[t]=u[t]:l[t]=f("Symbol."+t)),l[t]}},function(t,e,n){"use strict";var r,i,o=n(150),a=n(292),s=RegExp.prototype.exec,c=String.prototype.replace,l=s,u=(r=/a/,i=/b*/g,s.call(r,"a"),s.call(i,"a"),0!==r.lastIndex||0!==i.lastIndex),f=a.UNSUPPORTED_Y||a.BROKEN_CARET,d=void 0!==/()??/.exec("")[1];(u||d||f)&&(l=function(t){var e,n,r,i,a=this,l=f&&a.sticky,p=o.call(a),h=a.source,v=0,m=t;return l&&(-1===(p=p.replace("y","")).indexOf("g")&&(p+="g"),m=String(t).slice(a.lastIndex),a.lastIndex>0&&(!a.multiline||a.multiline&&"\n"!==t[a.lastIndex-1])&&(h="(?: "+h+")",m=" "+m,v++),n=new RegExp("^(?:"+h+")",p)),d&&(n=new RegExp("^"+h+"$(?!\\s)",p)),u&&(e=a.lastIndex),r=s.call(l?n:a,m),l?r?(r.input=r.input.slice(v),r[0]=r[0].slice(v),r.index=a.lastIndex,a.lastIndex+=r[0].length):a.lastIndex=0:u&&r&&(a.lastIndex=a.global?r.index+r[0].length:e),d&&r&&r.length>1&&c.call(r[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)})),r}),t.exports=l},function(t,e){const n=Number.MAX_SAFE_INTEGER||9007199254740991;t.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:n,MAX_SAFE_COMPONENT_LENGTH:16}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t}},function(t,e,n){var r=n(8);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var r=n(0),i=n(15);t.exports=function(t,e){try{i(r,t,e)}catch(n){r[t]=e}return e}},function(t,e,n){var r=n(0),i=n(88),o=r["__core-js_shared__"]||i("__core-js_shared__",{});t.exports=o},function(t,e,n){var r=n(160),i=n(92),o=r("keys");t.exports=function(t){return o[t]||(o[t]=i(t))}},function(t,e){t.exports=!1},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++n+r).toString(36)}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,e,n){var r=n(86);t.exports=function(t){return Object(r(t))}},function(t,e,n){var r=n(321);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},function(t,e,n){var r,i=n(22),o=n(325),a=n(94),s=n(57),c=n(327),l=n(158),u=n(90),f=u("IE_PROTO"),d=function(){},p=function(t){return"<script>"+t+"<\/script>"},h=function(){try{r=document.domain&&new ActiveXObject("htmlfile")}catch(t){}var t,e;h=r?function(t){t.write(p("")),t.close();var e=t.parentWindow.Object;return t=null,e}(r):((e=l("iframe")).style.display="none",c.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(p("document.F=Object")),t.close(),t.F);for(var n=a.length;n--;)delete h.prototype[a[n]];return h()};s[f]=!0,t.exports=Object.create||function(t,e){var n;return null!==t?(d.prototype=i(t),n=new d,d.prototype=null,n[f]=t):n=h(),void 0===e?n:o(n,e)}},function(t,e,n){"use strict";var r=n(35),i=n(328),o=n(172),a=n(173),s=n(99),c=n(15),l=n(36),u=n(1),f=n(91),d=n(37),p=n(171),h=p.IteratorPrototype,v=p.BUGGY_SAFARI_ITERATORS,m=u("iterator"),g=function(){return this};t.exports=function(t,e,n,u,p,A,y){i(n,e,u);var b,C,x,w=function(t){if(t===p&&T)return T;if(!v&&t in I)return I[t];switch(t){case"keys":case"values":case"entries":return function(){return new n(this,t)}}return function(){return new n(this)}},E=e+" Iterator",O=!1,I=t.prototype,S=I[m]||I["@@iterator"]||p&&I[p],T=!v&&S||w(p),L="Array"==e&&I.entries||S;if(L&&(b=o(L.call(new t)),h!==Object.prototype&&b.next&&(f||o(b)===h||(a?a(b,h):"function"!=typeof b[m]&&c(b,m,g)),s(b,E,!0,!0),f&&(d[E]=g))),"values"==p&&S&&"values"!==S.name&&(O=!0,T=function(){return S.call(this)}),f&&!y||I[m]===T||c(I,m,T),d[e]=T,p)if(C={values:w("values"),keys:A?T:w("keys"),entries:w("entries")},y)for(x in C)(v||O||!(x in I))&&l(I,x,C[x]);else r({target:e,proto:!0,forced:v||O},C);return C}},function(t,e,n){var r=n(12).f,i=n(9),o=n(1)("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,o)&&r(t,o,{configurable:!0,value:e})}},function(t,e,n){var r={};r[n(1)("toStringTag")]="z",t.exports="[object z]"===String(r)},,,function(t,e,n){var r=n(375),i=n(62);t.exports=function(t){return r(i(t))}},function(t,e,n){var r=n(10),i=n(42);t.exports=function(t,e){try{i(r,t,e)}catch(n){r[t]=e}return e}},function(t,e,n){"use strict";var r,i,o=n(249),a=n(392),s=RegExp.prototype.exec,c=String.prototype.replace,l=s,u=(r=/a/,i=/b*/g,s.call(r,"a"),s.call(i,"a"),0!==r.lastIndex||0!==i.lastIndex),f=a.UNSUPPORTED_Y||a.BROKEN_CARET,d=void 0!==/()??/.exec("")[1];(u||d||f)&&(l=function(t){var e,n,r,i,a=this,l=f&&a.sticky,p=o.call(a),h=a.source,v=0,m=t;return l&&(-1===(p=p.replace("y","")).indexOf("g")&&(p+="g"),m=String(t).slice(a.lastIndex),a.lastIndex>0&&(!a.multiline||a.multiline&&"\n"!==t[a.lastIndex-1])&&(h="(?: "+h+")",m=" "+m,v++),n=new RegExp("^(?:"+h+")",p)),d&&(n=new RegExp("^"+h+"$(?!\\s)",p)),u&&(e=a.lastIndex),r=s.call(l?n:a,m),l?r?(r.input=r.input.slice(v),r[0]=r[0].slice(v),r.index=a.lastIndex,a.lastIndex+=r[0].length):a.lastIndex=0:u&&r&&(a.lastIndex=a.global?r.index+r[0].length:e),d&&r&&r.length>1&&c.call(r[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)})),r}),t.exports=l},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));var r=n(119),i=function(){var t=Object(r.getLanguage)().replace(/_/g,"-"),e=Object(r.getLocale)();"de-DE"===t&&(t="de");var n={de:{de_CH:"de-CH",gsw:"de-CH",gsw_CH:"de-CH"},fr:{fr_CH:"fr-CH"},it:{it_CH:"it-CH"}}[t];return void 0!==n&&void 0!==n[e]?n[e]:t},o=function(t){var e=t.split("\\").pop().split("/").pop();return[t.substr(0,t.length-e.length-1),e]}},,function(t,e,n){"use strict";
/*
 * @copyright Copyright (c) 2019 Julius Härtl <jus@bitgrid.net>
 *
 * @author Julius Härtl <jus@bitgrid.net>
 *
 * @license GNU AGPL version 3 or any later version
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 *
 */var r="ooxml"===OC.getCapabilities().richdocuments.config.doc_format,i=function(){return r?{document:{extension:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"},spreadsheet:{extension:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},presentation:{extension:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"}}:{document:{extension:"odt",mime:"application/vnd.oasis.opendocument.text"},spreadsheet:{extension:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"},presentation:{extension:"odp",mime:"application/vnd.oasis.opendocument.presentation"}}};e.a={getFileTypes:i,getFileType:function(t){return i()[t]}}},,,,,,,,,,function(t,e,n){var r=n(10),i=n(42),o=n(27),a=n(104),s=n(192),c=n(377),l=c.get,u=c.enforce,f=String(String).split("String");(t.exports=function(t,e,n,s){var c=!!s&&!!s.unsafe,l=!!s&&!!s.enumerable,d=!!s&&!!s.noTargetGet;"function"==typeof n&&("string"!=typeof e||o(n,"name")||i(n,"name",e),u(n).source=f.join("string"==typeof e?e:"")),t!==r?(c?!d&&t[e]&&(l=!0):delete t[e],l?t[e]=n:i(t,e,n)):l?t[e]=n:a(e,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&l(this).source||s(this)}))},function(t,e,n){"use strict";function r(){return"undefined"==typeof OC?(console.warn("No OC found"),"en"):OC.getLocale()}n(123),n(250),Object.defineProperty(e,"__esModule",{value:!0}),e.getLocale=r,e.getCanonicalLocale=function(){return r().replace(/_/g,"-")},e.getLanguage=function(){if("undefined"==typeof OC)return console.warn("No OC found"),"en";return OC.getLanguage()},e.translate=function(t,e,n,r,i){if("undefined"==typeof OC)return console.warn("No OC found"),e;return OC.L10N.translate(t,e,n,r,i)},e.translatePlural=function(t,e,n,r,i,o){if("undefined"==typeof OC)return console.warn("No OC found"),e;return OC.L10N.translatePlural(t,e,n,r,i,o)},e.getFirstDay=function(){if(void 0===window.firstDay)return console.warn("No firstDay found"),1;return window.firstDay},e.getDayNames=function(){if(void 0===window.dayNames)return console.warn("No dayNames found"),["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return window.dayNames},e.getDayNamesShort=function(){if(void 0===window.dayNamesShort)return console.warn("No dayNamesShort found"),["Sun.","Mon.","Tue.","Wed.","Thu.","Fri.","Sat."];return window.dayNamesShort},e.getDayNamesMin=function(){if(void 0===window.dayNamesMin)return console.warn("No dayNamesMin found"),["Su","Mo","Tu","We","Th","Fr","Sa"];return window.dayNamesMin},e.getMonthNames=function(){if(void 0===window.monthNames)return console.warn("No monthNames found"),["January","February","March","April","May","June","July","August","September","October","November","December"];return window.monthNames},e.getMonthNamesShort=function(){if(void 0===window.monthNamesShort)return console.warn("No monthNamesShort found"),["Jan.","Feb.","Mar.","Apr.","May.","Jun.","Jul.","Aug.","Sep.","Oct.","Nov.","Dec."];return window.monthNamesShort}},,,,function(t,e,n){"use strict";var r=n(373),i=n(105);r({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},,function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var c,l=[],u=!1,f=-1;function d(){u&&c&&(u=!1,c.length?l=c.concat(l):f=-1,l.length&&p())}function p(){if(!u){var t=s(d);u=!0;for(var e=l.length;e;){for(c=l,l=[];++f<e;)c&&c[f].run();f=-1,e=l.length}c=null,u=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function h(t,e){this.fun=t,this.array=e}function v(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new h(t,e)),1!==l.length||u||s(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},,,,function(t,e,n){var r=n(25),i=n(131),o=n(132),a=n(78),s=n(134),c=n(20),l=n(135),u=Object.getOwnPropertyDescriptor;e.f=r?u:function(t,e){if(t=a(t),e=s(e,!0),l)try{return u(t,e)}catch(t){}if(c(t,e))return o(!i.f.call(t,e),t[e])}},function(t,e,n){"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!r.call({1:2},1);e.f=o?function(t){var e=i(this,t);return!!e&&e.enumerable}:r},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var r=n(4),i=n(79),o="".split;t.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==i(t)?o.call(t,""):Object(t)}:Object},function(t,e,n){var r=n(51);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var r=n(25),i=n(4),o=n(271);t.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},function(t,e,n){var r=n(25),i=n(135),o=n(34),a=n(134),s=Object.defineProperty;e.f=r?s:function(t,e,n){if(o(t),e=a(e,!0),o(n),i)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var r=n(138),i=Function.toString;"function"!=typeof r.inspectSource&&(r.inspectSource=function(t){return i.call(t)}),t.exports=r.inspectSource},function(t,e,n){var r=n(7),i=n(80),o=r["__core-js_shared__"]||i("__core-js_shared__",{});t.exports=o},function(t,e,n){var r=n(275),i=n(138);(t.exports=function(t,e){return i[t]||(i[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.6.5",mode:r?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++n+r).toString(36)}},function(t,e){t.exports={}},function(t,e,n){var r=n(20),i=n(78),o=n(143).indexOf,a=n(141);t.exports=function(t,e){var n,s=i(t),c=0,l=[];for(n in s)!r(a,n)&&r(s,n)&&l.push(n);for(;e.length>c;)r(s,n=e[c++])&&(~o(l,n)||l.push(n));return l}},function(t,e,n){var r=n(78),i=n(144),o=n(281),a=function(t){return function(e,n,a){var s,c=r(e),l=i(c.length),u=o(a,l);if(t&&n!=n){for(;l>u;)if((s=c[u++])!=s)return!0}else for(;l>u;u++)if((t||u in c)&&c[u]===n)return t||u||0;return!t&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},function(t,e,n){var r=n(53),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var r=n(50);t.exports=function(t){return Object(r(t))}},function(t,e,n){var r=n(4);t.exports=!!Object.getOwnPropertySymbols&&!r((function(){return!String(Symbol())}))},function(t,e,n){"use strict";var r=n(77),i=n(83);r({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},function(t,e,n){"use strict";var r=n(34);t.exports=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){const{MAX_SAFE_COMPONENT_LENGTH:r}=n(84),i=n(152),o=(e=t.exports={}).re=[],a=e.src=[],s=e.t={};let c=0;const l=(t,e,n)=>{const r=c++;i(r,e),s[t]=r,a[r]=e,o[r]=new RegExp(e,n?"g":void 0)};l("NUMERICIDENTIFIER","0|[1-9]\\d*"),l("NUMERICIDENTIFIERLOOSE","[0-9]+"),l("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),l("MAINVERSION",`(${a[s.NUMERICIDENTIFIER]})\\.(${a[s.NUMERICIDENTIFIER]})\\.(${a[s.NUMERICIDENTIFIER]})`),l("MAINVERSIONLOOSE",`(${a[s.NUMERICIDENTIFIERLOOSE]})\\.(${a[s.NUMERICIDENTIFIERLOOSE]})\\.(${a[s.NUMERICIDENTIFIERLOOSE]})`),l("PRERELEASEIDENTIFIER",`(?:${a[s.NUMERICIDENTIFIER]}|${a[s.NONNUMERICIDENTIFIER]})`),l("PRERELEASEIDENTIFIERLOOSE",`(?:${a[s.NUMERICIDENTIFIERLOOSE]}|${a[s.NONNUMERICIDENTIFIER]})`),l("PRERELEASE",`(?:-(${a[s.PRERELEASEIDENTIFIER]}(?:\\.${a[s.PRERELEASEIDENTIFIER]})*))`),l("PRERELEASELOOSE",`(?:-?(${a[s.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${a[s.PRERELEASEIDENTIFIERLOOSE]})*))`),l("BUILDIDENTIFIER","[0-9A-Za-z-]+"),l("BUILD",`(?:\\+(${a[s.BUILDIDENTIFIER]}(?:\\.${a[s.BUILDIDENTIFIER]})*))`),l("FULLPLAIN",`v?${a[s.MAINVERSION]}${a[s.PRERELEASE]}?${a[s.BUILD]}?`),l("FULL",`^${a[s.FULLPLAIN]}$`),l("LOOSEPLAIN",`[v=\\s]*${a[s.MAINVERSIONLOOSE]}${a[s.PRERELEASELOOSE]}?${a[s.BUILD]}?`),l("LOOSE",`^${a[s.LOOSEPLAIN]}$`),l("GTLT","((?:<|>)?=?)"),l("XRANGEIDENTIFIERLOOSE",a[s.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*"),l("XRANGEIDENTIFIER",a[s.NUMERICIDENTIFIER]+"|x|X|\\*"),l("XRANGEPLAIN",`[v=\\s]*(${a[s.XRANGEIDENTIFIER]})(?:\\.(${a[s.XRANGEIDENTIFIER]})(?:\\.(${a[s.XRANGEIDENTIFIER]})(?:${a[s.PRERELEASE]})?${a[s.BUILD]}?)?)?`),l("XRANGEPLAINLOOSE",`[v=\\s]*(${a[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[s.XRANGEIDENTIFIERLOOSE]})(?:${a[s.PRERELEASELOOSE]})?${a[s.BUILD]}?)?)?`),l("XRANGE",`^${a[s.GTLT]}\\s*${a[s.XRANGEPLAIN]}$`),l("XRANGELOOSE",`^${a[s.GTLT]}\\s*${a[s.XRANGEPLAINLOOSE]}$`),l("COERCE",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?(?:$|[^\\d])`),l("COERCERTL",a[s.COERCE],!0),l("LONETILDE","(?:~>?)"),l("TILDETRIM",`(\\s*)${a[s.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",l("TILDE",`^${a[s.LONETILDE]}${a[s.XRANGEPLAIN]}$`),l("TILDELOOSE",`^${a[s.LONETILDE]}${a[s.XRANGEPLAINLOOSE]}$`),l("LONECARET","(?:\\^)"),l("CARETTRIM",`(\\s*)${a[s.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",l("CARET",`^${a[s.LONECARET]}${a[s.XRANGEPLAIN]}$`),l("CARETLOOSE",`^${a[s.LONECARET]}${a[s.XRANGEPLAINLOOSE]}$`),l("COMPARATORLOOSE",`^${a[s.GTLT]}\\s*(${a[s.LOOSEPLAIN]})$|^$`),l("COMPARATOR",`^${a[s.GTLT]}\\s*(${a[s.FULLPLAIN]})$|^$`),l("COMPARATORTRIM",`(\\s*)${a[s.GTLT]}\\s*(${a[s.LOOSEPLAIN]}|${a[s.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",l("HYPHENRANGE",`^\\s*(${a[s.XRANGEPLAIN]})\\s+-\\s+(${a[s.XRANGEPLAIN]})\\s*$`),l("HYPHENRANGELOOSE",`^\\s*(${a[s.XRANGEPLAINLOOSE]})\\s+-\\s+(${a[s.XRANGEPLAINLOOSE]})\\s*$`),l("STAR","(<|>)?=?\\s*\\*"),l("GTE0","^\\s*>=\\s*0.0.0\\s*$"),l("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")},function(t,e,n){(function(e){const n="object"==typeof e&&e.env&&e.env.NODE_DEBUG&&/\bsemver\b/i.test(e.env.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};t.exports=n}).call(this,n(126))},function(t,e,n){const r=n(152),{MAX_LENGTH:i,MAX_SAFE_INTEGER:o}=n(84),{re:a,t:s}=n(151),c=n(154),{compareIdentifiers:l}=n(304);class u{constructor(t,e){if(e=c(e),t instanceof u){if(t.loose===!!e.loose&&t.includePrerelease===!!e.includePrerelease)return t;t=t.version}else if("string"!=typeof t)throw new TypeError("Invalid Version: "+t);if(t.length>i)throw new TypeError(`version is longer than ${i} characters`);r("SemVer",t,e),this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease;const n=t.trim().match(e.loose?a[s.LOOSE]:a[s.FULL]);if(!n)throw new TypeError("Invalid Version: "+t);if(this.raw=t,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(t=>{if(/^[0-9]+$/.test(t)){const e=+t;if(e>=0&&e<o)return e}return t}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version}toString(){return this.version}compare(t){if(r("SemVer.compare",this.version,this.options,t),!(t instanceof u)){if("string"==typeof t&&t===this.version)return 0;t=new u(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof u||(t=new u(t,this.options)),l(this.major,t.major)||l(this.minor,t.minor)||l(this.patch,t.patch)}comparePre(t){if(t instanceof u||(t=new u(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let e=0;do{const n=this.prerelease[e],i=t.prerelease[e];if(r("prerelease compare",e,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return l(n,i)}while(++e)}compareBuild(t){t instanceof u||(t=new u(t,this.options));let e=0;do{const n=this.build[e],i=t.build[e];if(r("prerelease compare",e,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return l(n,i)}while(++e)}inc(t,e){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",e),this.inc("pre",e);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let t=this.prerelease.length;for(;--t>=0;)"number"==typeof this.prerelease[t]&&(this.prerelease[t]++,t=-2);-1===t&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error("invalid increment argument: "+t)}return this.format(),this.raw=this.version,this}}t.exports=u},function(t,e){const n=["includePrerelease","loose","rtl"];t.exports=t=>t?"object"!=typeof t?{loose:!0}:n.filter(e=>t[e]).reduce((t,e)=>(t[e]=!0,t),{}):{}},function(t,e,n){var r=n(21),i=n(308),o=n(54),a=n(55),s=n(87),c=n(9),l=n(157),u=Object.getOwnPropertyDescriptor;e.f=r?u:function(t,e){if(t=a(t),e=s(e,!0),l)try{return u(t,e)}catch(t){}if(c(t,e))return o(!i.f.call(t,e),t[e])}},function(t,e,n){var r=n(2),i=n(85),o="".split;t.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==i(t)?o.call(t,""):Object(t)}:Object},function(t,e,n){var r=n(21),i=n(2),o=n(158);t.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},function(t,e,n){var r=n(0),i=n(8),o=r.document,a=i(o)&&i(o.createElement);t.exports=function(t){return a?o.createElement(t):{}}},function(t,e,n){var r=n(89),i=Function.toString;"function"!=typeof r.inspectSource&&(r.inspectSource=function(t){return i.call(t)}),t.exports=r.inspectSource},function(t,e,n){var r=n(91),i=n(89);(t.exports=function(t,e){return i[t]||(i[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.9.0",mode:r?"pure":"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"})},function(t,e,n){var r=n(9),i=n(55),o=n(314).indexOf,a=n(57);t.exports=function(t,e){var n,s=i(t),c=0,l=[];for(n in s)!r(a,n)&&r(s,n)&&l.push(n);for(;e.length>c;)r(s,n=e[c++])&&(~o(l,n)||l.push(n));return l}},function(t,e,n){var r=n(2),i=/#|\.prototype\./,o=function(t,e){var n=s[a(t)];return n==l||n!=c&&("function"==typeof e?r(e):!!e)},a=o.normalize=function(t){return String(t).replace(i,".").toLowerCase()},s=o.data={},c=o.NATIVE="N",l=o.POLYFILL="P";t.exports=o},function(t,e,n){var r=n(85);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,e,n){var r=n(8),i=n(163),o=n(1)("species");t.exports=function(t,e){var n;return i(t)&&("function"!=typeof(n=t.constructor)||n!==Array&&!i(n.prototype)?r(n)&&null===(n=n[o])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===e?0:e)}},function(t,e,n){var r=n(2);t.exports=!!Object.getOwnPropertySymbols&&!r((function(){return!String(Symbol())}))},function(t,e,n){var r=n(2),i=n(1),o=n(167),a=i("species");t.exports=function(t){return o>=51||!r((function(){var e=[];return(e.constructor={})[a]=function(){return{foo:1}},1!==e[t](Boolean).foo}))}},function(t,e,n){var r,i,o=n(0),a=n(319),s=o.process,c=s&&s.versions,l=c&&c.v8;l?i=(r=l.split("."))[0]+r[1]:a&&(!(r=a.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/))&&(i=r[1]),t.exports=i&&+i},function(t,e,n){var r=n(96),i=n(156),o=n(95),a=n(59),s=n(164),c=[].push,l=function(t){var e=1==t,n=2==t,l=3==t,u=4==t,f=6==t,d=7==t,p=5==t||f;return function(h,v,m,g){for(var A,y,b=o(h),C=i(b),x=r(v,m,3),w=a(C.length),E=0,O=g||s,I=e?O(h,w):n||d?O(h,0):void 0;w>E;E++)if((p||E in C)&&(y=x(A=C[E],E,b),t))if(e)I[E]=y;else if(y)switch(t){case 3:return!0;case 5:return A;case 6:return E;case 2:c.call(I,A)}else switch(t){case 4:return!1;case 7:c.call(I,A)}return f?-1:l||u?u:I}};t.exports={forEach:l(0),map:l(1),filter:l(2),some:l(3),every:l(4),find:l(5),findIndex:l(6),filterOut:l(7)}},function(t,e,n){"use strict";var r=n(168).forEach,i=n(323)("forEach");t.exports=i?[].forEach:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}},function(t,e,n){"use strict";var r=n(55),i=n(324),o=n(37),a=n(56),s=n(98),c=a.set,l=a.getterFor("Array Iterator");t.exports=s(Array,"Array",(function(t,e){c(this,{type:"Array Iterator",target:r(t),index:0,kind:e})}),(function(){var t=l(this),e=t.target,n=t.kind,r=t.index++;return!e||r>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:e[r],done:!1}:{value:[r,e[r]],done:!1}}),"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(t,e,n){"use strict";var r,i,o,a=n(2),s=n(172),c=n(15),l=n(9),u=n(1),f=n(91),d=u("iterator"),p=!1;[].keys&&("next"in(o=[].keys())?(i=s(s(o)))!==Object.prototype&&(r=i):p=!0);var h=null==r||a((function(){var t={};return r[d].call(t)!==t}));h&&(r={}),f&&!h||l(r,d)||c(r,d,(function(){return this})),t.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:p}},function(t,e,n){var r=n(9),i=n(95),o=n(90),a=n(329),s=o("IE_PROTO"),c=Object.prototype;t.exports=a?Object.getPrototypeOf:function(t){return t=i(t),r(t,s)?t[s]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?c:null}},function(t,e,n){var r=n(22),i=n(330);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),e=n instanceof Array}catch(t){}return function(n,o){return r(n),i(o),e?t.call(n,o):n.__proto__=o,n}}():void 0)},function(t,e,n){var r=n(57),i=n(8),o=n(9),a=n(12).f,s=n(92),c=n(333),l=s("meta"),u=0,f=Object.isExtensible||function(){return!0},d=function(t){a(t,l,{value:{objectID:"O"+ ++u,weakData:{}}})},p=t.exports={REQUIRED:!1,fastKey:function(t,e){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,l)){if(!f(t))return"F";if(!e)return"E";d(t)}return t[l].objectID},getWeakData:function(t,e){if(!o(t,l)){if(!f(t))return!0;if(!e)return!1;d(t)}return t[l].weakData},onFreeze:function(t){return c&&p.REQUIRED&&f(t)&&!o(t,l)&&d(t),t}};r[l]=!0},function(t,e,n){var r=n(22),i=n(334),o=n(59),a=n(96),s=n(335),c=n(336),l=function(t,e){this.stopped=t,this.result=e};t.exports=function(t,e,n){var u,f,d,p,h,v,m,g=n&&n.that,A=!(!n||!n.AS_ENTRIES),y=!(!n||!n.IS_ITERATOR),b=!(!n||!n.INTERRUPTED),C=a(e,g,1+A+b),x=function(t){return u&&c(u),new l(!0,t)},w=function(t){return A?(r(t),b?C(t[0],t[1],x):C(t[0],t[1])):b?C(t,x):C(t)};if(y)u=t;else{if("function"!=typeof(f=s(t)))throw TypeError("Target is not iterable");if(i(f)){for(d=0,p=o(t.length);p>d;d++)if((h=w(t[d]))&&h instanceof l)return h;return new l(!1)}u=f.call(t)}for(v=u.next;!(m=v.call(u)).done;){try{h=w(m.value)}catch(t){throw c(u),t}if("object"==typeof h&&h&&h instanceof l)return h}return new l(!1)}},function(t,e,n){var r=n(100),i=n(85),o=n(1)("toStringTag"),a="Arguments"==i(function(){return arguments}());t.exports=r?i:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),o))?n:a?i(e):"Object"==(r=i(e))&&"function"==typeof e.callee?"Arguments":r}},function(t,e){t.exports=function(t,e,n){if(!(t instanceof e))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return t}},function(t,e){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},,,,,,,,,function(t,e,n){var r=n(61),i=n(374),o=n(188),a=n(103),s=n(189),c=n(27),l=n(190),u=Object.getOwnPropertyDescriptor;e.f=r?u:function(t,e){if(t=a(t),e=s(e,!0),l)try{return u(t,e)}catch(t){}if(c(t,e))return o(!i.f.call(t,e),t[e])}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var r=n(63);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var r=n(61),i=n(19),o=n(376);t.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},function(t,e,n){var r=n(61),i=n(190),o=n(48),a=n(189),s=Object.defineProperty;e.f=r?s:function(t,e,n){if(o(t),e=a(e,!0),o(n),i)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var r=n(193),i=Function.toString;"function"!=typeof r.inspectSource&&(r.inspectSource=function(t){return i.call(t)}),t.exports=r.inspectSource},function(t,e,n){var r=n(10),i=n(104),o=r["__core-js_shared__"]||i("__core-js_shared__",{});t.exports=o},function(t,e,n){var r=n(380),i=n(193);(t.exports=function(t,e){return i[t]||(i[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.6.5",mode:r?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++n+r).toString(36)}},function(t,e){t.exports={}},function(t,e,n){var r=n(64),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},function(t,e,n){var r=n(19);t.exports=!!Object.getOwnPropertySymbols&&!r((function(){return!String(Symbol())}))},,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){var r=n(10),i=n(194),o=n(27),a=n(195),s=n(198),c=n(394),l=i("wks"),u=r.Symbol,f=c?u:u&&u.withoutSetter||a;t.exports=function(t){return o(l,t)||(s&&o(u,t)?l[t]=u[t]:l[t]=f("Symbol."+t)),l[t]}},,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var r=n(48);t.exports=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){"use strict";var r=n(393),i=n(48),o=n(395),a=n(197),s=n(64),c=n(62),l=n(396),u=n(398),f=Math.max,d=Math.min,p=Math.floor,h=/\$([$&'`]|\d\d?|<[^>]*>)/g,v=/\$([$&'`]|\d\d?)/g;r("replace",2,(function(t,e,n,r){var m=r.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,g=r.REPLACE_KEEPS_$0,A=m?"$":"$0";return[function(n,r){var i=c(this),o=null==n?void 0:n[t];return void 0!==o?o.call(n,i,r):e.call(String(i),n,r)},function(t,r){if(!m&&g||"string"==typeof r&&-1===r.indexOf(A)){var o=n(e,t,this,r);if(o.done)return o.value}var c=i(t),p=String(this),h="function"==typeof r;h||(r=String(r));var v=c.global;if(v){var b=c.unicode;c.lastIndex=0}for(var C=[];;){var x=u(c,p);if(null===x)break;if(C.push(x),!v)break;""===String(x[0])&&(c.lastIndex=l(p,a(c.lastIndex),b))}for(var w,E="",O=0,I=0;I<C.length;I++){x=C[I];for(var S=String(x[0]),T=f(d(s(x.index),p.length),0),L=[],N=1;N<x.length;N++)L.push(void 0===(w=x[N])?w:String(w));var k=x.groups;if(h){var M=[S].concat(L,T,p);void 0!==k&&M.push(k);var R=String(r.apply(void 0,M))}else R=y(S,p,T,L,k,r);T>=O&&(E+=p.slice(O,T)+R,O=T+S.length)}return E+p.slice(O)}];function y(t,n,r,i,a,s){var c=r+t.length,l=i.length,u=v;return void 0!==a&&(a=o(a),u=h),e.call(s,u,(function(e,o){var s;switch(o.charAt(0)){case"$":return"$";case"&":return t;case"`":return n.slice(0,r);case"'":return n.slice(c);case"<":s=a[o.slice(1,-1)];break;default:var u=+o;if(0===u)return e;if(u>l){var f=p(u/10);return 0===f?e:f<=l?void 0===i[f-1]?o.charAt(1):i[f-1]+o.charAt(1):e}s=i[u-1]}return void 0===s?"":s}))}}))},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.d(e,"a",(function(){return i}));var i=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.postMessageHandlers=[],this.targets=e,window.addEventListener("message",(function(t){n.handlePostMessage(t.data)}),!1)}var e,n,i;return e=t,i=[{key:"parsePostMessage",value:function(t){var e,n,r;try{var i=JSON.parse(t);e=i.MessageId,n=i.Values,r=!!i.Values.Deprecated}catch(n){e=t}return{msgId:e,args:n,deprecated:r}}}],(n=[{key:"sendPostMessage",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"*";("function"==typeof this.targets[t]?this.targets[t]():this.targets[t]).postMessage(e,n),console.debug("PostMessageService.sendPostMessage",t,e)}},{key:"sendWOPIPostMessage",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={MessageId:e,SendTime:Date.now(),Values:n};this.sendPostMessage(t,JSON.stringify(r))}},{key:"registerPostMessageHandler",value:function(t){this.postMessageHandlers.push(t)}},{key:"unregisterPostMessageHandler",value:function(t){var e=this.postMessageHandlers.findIndex((function(e){return e===t}));delete this.postMessageHandlers[e]}},{key:"handlePostMessage",value:function(e){var n=t.parsePostMessage(e);null!=n&&this.postMessageHandlers.forEach((function(t){n.deprecated?console.debug("PostMessageService.handlePostMessage","Ignoring deprecated post message",n.msgId):t({data:e,parsed:n})}))}}])&&r(e.prototype,n),i&&r(e,i),t}()},,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var r=n(77),i=n(143).indexOf,o=n(283),a=n(284),s=[].indexOf,c=!!s&&1/[1].indexOf(1,-0)<0,l=o("indexOf"),u=a("indexOf",{ACCESSORS:!0,1:0});r({target:"Array",proto:!0,forced:c||!l||!u},{indexOf:function(t){return c?s.apply(this,arguments)||0:i(this,t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){var r=n(7),i=n(51),o=r.document,a=i(o)&&i(o.createElement);t.exports=function(t){return a?o.createElement(t):{}}},function(t,e,n){var r,i,o,a=n(273),s=n(7),c=n(51),l=n(33),u=n(20),f=n(274),d=n(141),p=s.WeakMap;if(a){var h=new p,v=h.get,m=h.has,g=h.set;r=function(t,e){return g.call(h,t,e),e},i=function(t){return v.call(h,t)||{}},o=function(t){return m.call(h,t)}}else{var A=f("state");d[A]=!0,r=function(t,e){return l(t,A,e),e},i=function(t){return u(t,A)?t[A]:{}},o=function(t){return u(t,A)}}t.exports={set:r,get:i,has:o,enforce:function(t){return o(t)?i(t):r(t,{})},getterFor:function(t){return function(e){var n;if(!c(e)||(n=i(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}}}},function(t,e,n){var r=n(7),i=n(137),o=r.WeakMap;t.exports="function"==typeof o&&/native code/.test(i(o))},function(t,e,n){var r=n(139),i=n(140),o=r("keys");t.exports=function(t){return o[t]||(o[t]=i(t))}},function(t,e){t.exports=!1},function(t,e,n){var r=n(20),i=n(277),o=n(130),a=n(136);t.exports=function(t,e){for(var n=i(e),s=a.f,c=o.f,l=0;l<n.length;l++){var u=n[l];r(t,u)||s(t,u,c(e,u))}}},function(t,e,n){var r=n(278),i=n(280),o=n(146),a=n(34);t.exports=r("Reflect","ownKeys")||function(t){var e=i.f(a(t)),n=o.f;return n?e.concat(n(t)):e}},function(t,e,n){var r=n(279),i=n(7),o=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?o(r[t])||o(i[t]):r[t]&&r[t][e]||i[t]&&i[t][e]}},function(t,e,n){var r=n(7);t.exports=r},function(t,e,n){var r=n(142),i=n(145).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},function(t,e,n){var r=n(53),i=Math.max,o=Math.min;t.exports=function(t,e){var n=r(t);return n<0?i(n+e,0):o(n,e)}},function(t,e,n){var r=n(4),i=/#|\.prototype\./,o=function(t,e){var n=s[a(t)];return n==l||n!=c&&("function"==typeof e?r(e):!!e)},a=o.normalize=function(t){return String(t).replace(i,".").toLowerCase()},s=o.data={},c=o.NATIVE="N",l=o.POLYFILL="P";t.exports=o},function(t,e,n){"use strict";var r=n(4);t.exports=function(t,e){var n=[][t];return!!n&&r((function(){n.call(null,e||function(){throw 1},1)}))}},function(t,e,n){var r=n(25),i=n(4),o=n(20),a=Object.defineProperty,s={},c=function(t){throw t};t.exports=function(t,e){if(o(s,t))return s[t];e||(e={});var n=[][t],l=!!o(e,"ACCESSORS")&&e.ACCESSORS,u=o(e,0)?e[0]:c,f=o(e,1)?e[1]:void 0;return s[t]=!!n&&!i((function(){if(l&&!r)return!0;var t={length:-1};l?a(t,1,{enumerable:!0,get:c}):t[1]=1,n.call(t,u,f)}))}},function(t,e,n){var r=n(77),i=n(286);r({target:"Object",stat:!0,forced:Object.assign!==i},{assign:i})},function(t,e,n){"use strict";var r=n(25),i=n(4),o=n(287),a=n(146),s=n(131),c=n(147),l=n(133),u=Object.assign,f=Object.defineProperty;t.exports=!u||i((function(){if(r&&1!==u({b:1},u(f({},"a",{enumerable:!0,get:function(){f(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},n=Symbol();return t[n]=7,"abcdefghijklmnopqrst".split("").forEach((function(t){e[t]=t})),7!=u({},t)[n]||"abcdefghijklmnopqrst"!=o(u({},e)).join("")}))?function(t,e){for(var n=c(t),i=arguments.length,u=1,f=a.f,d=s.f;i>u;)for(var p,h=l(arguments[u++]),v=f?o(h).concat(f(h)):o(h),m=v.length,g=0;m>g;)p=v[g++],r&&!d.call(h,p)||(n[p]=h[p]);return n}:u},function(t,e,n){var r=n(142),i=n(145);t.exports=Object.keys||function(t){return r(t,i)}},function(t,e,n){var r=n(81),i=n(52),o=n(290);r||i(Object.prototype,"toString",o,{unsafe:!0})},function(t,e,n){var r=n(148);t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(t,e,n){"use strict";var r=n(81),i=n(291);t.exports=r?{}.toString:function(){return"[object "+i(this)+"]"}},function(t,e,n){var r=n(81),i=n(79),o=n(82)("toStringTag"),a="Arguments"==i(function(){return arguments}());t.exports=r?i:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),o))?n:a?i(e):"Object"==(r=i(e))&&"function"==typeof e.callee?"Arguments":r}},function(t,e,n){"use strict";var r=n(4);function i(t,e){return RegExp(t,e)}e.UNSUPPORTED_Y=r((function(){var t=i("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),e.BROKEN_CARET=r((function(){var t=i("^r","gy");return t.lastIndex=2,null!=t.exec("str")}))},function(t,e,n){"use strict";var r=n(52),i=n(34),o=n(4),a=n(150),s=RegExp.prototype,c=s.toString,l=o((function(){return"/a/b"!=c.call({source:"a",flags:"b"})})),u="toString"!=c.name;(l||u)&&r(RegExp.prototype,"toString",(function(){var t=i(this),e=String(t.source),n=t.flags;return"/"+e+"/"+String(void 0===n&&t instanceof RegExp&&!("flags"in s)?a.call(t):n)}),{unsafe:!0})},function(t,e,n){"use strict";var r=n(295),i=n(34),o=n(147),a=n(144),s=n(53),c=n(50),l=n(296),u=n(298),f=Math.max,d=Math.min,p=Math.floor,h=/\$([$&'`]|\d\d?|<[^>]*>)/g,v=/\$([$&'`]|\d\d?)/g;r("replace",2,(function(t,e,n,r){var m=r.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,g=r.REPLACE_KEEPS_$0,A=m?"$":"$0";return[function(n,r){var i=c(this),o=null==n?void 0:n[t];return void 0!==o?o.call(n,i,r):e.call(String(i),n,r)},function(t,r){if(!m&&g||"string"==typeof r&&-1===r.indexOf(A)){var o=n(e,t,this,r);if(o.done)return o.value}var c=i(t),p=String(this),h="function"==typeof r;h||(r=String(r));var v=c.global;if(v){var b=c.unicode;c.lastIndex=0}for(var C=[];;){var x=u(c,p);if(null===x)break;if(C.push(x),!v)break;""===String(x[0])&&(c.lastIndex=l(p,a(c.lastIndex),b))}for(var w,E="",O=0,I=0;I<C.length;I++){x=C[I];for(var S=String(x[0]),T=f(d(s(x.index),p.length),0),L=[],N=1;N<x.length;N++)L.push(void 0===(w=x[N])?w:String(w));var k=x.groups;if(h){var M=[S].concat(L,T,p);void 0!==k&&M.push(k);var R=String(r.apply(void 0,M))}else R=y(S,p,T,L,k,r);T>=O&&(E+=p.slice(O,T)+R,O=T+S.length)}return E+p.slice(O)}];function y(t,n,r,i,a,s){var c=r+t.length,l=i.length,u=v;return void 0!==a&&(a=o(a),u=h),e.call(s,u,(function(e,o){var s;switch(o.charAt(0)){case"$":return"$";case"&":return t;case"`":return n.slice(0,r);case"'":return n.slice(c);case"<":s=a[o.slice(1,-1)];break;default:var u=+o;if(0===u)return e;if(u>l){var f=p(u/10);return 0===f?e:f<=l?void 0===i[f-1]?o.charAt(1):i[f-1]+o.charAt(1):e}s=i[u-1]}return void 0===s?"":s}))}}))},function(t,e,n){"use strict";n(149);var r=n(52),i=n(4),o=n(82),a=n(83),s=n(33),c=o("species"),l=!i((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),u="$0"==="a".replace(/./,"$0"),f=o("replace"),d=!!/./[f]&&""===/./[f]("a","$0"),p=!i((function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));t.exports=function(t,e,n,f){var h=o(t),v=!i((function(){var e={};return e[h]=function(){return 7},7!=""[t](e)})),m=v&&!i((function(){var e=!1,n=/a/;return"split"===t&&((n={}).constructor={},n.constructor[c]=function(){return n},n.flags="",n[h]=/./[h]),n.exec=function(){return e=!0,null},n[h](""),!e}));if(!v||!m||"replace"===t&&(!l||!u||d)||"split"===t&&!p){var g=/./[h],A=n(h,""[t],(function(t,e,n,r,i){return e.exec===a?v&&!i?{done:!0,value:g.call(e,n,r)}:{done:!0,value:t.call(n,e,r)}:{done:!1}}),{REPLACE_KEEPS_$0:u,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:d}),y=A[0],b=A[1];r(String.prototype,t,y),r(RegExp.prototype,h,2==e?function(t,e){return b.call(t,this,e)}:function(t){return b.call(t,this)})}f&&s(RegExp.prototype[h],"sham",!0)}},function(t,e,n){"use strict";var r=n(297).charAt;t.exports=function(t,e,n){return e+(n?r(t,e).length:1)}},function(t,e,n){var r=n(53),i=n(50),o=function(t){return function(e,n){var o,a,s=String(i(e)),c=r(n),l=s.length;return c<0||c>=l?t?"":void 0:(o=s.charCodeAt(c))<55296||o>56319||c+1===l||(a=s.charCodeAt(c+1))<56320||a>57343?t?s.charAt(c):o:t?s.slice(c,c+2):a-56320+(o-55296<<10)+65536}};t.exports={codeAt:o(!1),charAt:o(!0)}},function(t,e,n){var r=n(79),i=n(83);t.exports=function(t,e){var n=t.exec;if("function"==typeof n){var o=n.call(t,e);if("object"!=typeof o)throw TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==r(t))throw TypeError("RegExp#exec called on incompatible receiver");return i.call(t,e)}},,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ProxyBus=void 0;var r=o(n(302)),i=o(n(305));function o(t){return t&&t.__esModule?t:{default:t}}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s="1.2.0",c=function(){function t(e){var n,o,a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),a=void 0,(o="bus")in(n=this)?Object.defineProperty(n,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[o]=a,"function"==typeof e.getVersion&&(0,r.default)(e.getVersion())?(0,i.default)(e.getVersion())!==(0,i.default)(this.getVersion())&&console.warn("Proxying an event bus of version "+e.getVersion()+" with "+this.getVersion()):console.warn("Proxying an event bus with an unknown or invalid version"),this.bus=e}var e,n,o;return e=t,(n=[{key:"getVersion",value:function(){return s}},{key:"subscribe",value:function(t,e){this.bus.subscribe(t,e)}},{key:"unsubscribe",value:function(t,e){this.bus.unsubscribe(t,e)}},{key:"emit",value:function(t,e){this.bus.emit(t,e)}}])&&a(e.prototype,n),o&&a(e,o),t}();e.ProxyBus=c},function(t,e,n){const r=n(303);t.exports=(t,e)=>{const n=r(t,e);return n?n.version:null}},function(t,e,n){const{MAX_LENGTH:r}=n(84),{re:i,t:o}=n(151),a=n(153),s=n(154);t.exports=(t,e)=>{if(e=s(e),t instanceof a)return t;if("string"!=typeof t)return null;if(t.length>r)return null;if(!(e.loose?i[o.LOOSE]:i[o.FULL]).test(t))return null;try{return new a(t,e)}catch(t){return null}}},function(t,e){const n=/^[0-9]+$/,r=(t,e)=>{const r=n.test(t),i=n.test(e);return r&&i&&(t=+t,e=+e),t===e?0:r&&!i?-1:i&&!r?1:t<e?-1:1};t.exports={compareIdentifiers:r,rcompareIdentifiers:(t,e)=>r(e,t)}},function(t,e,n){const r=n(153);t.exports=(t,e)=>new r(t,e).major},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n(307),n(320),n(322),n(170),n(331),n(342),n(344),n(346),n(347),Object.defineProperty(e,"__esModule",{value:!0}),e.SimpleBus=void 0;var i="1.2.0",o=function(){function t(){var e,n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=this,n="handlers",r=new Map,n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r}var e,n,o;return e=t,(n=[{key:"getVersion",value:function(){return i}},{key:"subscribe",value:function(t,e){this.handlers.set(t,(this.handlers.get(t)||[]).concat(e))}},{key:"unsubscribe",value:function(t,e){this.handlers.set(t,(this.handlers.get(t)||[]).filter((function(t){return t!=e})))}},{key:"emit",value:function(t,e){(this.handlers.get(t)||[]).forEach((function(t){try{t(e)}catch(t){console.error("could not invoke event listener",t)}}))}}])&&r(e.prototype,n),o&&r(e,o),t}();e.SimpleBus=o},function(t,e,n){"use strict";var r=n(35),i=n(2),o=n(163),a=n(8),s=n(95),c=n(59),l=n(317),u=n(164),f=n(166),d=n(1),p=n(167),h=d("isConcatSpreadable"),v=p>=51||!i((function(){var t=[];return t[h]=!1,t.concat()[0]!==t})),m=f("concat"),g=function(t){if(!a(t))return!1;var e=t[h];return void 0!==e?!!e:o(t)};r({target:"Array",proto:!0,forced:!v||!m},{concat:function(t){var e,n,r,i,o,a=s(this),f=u(a,0),d=0;for(e=-1,r=arguments.length;e<r;e++)if(g(o=-1===e?a:arguments[e])){if(d+(i=c(o.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(n=0;n<i;n++,d++)n in o&&l(f,d,o[n])}else{if(d>=9007199254740991)throw TypeError("Maximum allowed index exceeded");l(f,d++,o)}return f.length=d,f}})},function(t,e,n){"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!r.call({1:2},1);e.f=o?function(t){var e=i(this,t);return!!e&&e.enumerable}:r},function(t,e,n){var r=n(0),i=n(159),o=r.WeakMap;t.exports="function"==typeof o&&/native code/.test(i(o))},function(t,e,n){var r=n(9),i=n(311),o=n(155),a=n(12);t.exports=function(t,e){for(var n=i(e),s=a.f,c=o.f,l=0;l<n.length;l++){var u=n[l];r(t,u)||s(t,u,c(e,u))}}},function(t,e,n){var r=n(58),i=n(313),o=n(316),a=n(22);t.exports=r("Reflect","ownKeys")||function(t){var e=i.f(a(t)),n=o.f;return n?e.concat(n(t)):e}},function(t,e,n){var r=n(0);t.exports=r},function(t,e,n){var r=n(161),i=n(94).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},function(t,e,n){var r=n(55),i=n(59),o=n(315),a=function(t){return function(e,n,a){var s,c=r(e),l=i(c.length),u=o(a,l);if(t&&n!=n){for(;l>u;)if((s=c[u++])!=s)return!0}else for(;l>u;u++)if((t||u in c)&&c[u]===n)return t||u||0;return!t&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},function(t,e,n){var r=n(93),i=Math.max,o=Math.min;t.exports=function(t,e){var n=r(t);return n<0?i(n+e,0):o(n,e)}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){"use strict";var r=n(87),i=n(12),o=n(54);t.exports=function(t,e,n){var a=r(e);a in t?i.f(t,a,o(0,n)):t[a]=n}},function(t,e,n){var r=n(165);t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(t,e,n){var r=n(58);t.exports=r("navigator","userAgent")||""},function(t,e,n){"use strict";var r=n(35),i=n(168).filter;r({target:"Array",proto:!0,forced:!n(166)("filter")},{filter:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}},function(t,e,n){"use strict";var r=n(35),i=n(169);r({target:"Array",proto:!0,forced:[].forEach!=i},{forEach:i})},function(t,e,n){"use strict";var r=n(2);t.exports=function(t,e){var n=[][t];return!!n&&r((function(){n.call(null,e||function(){throw 1},1)}))}},function(t,e,n){var r=n(1),i=n(97),o=n(12),a=r("unscopables"),s=Array.prototype;null==s[a]&&o.f(s,a,{configurable:!0,value:i(null)}),t.exports=function(t){s[a][t]=!0}},function(t,e,n){var r=n(21),i=n(12),o=n(22),a=n(326);t.exports=r?Object.defineProperties:function(t,e){o(t);for(var n,r=a(e),s=r.length,c=0;s>c;)i.f(t,n=r[c++],e[n]);return t}},function(t,e,n){var r=n(161),i=n(94);t.exports=Object.keys||function(t){return r(t,i)}},function(t,e,n){var r=n(58);t.exports=r("document","documentElement")},function(t,e,n){"use strict";var r=n(171).IteratorPrototype,i=n(97),o=n(54),a=n(99),s=n(37),c=function(){return this};t.exports=function(t,e,n){var l=e+" Iterator";return t.prototype=i(r,{next:o(1,n)}),a(t,l,!1,!0),s[l]=c,t}},function(t,e,n){var r=n(2);t.exports=!r((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},function(t,e,n){var r=n(8);t.exports=function(t){if(!r(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype");return t}},function(t,e,n){"use strict";var r=n(332),i=n(339);t.exports=r("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),i)},function(t,e,n){"use strict";var r=n(35),i=n(0),o=n(162),a=n(36),s=n(174),c=n(175),l=n(177),u=n(8),f=n(2),d=n(337),p=n(99),h=n(338);t.exports=function(t,e,n){var v=-1!==t.indexOf("Map"),m=-1!==t.indexOf("Weak"),g=v?"set":"add",A=i[t],y=A&&A.prototype,b=A,C={},x=function(t){var e=y[t];a(y,t,"add"==t?function(t){return e.call(this,0===t?0:t),this}:"delete"==t?function(t){return!(m&&!u(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return m&&!u(t)?void 0:e.call(this,0===t?0:t)}:"has"==t?function(t){return!(m&&!u(t))&&e.call(this,0===t?0:t)}:function(t,n){return e.call(this,0===t?0:t,n),this})};if(o(t,"function"!=typeof A||!(m||y.forEach&&!f((function(){(new A).entries().next()})))))b=n.getConstructor(e,t,v,g),s.REQUIRED=!0;else if(o(t,!0)){var w=new b,E=w[g](m?{}:-0,1)!=w,O=f((function(){w.has(1)})),I=d((function(t){new A(t)})),S=!m&&f((function(){for(var t=new A,e=5;e--;)t[g](e,e);return!t.has(-0)}));I||((b=e((function(e,n){l(e,b,t);var r=h(new A,e,b);return null!=n&&c(n,r[g],{that:r,AS_ENTRIES:v}),r}))).prototype=y,y.constructor=b),(O||S)&&(x("delete"),x("has"),v&&x("get")),(S||E)&&x(g),m&&y.clear&&delete y.clear}return C[t]=b,r({global:!0,forced:b!=A},C),p(b,t),m||n.setStrong(b,t,v),b}},function(t,e,n){var r=n(2);t.exports=!r((function(){return Object.isExtensible(Object.preventExtensions({}))}))},function(t,e,n){var r=n(1),i=n(37),o=r("iterator"),a=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||a[o]===t)}},function(t,e,n){var r=n(176),i=n(37),o=n(1)("iterator");t.exports=function(t){if(null!=t)return t[o]||t["@@iterator"]||i[r(t)]}},function(t,e,n){var r=n(22);t.exports=function(t){var e=t.return;if(void 0!==e)return r(e.call(t)).value}},function(t,e,n){var r=n(1)("iterator"),i=!1;try{var o=0,a={next:function(){return{done:!!o++}},return:function(){i=!0}};a[r]=function(){return this},Array.from(a,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!i)return!1;var n=!1;try{var o={};o[r]=function(){return{next:function(){return{done:n=!0}}}},t(o)}catch(t){}return n}},function(t,e,n){var r=n(8),i=n(173);t.exports=function(t,e,n){var o,a;return i&&"function"==typeof(o=e.constructor)&&o!==n&&r(a=o.prototype)&&a!==n.prototype&&i(t,a),t}},function(t,e,n){"use strict";var r=n(12).f,i=n(97),o=n(340),a=n(96),s=n(177),c=n(175),l=n(98),u=n(341),f=n(21),d=n(174).fastKey,p=n(56),h=p.set,v=p.getterFor;t.exports={getConstructor:function(t,e,n,l){var u=t((function(t,r){s(t,u,e),h(t,{type:e,index:i(null),first:void 0,last:void 0,size:0}),f||(t.size=0),null!=r&&c(r,t[l],{that:t,AS_ENTRIES:n})})),p=v(e),m=function(t,e,n){var r,i,o=p(t),a=g(t,e);return a?a.value=n:(o.last=a={index:i=d(e,!0),key:e,value:n,previous:r=o.last,next:void 0,removed:!1},o.first||(o.first=a),r&&(r.next=a),f?o.size++:t.size++,"F"!==i&&(o.index[i]=a)),t},g=function(t,e){var n,r=p(t),i=d(e);if("F"!==i)return r.index[i];for(n=r.first;n;n=n.next)if(n.key==e)return n};return o(u.prototype,{clear:function(){for(var t=p(this),e=t.index,n=t.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete e[n.index],n=n.next;t.first=t.last=void 0,f?t.size=0:this.size=0},delete:function(t){var e=p(this),n=g(this,t);if(n){var r=n.next,i=n.previous;delete e.index[n.index],n.removed=!0,i&&(i.next=r),r&&(r.previous=i),e.first==n&&(e.first=r),e.last==n&&(e.last=i),f?e.size--:this.size--}return!!n},forEach:function(t){for(var e,n=p(this),r=a(t,arguments.length>1?arguments[1]:void 0,3);e=e?e.next:n.first;)for(r(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!g(this,t)}}),o(u.prototype,n?{get:function(t){var e=g(this,t);return e&&e.value},set:function(t,e){return m(this,0===t?0:t,e)}}:{add:function(t){return m(this,t=0===t?0:t,t)}}),f&&r(u.prototype,"size",{get:function(){return p(this).size}}),u},setStrong:function(t,e,n){var r=e+" Iterator",i=v(e),o=v(r);l(t,e,(function(t,e){h(this,{type:r,target:t,state:i(t),kind:e,last:void 0})}),(function(){for(var t=o(this),e=t.kind,n=t.last;n&&n.removed;)n=n.previous;return t.target&&(t.last=n=n?n.next:t.state.first)?"keys"==e?{value:n.key,done:!1}:"values"==e?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(t.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),u(e)}}},function(t,e,n){var r=n(36);t.exports=function(t,e,n){for(var i in e)r(t,i,e[i],n);return t}},function(t,e,n){"use strict";var r=n(58),i=n(12),o=n(1),a=n(21),s=o("species");t.exports=function(t){var e=r(t),n=i.f;a&&e&&!e[s]&&n(e,s,{configurable:!0,get:function(){return this}})}},function(t,e,n){var r=n(100),i=n(36),o=n(343);r||i(Object.prototype,"toString",o,{unsafe:!0})},function(t,e,n){"use strict";var r=n(100),i=n(176);t.exports=r?{}.toString:function(){return"[object "+i(this)+"]"}},function(t,e,n){"use strict";var r=n(345).charAt,i=n(56),o=n(98),a=i.set,s=i.getterFor("String Iterator");o(String,"String",(function(t){a(this,{type:"String Iterator",string:String(t),index:0})}),(function(){var t,e=s(this),n=e.string,i=e.index;return i>=n.length?{value:void 0,done:!0}:(t=r(n,i),e.index+=t.length,{value:t,done:!1})}))},function(t,e,n){var r=n(93),i=n(86),o=function(t){return function(e,n){var o,a,s=String(i(e)),c=r(n),l=s.length;return c<0||c>=l?t?"":void 0:(o=s.charCodeAt(c))<55296||o>56319||c+1===l||(a=s.charCodeAt(c+1))<56320||a>57343?t?s.charAt(c):o:t?s.slice(c,c+2):a-56320+(o-55296<<10)+65536}};t.exports={codeAt:o(!1),charAt:o(!0)}},function(t,e,n){var r=n(0),i=n(178),o=n(169),a=n(15);for(var s in i){var c=r[s],l=c&&c.prototype;if(l&&l.forEach!==o)try{a(l,"forEach",o)}catch(t){l.forEach=o}}},function(t,e,n){var r=n(0),i=n(178),o=n(170),a=n(15),s=n(1),c=s("iterator"),l=s("toStringTag"),u=o.values;for(var f in i){var d=r[f],p=d&&d.prototype;if(p){if(p[c]!==u)try{a(p,c,u)}catch(t){p[c]=u}if(p[l]||a(p,l,f),i[f])for(var h in o)if(p[h]!==o[h])try{a(p,h,o[h])}catch(t){p[h]=o[h]}}}},,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){var r=n(10),i=n(187).f,o=n(42),a=n(118),s=n(104),c=n(381),l=n(391);t.exports=function(t,e){var n,u,f,d,p,h=t.target,v=t.global,m=t.stat;if(n=v?r:m?r[h]||s(h,{}):(r[h]||{}).prototype)for(u in e){if(d=e[u],f=t.noTargetGet?(p=i(n,u))&&p.value:n[u],!l(v?u:h+(m?".":"#")+u,t.forced)&&void 0!==f){if(typeof d==typeof f)continue;c(d,f)}(t.sham||f&&f.sham)&&o(d,"sham",!0),a(n,u,d,t)}}},function(t,e,n){"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!r.call({1:2},1);e.f=o?function(t){var e=i(this,t);return!!e&&e.enumerable}:r},function(t,e,n){var r=n(19),i=n(124),o="".split;t.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==i(t)?o.call(t,""):Object(t)}:Object},function(t,e,n){var r=n(10),i=n(63),o=r.document,a=i(o)&&i(o.createElement);t.exports=function(t){return a?o.createElement(t):{}}},function(t,e,n){var r,i,o,a=n(378),s=n(10),c=n(63),l=n(42),u=n(27),f=n(379),d=n(196),p=s.WeakMap;if(a){var h=new p,v=h.get,m=h.has,g=h.set;r=function(t,e){return g.call(h,t,e),e},i=function(t){return v.call(h,t)||{}},o=function(t){return m.call(h,t)}}else{var A=f("state");d[A]=!0,r=function(t,e){return l(t,A,e),e},i=function(t){return u(t,A)?t[A]:{}},o=function(t){return u(t,A)}}t.exports={set:r,get:i,has:o,enforce:function(t){return o(t)?i(t):r(t,{})},getterFor:function(t){return function(e){var n;if(!c(e)||(n=i(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}}}},function(t,e,n){var r=n(10),i=n(192),o=r.WeakMap;t.exports="function"==typeof o&&/native code/.test(i(o))},function(t,e,n){var r=n(194),i=n(195),o=r("keys");t.exports=function(t){return o[t]||(o[t]=i(t))}},function(t,e){t.exports=!1},function(t,e,n){var r=n(27),i=n(382),o=n(187),a=n(191);t.exports=function(t,e){for(var n=i(e),s=a.f,c=o.f,l=0;l<n.length;l++){var u=n[l];r(t,u)||s(t,u,c(e,u))}}},function(t,e,n){var r=n(383),i=n(385),o=n(390),a=n(48);t.exports=r("Reflect","ownKeys")||function(t){var e=i.f(a(t)),n=o.f;return n?e.concat(n(t)):e}},function(t,e,n){var r=n(384),i=n(10),o=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?o(r[t])||o(i[t]):r[t]&&r[t][e]||i[t]&&i[t][e]}},function(t,e,n){var r=n(10);t.exports=r},function(t,e,n){var r=n(386),i=n(389).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},function(t,e,n){var r=n(27),i=n(103),o=n(387).indexOf,a=n(196);t.exports=function(t,e){var n,s=i(t),c=0,l=[];for(n in s)!r(a,n)&&r(s,n)&&l.push(n);for(;e.length>c;)r(s,n=e[c++])&&(~o(l,n)||l.push(n));return l}},function(t,e,n){var r=n(103),i=n(197),o=n(388),a=function(t){return function(e,n,a){var s,c=r(e),l=i(c.length),u=o(a,l);if(t&&n!=n){for(;l>u;)if((s=c[u++])!=s)return!0}else for(;l>u;u++)if((t||u in c)&&c[u]===n)return t||u||0;return!t&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},function(t,e,n){var r=n(64),i=Math.max,o=Math.min;t.exports=function(t,e){var n=r(t);return n<0?i(n+e,0):o(n,e)}},function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var r=n(19),i=/#|\.prototype\./,o=function(t,e){var n=s[a(t)];return n==l||n!=c&&("function"==typeof e?r(e):!!e)},a=o.normalize=function(t){return String(t).replace(i,".").toLowerCase()},s=o.data={},c=o.NATIVE="N",l=o.POLYFILL="P";t.exports=o},function(t,e,n){"use strict";var r=n(19);function i(t,e){return RegExp(t,e)}e.UNSUPPORTED_Y=r((function(){var t=i("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),e.BROKEN_CARET=r((function(){var t=i("^r","gy");return t.lastIndex=2,null!=t.exec("str")}))},function(t,e,n){"use strict";n(123);var r=n(118),i=n(19),o=n(225),a=n(105),s=n(42),c=o("species"),l=!i((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),u="$0"==="a".replace(/./,"$0"),f=o("replace"),d=!!/./[f]&&""===/./[f]("a","$0"),p=!i((function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));t.exports=function(t,e,n,f){var h=o(t),v=!i((function(){var e={};return e[h]=function(){return 7},7!=""[t](e)})),m=v&&!i((function(){var e=!1,n=/a/;return"split"===t&&((n={}).constructor={},n.constructor[c]=function(){return n},n.flags="",n[h]=/./[h]),n.exec=function(){return e=!0,null},n[h](""),!e}));if(!v||!m||"replace"===t&&(!l||!u||d)||"split"===t&&!p){var g=/./[h],A=n(h,""[t],(function(t,e,n,r,i){return e.exec===a?v&&!i?{done:!0,value:g.call(e,n,r)}:{done:!0,value:t.call(n,e,r)}:{done:!1}}),{REPLACE_KEEPS_$0:u,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:d}),y=A[0],b=A[1];r(String.prototype,t,y),r(RegExp.prototype,h,2==e?function(t,e){return b.call(t,this,e)}:function(t){return b.call(t,this)})}f&&s(RegExp.prototype[h],"sham",!0)}},function(t,e,n){var r=n(198);t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(t,e,n){var r=n(62);t.exports=function(t){return Object(r(t))}},function(t,e,n){"use strict";var r=n(397).charAt;t.exports=function(t,e,n){return e+(n?r(t,e).length:1)}},function(t,e,n){var r=n(64),i=n(62),o=function(t){return function(e,n){var o,a,s=String(i(e)),c=r(n),l=s.length;return c<0||c>=l?t?"":void 0:(o=s.charCodeAt(c))<55296||o>56319||c+1===l||(a=s.charCodeAt(c+1))<56320||a>57343?t?s.charAt(c):o:t?s.slice(c,c+2):a-56320+(o-55296<<10)+65536}};t.exports={codeAt:o(!1),charAt:o(!0)}},function(t,e,n){var r=n(124),i=n(105);t.exports=function(t,e){var n=t.exec;if("function"==typeof n){var o=n.call(t,e);if("object"!=typeof o)throw TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==r(t))throw TypeError("RegExp#exec called on incompatible receiver");return i.call(t,e)}},function(e,n,r){"use strict";var i=r(108),o={attach:function(e){var n=this,r=i.a.getFileType("document"),o=i.a.getFileType("spreadsheet"),a=i.a.getFileType("presentation");e.addMenuEntry({id:"add-"+r.extension,displayName:t("richdocuments","New Document"),templateName:t("richdocuments","New Document")+"."+r.extension,iconClass:"icon-filetype-document",fileType:"x-office-document",actionHandler:function(t){OC.getCapabilities().richdocuments.templates?n._openTemplatePicker("document",r.mime,t):n._createDocument(r.mime,t)}}),e.addMenuEntry({id:"add-"+o.extension,displayName:t("richdocuments","New Spreadsheet"),templateName:t("richdocuments","New Spreadsheet")+"."+o.extension,iconClass:"icon-filetype-spreadsheet",fileType:"x-office-spreadsheet",actionHandler:function(t){OC.getCapabilities().richdocuments.templates?n._openTemplatePicker("spreadsheet",o.mime,t):n._createDocument(o.mime,t)}}),e.addMenuEntry({id:"add-"+a.extension,displayName:t("richdocuments","New Presentation"),templateName:t("richdocuments","New Presentation")+"."+a.extension,iconClass:"icon-filetype-presentation",fileType:"x-office-presentation",actionHandler:function(t){OC.getCapabilities().richdocuments.templates?n._openTemplatePicker("presentation",a.mime,t):n._createDocument(a.mime,t)}})},_createDocument:function(e,n){OCA.Files.Files.isFileNameValid(n),n=FileList.getUniqueName(n),$.post(OC.generateUrl("apps/richdocuments/ajax/documents/create"),{mimetype:e,filename:n,dir:document.getElementById("dir").value},(function(e){e&&"success"===e.status?FileList.add(e.data,{animate:!0,scrollTo:!0}):OC.dialogs.alert(e.data.message,t("core","Could not create file"))}))},_createDocumentFromTemplate:function(e,n,r){OCA.Files.Files.isFileNameValid(r),r=FileList.getUniqueName(r),$.post(OC.generateUrl("apps/richdocuments/ajax/documents/create"),{mimetype:n,filename:r,dir:document.getElementById("dir").value},(function(n){if(n&&"success"===n.status){FileList.add(n.data,{animate:!1,scrollTo:!1});var i=FileList.getModelForFile(r),o=document.getElementById("dir").value+"/"+r;OCA.RichDocuments.openWithTemplate({fileId:-1,path:o,templateId:e,fileList:window.FileList,fileModel:i})}else OC.dialogs.alert(n.data.message,t("core","Could not create file"))}))},_openTemplatePicker:function(e,n,r){var i=this;$.ajax({url:OC.linkToOCS("apps/richdocuments/api/v1/templates",2)+e,dataType:"json"}).then((function(e){if(1!==e.ocs.data.length)i._buildTemplatePicker(e.ocs.data).then((function(){var e=[{text:t("core","Cancel"),classes:"cancel",click:function(){$(this).ocdialog("close")}},{text:t("richdocuments","Create"),classes:"primary",click:function(){var t=this.dataset.templateId;i._createDocumentFromTemplate(t,n,r),$(this).ocdialog("close")}}];$("#template-picker").ocdialog({closeOnEscape:!0,modal:!0,buttons:e}).on("click",".foldersTab label",(function(){$(".folderWrapper").each((function(){$(this).toggleClass("hidden")}))}))}));else{var o=e.ocs.data[0].id;i._createDocumentFromTemplate(o,n,r)}}))},_buildTemplatePicker:function(e){var n=this;return $.get(OC.filePath("richdocuments","templates","templatePicker.html"),(function(r){var i=$(r).octemplate({dialog_name:"template-picker",dialog_title:t("richdocuments","Select template"),defultTemplate_title:t("richdocuments","User Templates"),templaterepo_title:t("richdocuments","Templaterepo")});if(_.values(e).forEach((function(t){n._appendTemplateFromData(i[0],t)})),$("body").append(i),$(".templaterepoFolder").children().length<1){var o="<em>".concat(t("richdocuments","No Template"),"</em>");$(".templaterepoFolder").append(o).css("justify-content","center")}}))},_appendTemplateFromData:function(t,e){var n=t.querySelector(".template-model").cloneNode(!0);n.className="",n.querySelector("img").src=OC.generateUrl("apps/richdocuments/template/preview/"+e.id),e.preview?n.querySelector("img").src=e.preview:n.querySelector("img").classList.add("emptyImg"),n.querySelector("h2").textContent=e.name,n.onclick=function(){t.dataset.templateId=e.id},t.dataset.templateId||(t.dataset.templateId=e.id),e.templaterepoFolder?t.querySelector(".templaterepoFolder").appendChild(n):t.querySelector(".defultFolder").appendChild(n)}};
/*
 * @copyright Copyright (c) 2020 Julius Härtl <jus@bitgrid.net>
 *
 * @author Julius Härtl <jus@bitgrid.net>
 *
 * @license GNU AGPL version 3 or any later version
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 *
 */n.a=o},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";t.exports=function(t,e){return e||(e={}),"string"!=typeof(t=t&&t.__esModule?t.default:t)?t:(/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),e.hash&&(t+=e.hash),/["'() \t\n]/.test(t)||e.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t)}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var r=n(44),i=n.n(r),o=n(45),a=n.n(o),s=n(559),c=n.n(s),l=n(812),u=n(813),f=n(814),d=a()(i.a),p=c()(l.a),h=c()(u.a),v=c()(f.a);d.push([t.i,"#odf-canvas{position:relative;top:37px;left:0px;border:1px solid darkgray;border-left:0 none;box-shadow:0px 4px 10px #000;-moz-box-shadow:0px 4px 10px #000;-webkit-box-shadow:0px 4px 10px #000}.icon-filetype-document{background-image:url("+p+")}.icon-filetype-spreadsheet{background-image:url("+h+")}.icon-filetype-presentation{background-image:url("+v+")}.richdocuments-sharing .icon-shared{display:block;width:16px;height:16px;padding:16px;opacity:0.6}.richdocuments-sharing .icon-shared:hover,.richdocuments-sharing .icon-shared:focus{opacity:1}#richdocumentsframe{background-color:#fff;width:100%;height:calc(100vh - 50px);display:block;position:absolute;top:0;z-index:110}#editors-menu{min-width:200px;top:50px}#editors-menu ul li{display:flex;padding:3px;border-left:3px solid transparent}#editors-menu ul li.active{border-left:3px solid var(--color-primary)}#editors-menu ul li .label{padding:6px;flex-grow:1}#editors-menu ul li .label .icon-play-next{opacity:.5;display:inline-block;padding-left:10px;vertical-align:top}#editors-menu ul li label.label::before{margin-right:16px;margin-left:7px}#editors-menu ul li .icon-close{padding:8px}#richdocuments-avatars{position:relative;right:-15px}#richdocuments-avatars>.richdocuments-avatar{float:right;border-radius:50%;margin:8px;margin-left:-20px;box-shadow:0px 0px 3px rgba(0,0,0,0.5);position:relative}#richdocuments-avatars>.richdocuments-avatar.read-only{opacity:0.8}#richdocuments-header{display:flex}#richdocuments-header>div .icon-shared,#richdocuments-header>div .icon-more{display:block;min-width:50px;height:50px}#richdocuments-actions{position:relative}#richdocuments-actions li{white-space:nowrap}#richdocuments-actions li a.icon-loading-small:after{left:19px}#versionsTabView li{padding-left:15px;margin-left:-15px}#versionsTabView li.active{border-left:3px solid var(--color-primary, #000);padding-left:12px}#currentVersion li,#lastSavedVersion li{border-bottom:1px solid rgba(100,100,100,0.1)}#currentVersion li .version-container .downloadVersion,#lastSavedVersion li .version-container .downloadVersion{display:flex;flex-direction:column;margin-left:12px}#template-picker .template-container:not(.hidden){display:flex;flex-wrap:wrap}#template-picker .template-container:not(.hidden) a{border-radius:var(--border-radius);border:1px solid var(--color-border);margin:10px;position:relative}#template-picker .template-container:not(.hidden) a:hover,#template-picker .template-container:not(.hidden) a:focus{border-color:var(--color-primary-element)}#template-picker .template-container:not(.hidden) a>span{display:flex;flex-direction:column;width:170px;margin:10px;cursor:pointer}#template-picker .template-container:not(.hidden) a>span>img,#template-picker .template-container:not(.hidden) a>span>span{width:170px;height:240.42857px;background-color:var(--color-background-dark);background-size:24px}#template-picker .template-container:not(.hidden) a>span>h2{margin-top:10px;font-size:inherit}#template-picker .template-container:not(.hidden) .folderWrapper{width:100%}#template-picker .template-container:not(.hidden) .folderWrapper>div:not(.foldersTab){display:flex;flex-wrap:wrap}#template-picker .template-container:not(.hidden) .folderWrapper>div:not(.foldersTab) a{border-radius:3px;border-radius:var(--border-radius);border:1px solid var(--color-border);margin:10px;position:relative}#template-picker .template-container:not(.hidden) .folderWrapper>div:not(.foldersTab) a:hover,#template-picker .template-container:not(.hidden) .folderWrapper>div:not(.foldersTab) a:focus{background-color:var(--color-primary-element);transition:all 0.2s ease-out}#template-picker .template-container:not(.hidden) .folderWrapper>div:not(.foldersTab) a>span{display:flex;flex-direction:column;width:170px;margin:10px;cursor:pointer}#template-picker .template-container:not(.hidden) .folderWrapper>div:not(.foldersTab) a>span>img,#template-picker .template-container:not(.hidden) .folderWrapper>div:not(.foldersTab) a>span>span{width:170px;height:240.42857px;background-color:var(--color-background-dark);background-size:24px}#template-picker .template-container:not(.hidden) .folderWrapper>div:not(.foldersTab) a>span>h2{margin-top:10px;font-size:inherit;word-break:break-all}#template-picker .template-container:not(.hidden) .folderWrapper>div:not(.foldersTab) .emptyImg{position:relative}#template-picker .template-container:not(.hidden) .folderWrapper>div:not(.foldersTab) .emptyImg::before{content:'';position:absolute;background-color:#e9e9e9;width:100%;height:100%}#template-picker .template-container:not(.hidden) .foldersTab{width:100%;margin:35px 10px 30px 10px;display:flex;justify-content:space-between}#template-picker .template-container:not(.hidden) .foldersTab input{display:none}#template-picker .template-container:not(.hidden) .foldersTab input:checked+label{color:gray;background-color:var(--color-border);pointer-events:none;position:relative}#template-picker .template-container:not(.hidden) .foldersTab input:checked+label:after{content:' ';display:block;height:0;width:0;position:absolute;pointer-events:none;border:0 solid #fff;border-top-color:var(--color-border);border-width:15px;bottom:-29px;left:47%}#template-picker .template-container:not(.hidden) .foldersTab input:not(:checked)+label{font-weight:normal;color:gray;border:1px solid var(--color-border)}#template-picker .template-container:not(.hidden) .foldersTab input:not(:checked)+label:hover{color:gray;font-weight:bold;cursor:pointer}#template-picker .template-container:not(.hidden) .foldersTab label{width:100%;display:inline-block;font-size:15px;font-weight:bold;text-align:center;padding:8px 20px;transition:0.1s}\n","",{version:3,sources:["webpack://./css/viewer.scss","webpack://./css/templatePicker.scss"],names:[],mappings:"AAAA,YACC,iBAAkB,CAClB,QAAS,CACT,QAAS,CACT,yBAAyB,CACzB,kBAAkB,CAClB,4BAA6B,CAC7B,iCAAkC,CAClC,oCAAqC,CACrC,wBAGA,wDAAqD,CACrD,2BAGA,wDAAwD,CACxD,4BAGA,wDAAyD,CACzD,oCAGA,aAAc,CACd,UAAW,CACX,WAAY,CACZ,YAAa,CACb,WAAY,CACZ,oFAIA,SAAU,CACV,oBAGA,qBAAsB,CACtB,UAAU,CACV,yBAA0B,CAC1B,aAAa,CACb,iBAAiB,CACjB,KAAK,CACL,WAAW,CACX,cAGA,eAAgB,CAChB,QAAS,CAFV,oBAKE,YAAa,CACb,WAAY,CACZ,iCAAkC,CAPpC,2BASG,0CAA2C,CAT9C,2BAaG,WAAY,CACZ,WAAY,CAdf,2CAiBI,UAAW,CACX,oBAAqB,CACrB,iBAAkB,CAClB,kBAAmB,CApBvB,wCAwBG,iBAAkB,CAClB,eAAgB,CAzBnB,gCA4BG,WAAY,CACZ,uBAKF,iBAAkB,CAClB,WAAY,CAFb,6CAKE,WAAY,CACZ,iBAAkB,CAClB,UAAW,CACX,iBAAkB,CAClB,sCAA0C,CAC1C,iBAAkB,CAVpB,uDAYG,WAAY,CACZ,sBAKF,YAAa,CADd,4EAIE,aAAc,CACd,cAAe,CACf,WAAY,CACZ,uBAID,iBAAkB,CADnB,0BAGE,kBAAmB,CAHrB,qDAKG,SAAU,CACV,oBAKF,iBAAkB,CAClB,iBAAkB,CAClB,2BAGA,gDAAiD,CACjD,iBAAkB,CAClB,wCAIA,6CAA6C,CAF9C,gHAKE,YAAa,CACb,qBAAsB,CACtB,gBAAiB,CACjB,kDC9GA,YAAa,CACb,cAAe,CAHhB,oDAQE,kCAAmC,CACnC,oCAAqC,CACrC,WAHY,CAIZ,iBAAkB,CAXpB,oHAeG,yCAA0C,CAf7C,yDAmBG,YAAa,CACb,qBAAsB,CACtB,WAhBW,CAiBX,WAfW,CAgBX,cAAe,CAvBlB,2HA0BI,WArBU,CAsBV,kBArBuB,CAsBvB,6CAA8C,CAC9C,oBAAqB,CA7BzB,4DAgCI,eAzBU,CA0BV,iBAAkB,CAClB,iEAaF,UAAW,CAHd,sFAKI,YAAa,CACb,cAAe,CANnB,wFAWK,iBAAkB,CAClB,kCAAmC,CACnC,oCAAqC,CACrC,WAJY,CAKZ,iBAAkB,CAfvB,4LAmBM,6CAA8C,CAC9C,4BAA6B,CApBnC,6FAwBM,YAAa,CACb,qBAAsB,CACtB,WAlBW,CAmBX,WAjBW,CAkBX,cAAe,CA5BrB,mMA+BO,WAvBU,CAwBV,kBAvBuB,CAwBvB,6CAA8C,CAC9C,oBAAqB,CAlC5B,gGAqCO,eA3BU,CA4BV,iBAAkB,CAClB,oBAAqB,CAvC5B,gGA6CK,iBAAkB,CA7CvB,wGA+CM,UAAW,CACX,iBAAkB,CAClB,wBAAyB,CACzB,UAAW,CACX,WAAY,CAnDlB,8DA2DG,UAAW,CACX,0BAA2B,CAC3B,YAAa,CACV,6BAA8B,CA9DpC,oEAgEI,YAAa,CAhEjB,kFAkEK,UAAW,CACX,oCAAqC,CACrC,mBAAoB,CACpB,iBAAkB,CArEvB,wFAuEM,WAAY,CACZ,aAAc,CACd,QAAS,CACT,OAAQ,CACR,iBAAkB,CAClB,mBAAoB,CACpB,mBAAoB,CACpB,oCAAqC,CACrC,iBAAkB,CAClB,YAAa,CACb,QAAS,CAjFf,wFAsFK,kBAAmB,CACnB,UAAW,CACX,oCAAqC,CAxF1C,8FA0FM,UAAW,CACX,gBAAiB,CACjB,cAAe,CA5FrB,oEAiGI,UAAW,CACX,oBAAqB,CACrB,cAAe,CACf,gBAAiB,CACjB,iBAAkB,CAClB,gBAAiB,CACjB,eAAgB",sourcesContent:["#odf-canvas{\n\tposition: relative;\n\ttop: 37px;\n\tleft: 0px;\n\tborder:1px solid darkgray;\n\tborder-left:0 none;\n\tbox-shadow: 0px 4px 10px #000;\n\t-moz-box-shadow: 0px 4px 10px #000;\n\t-webkit-box-shadow: 0px 4px 10px #000;\n}\n\n.icon-filetype-document{\n\tbackground-image: url('../img/x-office-document.svg')\n}\n\n.icon-filetype-spreadsheet{\n\tbackground-image: url('../img/x-office-spreadsheet.svg');\n}\n\n.icon-filetype-presentation{\n\tbackground-image: url('../img/x-office-presentation.svg');\n}\n\n.richdocuments-sharing .icon-shared {\n\tdisplay: block;\n\twidth: 16px;\n\theight: 16px;\n\tpadding: 16px;\n\topacity: 0.6;\n}\n\n.richdocuments-sharing .icon-shared:hover,\n.richdocuments-sharing .icon-shared:focus {\n\topacity: 1;\n}\n\n#richdocumentsframe {\n\tbackground-color: #fff;\n\twidth:100%;\n\theight: calc(100vh - 50px);\n\tdisplay:block;\n\tposition:absolute;\n\ttop:0;\n\tz-index:110;\n}\n\n#editors-menu {\n\tmin-width: 200px;\n\ttop: 50px;\n\n\tul li {\n\t\tdisplay: flex;\n\t\tpadding: 3px;\n\t\tborder-left: 3px solid transparent;\n\t\t&.active {\n\t\t\tborder-left: 3px solid var(--color-primary);\n\t\t}\n\n\t\t.label {\n\t\t\tpadding: 6px;\n\t\t\tflex-grow: 1;\n\n\t\t\t.icon-play-next {\n\t\t\t\topacity: .5;\n\t\t\t\tdisplay: inline-block;\n\t\t\t\tpadding-left: 10px;\n\t\t\t\tvertical-align: top;\n\t\t\t}\n\t\t}\n\t\tlabel.label::before {\n\t\t\tmargin-right: 16px;\n\t\t\tmargin-left: 7px;\n\t\t}\n\t\t.icon-close {\n\t\t\tpadding: 8px;\n\t\t}\n\t}\n}\n\n#richdocuments-avatars {\n\tposition: relative;\n\tright: -15px;\n\n\t& > .richdocuments-avatar {\n\t\tfloat: right;\n\t\tborder-radius: 50%;\n\t\tmargin: 8px;\n\t\tmargin-left: -20px;\n\t\tbox-shadow: 0px 0px 3px rgba(0, 0, 0, 0.5);\n\t\tposition: relative;\n\t\t&.read-only {\n\t\t\topacity: 0.8;\n\t\t}\n\t}\n}\n\n#richdocuments-header {\n\tdisplay: flex;\n\t& > div .icon-shared,\n\t& > div .icon-more {\n\t\tdisplay: block;\n\t\tmin-width: 50px;\n\t\theight: 50px;\n\t}\n}\n\n#richdocuments-actions {\n\tposition: relative;\n\tli {\n\t\twhite-space: nowrap;\n\t\ta.icon-loading-small:after {\n\t\t\tleft: 19px;\n\t\t}\n\t}\n}\n\n#versionsTabView li {\n\tpadding-left: 15px;\n\tmargin-left: -15px;\n}\n\n#versionsTabView li.active {\n\tborder-left: 3px solid var(--color-primary, #000);\n\tpadding-left: 12px;\n}\n\n#currentVersion li,\n#lastSavedVersion li {\n\tborder-bottom: 1px solid rgba(100,100,100,.1);\n\n\t.version-container .downloadVersion {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tmargin-left: 12px;\n\t}\n}\n\n@import 'templatePicker';\n","/**\n * @copyright Copyright (c) 2018, John Molakvoæ (skjnldsv@protonmail.com)\n *\n * @author John Molakvoæ (skjnldsv) <skjnldsv@protonmail.com>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n #template-picker {\n\t.template-container:not(.hidden) {\n\t\tdisplay: flex;\n\t\tflex-wrap: wrap;\n\t\ta {\n\t\t\t$size: 170px;\n\t\t\t$sizeY: $size / 210 * 297;\n\t\t\t$space: 10px;\n\t\t\tborder-radius: var(--border-radius);\n\t\t\tborder: 1px solid var(--color-border);\n\t\t\tmargin: $space;\n\t\t\tposition: relative;\n\n\t\t\t&:hover,\n\t\t\t&:focus {\n\t\t\t\tborder-color: var(--color-primary-element);\n\t\t\t}\n\n\t\t\t> span {\n\t\t\t\tdisplay: flex;\n\t\t\t\tflex-direction: column;\n\t\t\t\twidth: $size;\n\t\t\t\tmargin: $space;\n\t\t\t\tcursor: pointer;\n\t\t\t\t> img,\n\t\t\t\t> span {\n\t\t\t\t\twidth: $size;\n\t\t\t\t\theight: $sizeY;\n\t\t\t\t\tbackground-color: var(--color-background-dark);\n\t\t\t\t\tbackground-size: 24px;\n\t\t\t\t}\n\t\t\t\t> h2 {\n\t\t\t\t\tmargin-top: $space;\n\t\t\t\t\tfont-size: inherit;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\nodfweb 新增/修改的內容\n需要在 templatePicker.scss import\n*/\n#template-picker {\n\t.template-container:not(.hidden) {\n\t\t.folderWrapper {\n\t\t\twidth: 100%;\n\t\t\t& > div:not(.foldersTab) {\n\t\t\t\tdisplay: flex;\n\t\t\t\tflex-wrap: wrap;\n\t\t\t\ta {\n\t\t\t\t\t$size: 170px;\n\t\t\t\t\t$sizeY: $size / 210 * 297;\n\t\t\t\t\t$space: 10px;\n\t\t\t\t\tborder-radius: 3px;\n\t\t\t\t\tborder-radius: var(--border-radius);\n\t\t\t\t\tborder: 1px solid var(--color-border);\n\t\t\t\t\tmargin: $space;\n\t\t\t\t\tposition: relative;\n\n\t\t\t\t\t&:hover,\n\t\t\t\t\t&:focus {\n\t\t\t\t\t\tbackground-color: var(--color-primary-element);\n\t\t\t\t\t\ttransition: all 0.2s ease-out;\n\t\t\t\t\t}\n\n\t\t\t\t\t> span {\n\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\tflex-direction: column;\n\t\t\t\t\t\twidth: $size;\n\t\t\t\t\t\tmargin: $space;\n\t\t\t\t\t\tcursor: pointer;\n\t\t\t\t\t\t> img,\n\t\t\t\t\t\t> span {\n\t\t\t\t\t\t\twidth: $size;\n\t\t\t\t\t\t\theight: $sizeY;\n\t\t\t\t\t\t\tbackground-color: var(--color-background-dark);\n\t\t\t\t\t\t\tbackground-size: 24px;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t> h2 {\n\t\t\t\t\t\t\tmargin-top: $space;\n\t\t\t\t\t\t\tfont-size: inherit;\n\t\t\t\t\t\t\tword-break: break-all;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t.emptyImg {\n\t\t\t\t\tposition: relative;\n\t\t\t\t\t&::before {\n\t\t\t\t\t\tcontent: '';\n\t\t\t\t\t\tposition: absolute;\n\t\t\t\t\t\tbackground-color: #e9e9e9;\n\t\t\t\t\t\twidth: 100%;\n\t\t\t\t\t\theight: 100%;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\t.foldersTab {\n\t\t\twidth: 100%;\n\t\t\tmargin: 35px 10px 30px 10px;\n\t\t\tdisplay: flex;\n    \t\tjustify-content: space-between;\n\t\t\tinput {\n\t\t\t\tdisplay: none;\n\t\t\t\t&:checked + label {\n\t\t\t\t\tcolor: gray;\n\t\t\t\t\tbackground-color: var(--color-border);\n\t\t\t\t\tpointer-events: none;\n\t\t\t\t\tposition: relative;\n\t\t\t\t\t&:after {\n\t\t\t\t\t\tcontent: ' ';\n\t\t\t\t\t\tdisplay: block;\n\t\t\t\t\t\theight: 0;\n\t\t\t\t\t\twidth: 0;\n\t\t\t\t\t\tposition: absolute;\n\t\t\t\t\t\tpointer-events: none;\n\t\t\t\t\t\tborder: 0 solid #fff;\n\t\t\t\t\t\tborder-top-color: var(--color-border);\n\t\t\t\t\t\tborder-width: 15px;\n\t\t\t\t\t\tbottom: -29px;\n\t\t\t\t\t\tleft: 47%;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\t&:not(:checked) + label {\n\t\t\t\t\tfont-weight: normal;\n\t\t\t\t\tcolor: gray;\n\t\t\t\t\tborder: 1px solid var(--color-border);\n\t\t\t\t\t&:hover {\n\t\t\t\t\t\tcolor: gray;\n\t\t\t\t\t\tfont-weight: bold;\n\t\t\t\t\t\tcursor: pointer;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tlabel {\n\t\t\t\twidth: 100%;\n\t\t\t\tdisplay: inline-block;\n\t\t\t\tfont-size: 15px;\n\t\t\t\tfont-weight: bold;\n\t\t\t\ttext-align: center;\n\t\t\t\tpadding: 8px 20px;\n\t\t\t\ttransition: 0.1s;\n\t\t\t}\n\t\t}\n\t}\n}\n"],sourceRoot:""}]),e.a=d},,,,,,,,,function(t,e,n){"use strict";e.a="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiIgd2lkdGg9IjE2IiB2ZXJzaW9uPSIxLjEiIGhlaWdodD0iMTYiPjxwYXRoIGZpbGw9IiM0OWFiZWEiIGQ9Im0yLjUgMWMtMC4yOCAwLTAuNSAwLjIyLTAuNSAwLjV2MTNjMCAwLjI4IDAuMjIgMC41IDAuNSAwLjVoMTFjMC4yOCAwIDAuNS0wLjIyIDAuNS0wLjV2LTEwLjVsLTMtM2gtOC41em0xLjUgMmg2djFoLTZ2LTF6bTAgM2g1djFoLTV2LTF6bTAgM2g4djFoLTh2LTF6bTAgM2g0djFoLTR2LTF6Ii8+PC9zdmc+Cg=="},function(t,e,n){"use strict";e.a="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiIgd2lkdGg9IjE2IiB2ZXJzaW9uPSIxLjEiIGhlaWdodD0iMTYiPjxwYXRoIGZpbGw9IiM5YWJkNGUiIGQ9Im0yLjUgMWMtMC4yOCAwLTAuNSAwLjIyLTAuNSAwLjV2MTNjMCAwLjI4IDAuMjIgMC41IDAuNSAwLjVoMTFjMC4yOCAwIDAuNS0wLjIyIDAuNS0wLjV2LTEwLjVsLTMtM2gtOC41em0xLjUgM2gydjJoLTJ2LTJ6bTMgMGg1djJoLTV2LTJ6bS0zIDNoMnYyaC0ydi0yem0zIDBoNXYyaC01di0yem0tMyAzaDJ2MmgtMnYtMnptMyAwaDV2MmgtNXYtMnoiLz48L3N2Zz4K"},function(t,e,n){"use strict";e.a="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiIgaGVpZ2h0PSIxNiIgd2lkdGg9IjE2IiB2ZXJzaW9uPSIxLjEiPjxwYXRoIGZpbGw9IiNmMDk2NWYiIGQ9Im0xLjUgMmMtMC4yNSAwLTAuNSAwLjI1LTAuNSAwLjV2MTFjMCAwLjI1IDAuMjUgMC41IDAuNSAwLjVoMTNjMC4yNSAwIDAuNS0wLjI1IDAuNS0wLjV2LTExYzAtMC4yNS0wLjI1LTAuNS0wLjUtMC41em0wLjUgM2gxMnY2aC0xMnoiLz48L3N2Zz4K"},,,,,,,,,,,,,,,,,,,,,,,,,,function(e,n,r){"use strict";r.r(n);var i=r(66),o=r(31),a=r(251),s=r(14),c=r(49),l=r(108),u=r(17),f=r(43),d=r.n(f),p=r(803),h={insert:"head",singleton:!1},v=(d()(p.a,h),p.a.locals,r(106)),m=r(399);function g(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||C(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?A(Object(n),!0).forEach((function(e){b(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function b(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function C(t,e){if(t){if("string"==typeof t)return x(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x(t,e):void 0}}function x(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function w(t){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var E=new a.a({FRAME_DOCUMENT:function(){return document.getElementById("richdocumentsframe").contentWindow}}),O=document.getElementById("hideDownload")&&"true"===document.getElementById("hideDownload").value,I=document.getElementById("isPublic")&&"1"===document.getElementById("isPublic").value,S={open:!1,receivedLoading:!1,isProxyStarting:!1,isCollaboraConfigured:-1!==OC.getCapabilities().richdocuments.config.wopi_url.indexOf("proxy.php")||"object"===w(OC.getCapabilities().richdocuments.collabora)&&0!==OC.getCapabilities().richdocuments.collabora.length,supportedMimes:OC.getCapabilities().richdocuments.mimetypes.concat(OC.getCapabilities().richdocuments.mimetypesNoDefaultOpen),excludeMimeFromDefaultOpen:OC.getCapabilities().richdocuments.mimetypesNoDefaultOpen,hideDownloadMimes:["image/jpeg","image/svg+xml","image/cgm","image/vnd.dxf","image/x-emf","image/x-wmf","image/x-wpg","image/x-freehand","image/bmp","image/png","image/gif","image/tiff","image/jpg","image/jpeg","text/plain","application/pdf"],registerFileActions:function(){var e,n=this,r="Edit with "+OC.getCapabilities().richdocuments.productName,i=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=C(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(S.supportedMimes);try{for(i.s();!(e=i.n()).done;){var o=e.value;OCA.Files.fileActions.register(o,r,OC.PERMISSION_READ,OC.imagePath("core","actions/rename"),(function(t,e){var r=e.fileList.findFile(t),i=null==r?void 0:r.shareOwnerId;return n.onEdit(t,y(y({},e),{},{shareOwnerId:i}))}),t("richdocuments","Edit with {productName}",{productName:OC.getCapabilities().richdocuments.productName},void 0,{escape:!1})),(-1===S.excludeMimeFromDefaultOpen.indexOf(o)||O)&&OCA.Files.fileActions.setDefault(o,r)}}catch(t){i.e(t)}finally{i.f()}},onEdit:function(e,n){if(S.isCollaboraConfigured){if(!0!==S.open){if(S.open=!0,n){var r,a;if("external-session"===(null==n||null===(r=n.$file)||void 0===r?void 0:r.attr("data-mounttype")))return OCP.Toast.error(t("richdocuments","Opening the file is not supported, since the credentials for the external storage are not available without a session"),{timeout:0}),void(S.open=!1);var s=n.dir,l=n.fileId||(null===(a=n.$file)||void 0===a?void 0:a.attr("data-id")),f=n.templateId}u.a.startLoading(),S.receivedLoading=!1;var d=Object(o.a)(s,l);I&&(d=Object(o.b)(e,l)),void 0!==f&&(d=Object(o.c)(f,e,s));n&&function(t,e){var n=c.a.open?parseInt(c.a.open.id):-1;if(void 0!==e){var r=e.lastIndexOf("@");-1!==e.substr(r).indexOf("/")&&l!==n&&function(t,e){var n=!1,r=document.createElement("iframe");r.style.display="none",r.onload=function(){n=!0},document.body.appendChild(r),r.setAttribute("src",t),setTimeout((function(){n||e(),document.body.removeChild(r)}),1e3)}("https://"+e.substr(r)+"/ocs/v2.php/apps/richdocuments/api/v1/federation",(function(){console.debug("Cannot load federated instance though CSP, navigating to ",OC.generateUrl("/apps/richdocuments/open?fileId="+l)),window.location=OC.generateUrl("/apps/richdocuments/open?fileId="+l)}))}}(0,null==n?void 0:n.shareOwnerId),$("head").append($('<link rel="stylesheet" type="text/css" href="'+OC.filePath("richdocuments","css","mobile.css")+'"/>')),$('link[href*="richdocuments/css/mobile"]').removeAttr("disabled");var p=$('<iframe id="richdocumentsframe" nonce="'+btoa(OC.requestToken)+'" scrolling="no" allowfullscreen src="'+d+'" />');S.loadingTimeout=setTimeout(S.onTimeout,1e3*OC.getCapabilities().richdocuments.config.timeout||15e3),p.src=d,(OC.appswebroots.richdocumentscode||OC.appswebroots.richdocumentscode_arm64)&&OC.getCapabilities().richdocuments.config.wopi_url.indexOf("proxy.php")>=0&&S.checkProxyStatus(),$("body").css("overscroll-behavior-y","none"),document.querySelector("meta[name=viewport]").setAttribute("content","width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"),I?($("#preview").append(p).css({height:"100%"}),$("body").css({height:"100%"}),$("#content").addClass("full-height"),$("footer").addClass("hidden"),$("#imgframe").addClass("hidden"),$(".directLink").addClass("hidden"),$(".directDownload").addClass("hidden"),$("#controls").addClass("hidden"),$("#content").addClass("loading")):($("body").css("overflow","hidden"),$("#app-content").append(p),p.hide()),$("#app-content #controls").addClass("hidden"),setTimeout((function(){u.a.init({fileName:e,fileId:l,filePath:s,fileList:n?n.fileList:void 0,fileModel:n?n.fileModel:void 0,sendPostMessage:function(t,e){E.sendWOPIPostMessage("FRAME_DOCUMENT",t,e)}}),Object(i.emit)("richdocuments:file-open:started",y({},u.a.loggingContext()))}))}}else{var h=OC.generateUrl("/settings/admin/richdocuments"),v=OC.isUserAdmin()?'<a href="'.concat(h,'">Collabora Online is not setup yet. <br />Click here to configure your own server or connect to a demo server.</a>'):t("richdocuments","Collabora Online is not setup yet. Please contact your administrator.");OCP.Toast?OCP.Toast.error(v,{isHTML:!0,timeout:0}):OC.Notification.showHtml(v)}},onReceiveLoading:function(){S.receivedLoading=!0,$("#richdocumentsframe").prop("title","Collabora Online"),$("#richdocumentsframe").show(),$("html, body").scrollTop(0),$("#content").removeClass("loading"),u.a.initAfterReady()},onClose:function(){S.open=!1,clearTimeout(S.loadingTimeout),S.receivedLoading=!1,$('link[href*="richdocuments/css/mobile"]').attr("disabled","disabled"),$("#app-content #controls").removeClass("hidden"),$("#richdocumentsframe").remove(),$(".searchbox").show(),$("body").css("overflow","auto"),I&&($("#content").removeClass("full-height"),$("footer").removeClass("hidden"),$("#imgframe").removeClass("hidden"),$(".directLink").removeClass("hidden"),$(".directDownload").removeClass("hidden")),OC.Util.History.replaceState(),u.a.close()},onTimeout:function(){S.receivedLoading||S.isProxyStarting?S.receivedLoading||(S.loadingTimeout=setTimeout(S.onTimeout,1e3*OC.getCapabilities().richdocuments.config.timeout||15e3)):(Object(i.emit)("richdocuments:file-open:failed",y({reason:"timeout"},u.a.loggingContext())),S.onClose(),OC.Notification.showTemporary(t("richdocuments","Failed to load {productName} - please try again later",{productName:OC.getCapabilities().richdocuments.productName||"Collabora Online"})))},checkProxyStatus:function(){var t=OC.getCapabilities().richdocuments.config.wopi_url,e=t.substr(0,t.indexOf("proxy.php")+"proxy.php".length);$.get(e+"?status").done((function(t){t&&t.status&&("OK"===t.status||"error"===t.status?S.isProxyStarting=!1:"starting"!==t.status&&"stopped"!==t.status&&"restarting"!==t.status||(S.isProxyStarting=!0,setTimeout((function(){S.checkProxyStatus()}),1e3)))}))}},T=OC.getCapabilities().richdocuments.config||{};s.a.update("ooxml","ooxml"===T.doc_format),window.OCA.RichDocuments={config:{create:l.a.getFileTypes()},open:function(t){var e=t.path,n=t.fileId,r=t.fileModel,i=t.fileList,o=void 0===i?{}:i,a=g(Object(v.b)(e),2),s=a[0],c=a[1];S.onEdit(c,{fileId:n,dir:s,shareOwnerId:r.get("shareOwnerId"),fileList:o,fileModel:r})},openWithTemplate:function(t){var e=t.path,n=t.fileId,r=t.templateId,i=t.fileModel,o=t.fileList,a=void 0===o?{}:o,s=g(Object(v.b)(e),2),c=s[0],l=s[1];S.onEdit(l,{fileId:n,dir:c,templateId:r,shareOwnerId:i.get("shareOwnerId"),fileList:a,fileModel:i})},FilesAppIntegration:{registerHandler:u.a.registerHandler.bind(u.a)}},window.addEventListener("DOMContentLoaded",(function(){"undefined"!=typeof OCA&&void 0!==OCA.Files&&void 0!==OCA.Files.fileActions&&(void 0===OCA.Files_Texteditor&&void 0===OCA.Text&&S.supportedMimes.push("text/plain"),S.registerFileActions(),OC.Plugins.register("OCA.Files.NewFileMenu",m.a)),c.a.create&&c.a.create.type&&c.a.create.filename&&u.a.preloadCreate(),c.a.open&&u.a.preloadOpen();var e=I&&-1!==S.supportedMimes.indexOf($("#mimetype").val())&&-1===S.excludeMimeFromDefaultOpen.indexOf($("#mimetype").val()),n=I&&O&&-1!==S.hideDownloadMimes.indexOf($("#mimetype").val());(e||n)&&S.onEdit(document.getElementById("filename").value),E.registerPostMessageHandler((function(e){var n=e.parsed;console.debug("[viewer] Received post message",n);var r=n.msgId,o=n.args;if(!n.deprecated){switch(r){case"loading":S.onReceiveLoading();break;case"Action_Load_Resp":var a;if(null!=o&&o.success)Object(i.emit)("richdocuments:file-open:succeeded",y({},u.a.loggingContext()));else Object(i.emit)("richdocuments:file-open:failed",y({reason:"collabora",collaboraResponse:null==n||null===(a=n.args)||void 0===a?void 0:a.errorMsg},u.a.loggingContext()));break;case"App_LoadingStatus":"Timeout"===o.Status&&(Object(i.emit)("richdocuments:file-open:failed",y({reason:"timeout"},u.a.loggingContext())),S.onClose(),OC.Notification.showTemporary(t("richdocuments","Failed to connect to {productName}. Please try again later or contact your server administrator.",{productName:OC.getCapabilities().richdocuments.productName})));break;case"UI_Share":u.a.share();break;case"UI_CreateFile":u.a.createNewFile(o.DocumentType);break;case"UI_InsertGraphic":u.a.insertGraphic((function(t,e){E.sendWOPIPostMessage("FRAME_DOCUMENT","postAsset",{FileName:t,Url:e})}));break;case"File_Rename":u.a.rename(o.NewName);break;case"Action_Save_Resp":u.a.saveAs();break;case"close":S.onClose();break;case"Get_Views_Resp":case"Views_List":u.a.setViews(o);break;case"UI_FileVersions":case"rev-history":u.a.showRevHistory();break;case"App_VersionRestore":"Pre_Restore_Ack"===o.Status&&u.a.restoreVersionExecute()}"View_Added"===r?(u.a.views[o.ViewId]=o,u.a.renderAvatars()):"View_Removed"===r?(delete u.a.views[o.ViewId],u.a.renderAvatars()):"FollowUser_Changed"===r&&(o.IsFollowEditor?u.a.followingEditor=!0:u.a.followingEditor=!1,o.IsFollowUser?u.a.following=o.FollowedViewId:u.a.following=null,u.a.renderAvatars())}}))}))}]);
//# sourceMappingURL=files.js.map