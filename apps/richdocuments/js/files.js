!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/js/",n(n.s=839)}([function(t,e,n){(function(e){var n=function(t){return t&&t.Math==Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e&&e)||function(){return this}()||Function("return this")()}).call(this,n(11))},function(t,e,n){var r=n(0),o=n(151),i=n(9),a=n(85),s=n(156),c=n(310),l=o("wks"),u=r.Symbol,f=c?u:u&&u.withoutSetter||a;t.exports=function(t){return i(l,t)||(s&&i(u,t)?l[t]=u[t]:l[t]=f("Symbol."+t)),l[t]}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},,function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},,,function(t,e,n){(function(e){var n=function(t){return t&&t.Math==Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e&&e)||Function("return this")()}).call(this,n(11))},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){(function(e){var n=function(t){return t&&t.Math==Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e&&e)||Function("return this")()}).call(this,n(11))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var r=n(19),o=n(148),i=n(20),a=n(80),s=Object.defineProperty;e.f=r?s:function(t,e,n){if(i(t),e=a(e,!0),i(n),o)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},,function(t,e,n){var r=n(19),o=n(12),i=n(50);t.exports=r?function(t,e,n){return o.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},,,function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var r=n(2);t.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(t,e,n){var r=n(8);t.exports=function(t){if(!r(t))throw TypeError(String(t)+" is not an object");return t}},,,function(t,e,n){var r=n(4);t.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},,function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},,,,,function(t,e,n){var r=n(23),o=n(127),i=n(123);t.exports=r?function(t,e,n){return o.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var r=n(47);t.exports=function(t){if(!r(t))throw TypeError(String(t)+" is not an object");return t}},function(t,e,n){var r=n(0),o=n(146).f,i=n(14),a=n(33),s=n(81),c=n(302),l=n(153);t.exports=function(t,e){var n,u,f,d,p,h=t.target,v=t.global,m=t.stat;if(n=v?r:m?r[h]||s(h,{}):(r[h]||{}).prototype)for(u in e){if(d=e[u],f=t.noTargetGet?(p=o(n,u))&&p.value:n[u],!l(v?u:h+(m?".":"#")+u,t.forced)&&void 0!==f){if(typeof d==typeof f)continue;c(d,f)}(t.sham||f&&f.sham)&&i(d,"sham",!0),a(n,u,d,t)}}},function(t,e,n){var r=n(0),o=n(14),i=n(9),a=n(81),s=n(150),c=n(52),l=c.get,u=c.enforce,f=String(String).split("String");(t.exports=function(t,e,n,s){var c,l=!!s&&!!s.unsafe,d=!!s&&!!s.enumerable,p=!!s&&!!s.noTargetGet;"function"==typeof n&&("string"!=typeof e||i(n,"name")||o(n,"name",e),(c=u(n)).source||(c.source=f.join("string"==typeof e?e:""))),t!==r?(l?!p&&t[e]&&(d=!0):delete t[e],d?t[e]=n:o(t,e,n)):d?t[e]=n:a(e,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&l(this).source||s(this)}))},function(t,e){t.exports={}},,,,,function(t,e,n){var r=n(57),o=n(182),i=n(179);t.exports=r?function(t,e,n){return o.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){"use strict";var r,o=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},i=function(){var t={};return function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}t[e]=n}return t[e]}}(),a=[];function s(t){for(var e=-1,n=0;n<a.length;n++)if(a[n].identifier===t){e=n;break}return e}function c(t,e){for(var n={},r=[],o=0;o<t.length;o++){var i=t[o],c=e.base?i[0]+e.base:i[0],l=n[c]||0,u="".concat(c," ").concat(l);n[c]=l+1;var f=s(u),d={css:i[1],media:i[2],sourceMap:i[3]};-1!==f?(a[f].references++,a[f].updater(d)):a.push({identifier:u,updater:m(d,e),references:1}),r.push(u)}return r}function l(t){var e=document.createElement("style"),r=t.attributes||{};if(void 0===r.nonce){var o=n.nc;o&&(r.nonce=o)}if(Object.keys(r).forEach((function(t){e.setAttribute(t,r[t])})),"function"==typeof t.insert)t.insert(e);else{var a=i(t.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(e)}return e}var u,f=(u=[],function(t,e){return u[t]=e,u.filter(Boolean).join("\n")});function d(t,e,n,r){var o=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(t.styleSheet)t.styleSheet.cssText=f(e,o);else{var i=document.createTextNode(o),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(i,a[e]):t.appendChild(i)}}function p(t,e,n){var r=n.css,o=n.media,i=n.sourceMap;if(o?t.setAttribute("media",o):t.removeAttribute("media"),i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}var h=null,v=0;function m(t,e){var n,r,o;if(e.singleton){var i=v++;n=h||(h=l(e)),r=d.bind(null,n,i,!1),o=d.bind(null,n,i,!0)}else n=l(e),r=p.bind(null,n,e),o=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(n)};return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else o()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=o());var n=c(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var r=0;r<n.length;r++){var o=s(n[r]);a[o].references--}for(var i=c(t,e),l=0;l<n.length;l++){var u=s(n[l]);0===a[u].references&&(a[u].updater(),a.splice(u,1))}n=i}}}},function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}t.exports=function(t){var e=r(t,4),n=e[1],o=e[3];if("function"==typeof btoa){var i=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),a="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),s="/*# ".concat(a," */"),c=o.sources.map((function(t){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(t," */")}));return[n].concat(c).concat([s]).join("\n")}return[n].join("\n")}},function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=t(e);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n,r){"string"==typeof t&&(t=[[null,t,""]]);var o={};if(r)for(var i=0;i<this.length;i++){var a=this[i][0];null!=a&&(o[a]=!0)}for(var s=0;s<t.length;s++){var c=[].concat(t[s]);r&&o[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),e.push(c))}},e}},,,function(t,e,n){var r=n(59);t.exports=function(t){if(!r(t))throw TypeError(String(t)+" is not an object");return t}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){var r=n(7),o=n(30),i=n(18),a=n(73),s=n(128),c=n(264),l=c.get,u=c.enforce,f=String(String).split("String");(t.exports=function(t,e,n,s){var c=!!s&&!!s.unsafe,l=!!s&&!!s.enumerable,d=!!s&&!!s.noTargetGet;"function"==typeof n&&("string"!=typeof e||i(n,"name")||o(n,"name",e),u(n).source=f.join("string"==typeof e?e:"")),t!==r?(c?!d&&t[e]&&(l=!0):delete t[e],l?t[e]=n:o(t,e,n)):l?t[e]=n:a(e,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&l(this).source||s(this)}))},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var r=n(147),o=n(79);t.exports=function(t){return r(o(t))}},function(t,e,n){var r,o,i,a=n(301),s=n(0),c=n(8),l=n(14),u=n(9),f=n(82),d=n(83),p=n(53),h=s.WeakMap;if(a){var v=f.state||(f.state=new h),m=v.get,g=v.has,y=v.set;r=function(t,e){return e.facade=t,y.call(v,t,e),e},o=function(t){return m.call(v,t)||{}},i=function(t){return g.call(v,t)}}else{var A=d("state");p[A]=!0,r=function(t,e){return e.facade=t,l(t,A,e),e},o=function(t){return u(t,A)?t[A]:{}},i=function(t){return u(t,A)}}t.exports={set:r,get:o,has:i,enforce:function(t){return i(t)?o(t):r(t,{})},getterFor:function(t){return function(e){var n;if(!c(e)||(n=o(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}}}},function(t,e){t.exports={}},function(t,e,n){var r=n(304),o=n(0),i=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?i(r[t])||i(o[t]):r[t]&&r[t][e]||o[t]&&o[t][e]}},function(t,e,n){var r=n(86),o=Math.min;t.exports=function(t){return t>0?o(r(t),9007199254740991):0}},,function(t,e,n){var r=n(17);t.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},,,,,,,,,,function(t,e,n){var r=n(7),o=n(121).f,i=n(30),a=n(48),s=n(73),c=n(268),l=n(274);t.exports=function(t,e){var n,u,f,d,p,h=t.target,v=t.global,m=t.stat;if(n=v?r:m?r[h]||s(h,{}):(r[h]||{}).prototype)for(u in e){if(d=e[u],f=t.noTargetGet?(p=o(n,u))&&p.value:n[u],!l(v?u:h+(m?".":"#")+u,t.forced)&&void 0!==f){if(typeof d==typeof f)continue;c(d,f)}(t.sham||f&&f.sham)&&i(d,"sham",!0),a(n,u,d,t)}}},function(t,e,n){var r=n(124),o=n(46);t.exports=function(t){return r(o(t))}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){var r=n(7),o=n(30);t.exports=function(t,e){try{o(r,t,e)}catch(n){r[t]=e}return e}},function(t,e,n){var r={};r[n(75)("toStringTag")]="z",t.exports="[object z]"===String(r)},function(t,e,n){var r=n(7),o=n(130),i=n(18),a=n(131),s=n(139),c=n(281),l=o("wks"),u=r.Symbol,f=c?u:u&&u.withoutSetter||a;t.exports=function(t){return i(l,t)||(s&&i(u,t)?l[t]=u[t]:l[t]=f("Symbol."+t)),l[t]}},function(t,e,n){"use strict";var r,o,i=n(141),a=n(284),s=RegExp.prototype.exec,c=String.prototype.replace,l=s,u=(r=/a/,o=/b*/g,s.call(r,"a"),s.call(o,"a"),0!==r.lastIndex||0!==o.lastIndex),f=a.UNSUPPORTED_Y||a.BROKEN_CARET,d=void 0!==/()??/.exec("")[1];(u||d||f)&&(l=function(t){var e,n,r,o,a=this,l=f&&a.sticky,p=i.call(a),h=a.source,v=0,m=t;return l&&(-1===(p=p.replace("y","")).indexOf("g")&&(p+="g"),m=String(t).slice(a.lastIndex),a.lastIndex>0&&(!a.multiline||a.multiline&&"\n"!==t[a.lastIndex-1])&&(h="(?: "+h+")",m=" "+m,v++),n=new RegExp("^(?:"+h+")",p)),d&&(n=new RegExp("^"+h+"$(?!\\s)",p)),u&&(e=a.lastIndex),r=s.call(l?n:a,m),l?r?(r.input=r.input.slice(v),r[0]=r[0].slice(v),r.index=a.lastIndex,a.lastIndex+=r[0].length):a.lastIndex=0:u&&r&&(a.lastIndex=a.global?r.index+r[0].length:e),d&&r&&r.length>1&&c.call(r[0],n,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(r[o]=void 0)})),r}),t.exports=l},function(t,e,n){"use strict";var r=Number.MAX_SAFE_INTEGER||9007199254740991;t.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:r,MAX_SAFE_COMPONENT_LENGTH:16}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t}},function(t,e,n){var r=n(8);t.exports=function(t,e){if(!r(t))return t;var n,o;if(e&&"function"==typeof(n=t.toString)&&!r(o=n.call(t)))return o;if("function"==typeof(n=t.valueOf)&&!r(o=n.call(t)))return o;if(!e&&"function"==typeof(n=t.toString)&&!r(o=n.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var r=n(0),o=n(14);t.exports=function(t,e){try{o(r,t,e)}catch(n){r[t]=e}return e}},function(t,e,n){var r=n(0),o=n(81),i=r["__core-js_shared__"]||o("__core-js_shared__",{});t.exports=i},function(t,e,n){var r=n(151),o=n(85),i=r("keys");t.exports=function(t){return i[t]||(i[t]=o(t))}},function(t,e){t.exports=!1},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++n+r).toString(36)}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,e,n){var r=n(79);t.exports=function(t){return Object(r(t))}},function(t,e,n){var r=n(313);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,o){return t.call(e,n,r,o)}}return function(){return t.apply(e,arguments)}}},function(t,e,n){var r,o=n(20),i=n(317),a=n(87),s=n(53),c=n(319),l=n(149),u=n(83),f=u("IE_PROTO"),d=function(){},p=function(t){return"<script>"+t+"<\/script>"},h=function(){try{r=document.domain&&new ActiveXObject("htmlfile")}catch(t){}var t,e;h=r?function(t){t.write(p("")),t.close();var e=t.parentWindow.Object;return t=null,e}(r):((e=l("iframe")).style.display="none",c.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(p("document.F=Object")),t.close(),t.F);for(var n=a.length;n--;)delete h.prototype[a[n]];return h()};s[f]=!0,t.exports=Object.create||function(t,e){var n;return null!==t?(d.prototype=o(t),n=new d,d.prototype=null,n[f]=t):n=h(),void 0===e?n:i(n,e)}},function(t,e,n){"use strict";var r=n(32),o=n(320),i=n(163),a=n(164),s=n(92),c=n(14),l=n(33),u=n(1),f=n(84),d=n(34),p=n(162),h=p.IteratorPrototype,v=p.BUGGY_SAFARI_ITERATORS,m=u("iterator"),g=function(){return this};t.exports=function(t,e,n,u,p,y,A){o(n,e,u);var b,C,x,w=function(t){if(t===p&&T)return T;if(!v&&t in I)return I[t];switch(t){case"keys":case"values":case"entries":return function(){return new n(this,t)}}return function(){return new n(this)}},E=e+" Iterator",O=!1,I=t.prototype,S=I[m]||I["@@iterator"]||p&&I[p],T=!v&&S||w(p),L="Array"==e&&I.entries||S;if(L&&(b=i(L.call(new t)),h!==Object.prototype&&b.next&&(f||i(b)===h||(a?a(b,h):"function"!=typeof b[m]&&c(b,m,g)),s(b,E,!0,!0),f&&(d[E]=g))),"values"==p&&S&&"values"!==S.name&&(O=!0,T=function(){return S.call(this)}),f&&!A||I[m]===T||c(I,m,T),d[e]=T,p)if(C={values:w("values"),keys:y?T:w("keys"),entries:w("entries")},A)for(x in C)(v||O||!(x in I))&&l(I,x,C[x]);else r({target:e,proto:!0,forced:v||O},C);return C}},function(t,e,n){var r=n(12).f,o=n(9),i=n(1)("toStringTag");t.exports=function(t,e,n){t&&!o(t=n?t:t.prototype,i)&&r(t,i,{configurable:!0,value:e})}},function(t,e,n){var r={};r[n(1)("toStringTag")]="z",t.exports="[object z]"===String(r)},,,function(t,e,n){var r=n(369),o=n(58);t.exports=function(t){return r(o(t))}},function(t,e,n){var r=n(10),o=n(39);t.exports=function(t,e){try{o(r,t,e)}catch(n){r[t]=e}return e}},function(t,e,n){"use strict";var r,o,i=n(243),a=n(386),s=RegExp.prototype.exec,c=String.prototype.replace,l=s,u=(r=/a/,o=/b*/g,s.call(r,"a"),s.call(o,"a"),0!==r.lastIndex||0!==o.lastIndex),f=a.UNSUPPORTED_Y||a.BROKEN_CARET,d=void 0!==/()??/.exec("")[1];(u||d||f)&&(l=function(t){var e,n,r,o,a=this,l=f&&a.sticky,p=i.call(a),h=a.source,v=0,m=t;return l&&(-1===(p=p.replace("y","")).indexOf("g")&&(p+="g"),m=String(t).slice(a.lastIndex),a.lastIndex>0&&(!a.multiline||a.multiline&&"\n"!==t[a.lastIndex-1])&&(h="(?: "+h+")",m=" "+m,v++),n=new RegExp("^(?:"+h+")",p)),d&&(n=new RegExp("^"+h+"$(?!\\s)",p)),u&&(e=a.lastIndex),r=s.call(l?n:a,m),l?r?(r.input=r.input.slice(v),r[0]=r[0].slice(v),r.index=a.lastIndex,a.lastIndex+=r[0].length):a.lastIndex=0:u&&r&&(a.lastIndex=a.global?r.index+r[0].length:e),d&&r&&r.length>1&&c.call(r[0],n,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(r[o]=void 0)})),r}),t.exports=l},,,,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.subscribe=function(t,e){i.subscribe(t,e)},e.unsubscribe=function(t,e){i.unsubscribe(t,e)},e.emit=function(t,e){i.emit(t,e)};var r=n(293),o=n(298);var i=(void 0!==window.OC&&window.OC._eventBus&&void 0===window._nc_event_bus&&(console.warn("found old event bus instance at OC._eventBus. Update your version!"),window._nc_event_bus=window.OC._eventBus),void 0!==window._nc_event_bus?new r.ProxyBus(window._nc_event_bus):window._nc_event_bus=new o.SimpleBus)},,,,function(t,e,n){var r=n(10),o=n(39),i=n(25),a=n(97),s=n(183),c=n(371),l=c.get,u=c.enforce,f=String(String).split("String");(t.exports=function(t,e,n,s){var c=!!s&&!!s.unsafe,l=!!s&&!!s.enumerable,d=!!s&&!!s.noTargetGet;"function"==typeof n&&("string"!=typeof e||i(n,"name")||o(n,"name",e),u(n).source=f.join("string"==typeof e?e:"")),t!==r?(c?!d&&t[e]&&(l=!0):delete t[e],l?t[e]=n:o(t,e,n)):l?t[e]=n:a(e,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&l(this).source||s(this)}))},,,,function(t,e,n){"use strict";var r=n(367),o=n(98);r({target:"RegExp",proto:!0,forced:/./.exec!==o},{exec:o})},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){var n,r,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(t){n=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var c,l=[],u=!1,f=-1;function d(){u&&c&&(u=!1,c.length?l=c.concat(l):f=-1,l.length&&p())}function p(){if(!u){var t=s(d);u=!0;for(var e=l.length;e;){for(c=l,l=[];++f<e;)c&&c[f].run();f=-1,e=l.length}c=null,u=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function h(t,e){this.fun=t,this.array=e}function v(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new h(t,e)),1!==l.length||u||s(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},,,,function(t,e,n){"use strict";n(262),n(277),n(280),n(140),n(285),n(286),Object.defineProperty(e,"__esModule",{value:!0}),e.getRootUrl=e.generateFilePath=e.imagePath=e.generateUrl=e.generateOcsUrl=e.generateRemoteUrl=e.linkTo=void 0;e.linkTo=function(t,e){return r(t,"",e)};e.generateRemoteUrl=function(t){return window.location.protocol+"//"+window.location.host+function(t){return o()+"/remote.php/"+t}(t)};e.generateOcsUrl=function(t,e){return e=2!==e?1:2,window.location.protocol+"//"+window.location.host+o()+"/ocs/v"+e+".php/"+t+"/"};e.generateUrl=function(t,e,n){var r=Object.assign({escape:!0,noRewrite:!1},n||{}),i=function(t,e){return e=e||{},t.replace(/{([^{}]*)}/g,(function(t,n){var o=e[n];return r.escape?"string"==typeof o||"number"==typeof o?encodeURIComponent(o.toString()):encodeURIComponent(t):"string"==typeof o||"number"==typeof o?o.toString():t}))};return"/"!==t.charAt(0)&&(t="/"+t),!0!==OC.config.modRewriteWorking||r.noRewrite?o()+"/index.php"+i(t,e||{}):o()+i(t,e||{})};e.imagePath=function(t,e){return-1===e.indexOf(".")?r(t,"img",e+".svg"):r(t,"img",e)};var r=function(t,e,n){var r=-1!==OC.coreApps.indexOf(t),i=o();return"php"!==n.substring(n.length-3)||r?"php"===n.substring(n.length-3)||r?(i+="settings"!==t&&"core"!==t&&"search"!==t||"ajax"!==e?"/":"/index.php/",r||(i+="apps/"),""!==t&&(i+=t+="/"),e&&(i+=e+"/"),i+=n):(i=OC.appswebroots[t],e&&(i+="/"+e+"/"),"/"!==i.substring(i.length-1)&&(i+="/"),i+=n):(i+="/index.php/apps/"+t,"index.php"!==n&&(i+="/",e&&(i+=encodeURI(e+"/")),i+=n)),i};e.generateFilePath=r;var o=function(){return OC.webroot};e.getRootUrl=o},function(t,e,n){var r=n(23),o=n(122),i=n(123),a=n(71),s=n(125),c=n(18),l=n(126),u=Object.getOwnPropertyDescriptor;e.f=r?u:function(t,e){if(t=a(t),e=s(e,!0),l)try{return u(t,e)}catch(t){}if(c(t,e))return i(!o.f.call(t,e),t[e])}},function(t,e,n){"use strict";var r={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,i=o&&!r.call({1:2},1);e.f=i?function(t){var e=o(this,t);return!!e&&e.enumerable}:r},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var r=n(4),o=n(72),i="".split;t.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==o(t)?i.call(t,""):Object(t)}:Object},function(t,e,n){var r=n(47);t.exports=function(t,e){if(!r(t))return t;var n,o;if(e&&"function"==typeof(n=t.toString)&&!r(o=n.call(t)))return o;if("function"==typeof(n=t.valueOf)&&!r(o=n.call(t)))return o;if(!e&&"function"==typeof(n=t.toString)&&!r(o=n.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var r=n(23),o=n(4),i=n(263);t.exports=!r&&!o((function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},function(t,e,n){var r=n(23),o=n(126),i=n(31),a=n(125),s=Object.defineProperty;e.f=r?s:function(t,e,n){if(i(t),e=a(e,!0),i(n),o)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var r=n(129),o=Function.toString;"function"!=typeof r.inspectSource&&(r.inspectSource=function(t){return o.call(t)}),t.exports=r.inspectSource},function(t,e,n){var r=n(7),o=n(73),i=r["__core-js_shared__"]||o("__core-js_shared__",{});t.exports=i},function(t,e,n){var r=n(267),o=n(129);(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.6.5",mode:r?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++n+r).toString(36)}},function(t,e){t.exports={}},function(t,e,n){var r=n(18),o=n(71),i=n(134).indexOf,a=n(132);t.exports=function(t,e){var n,s=o(t),c=0,l=[];for(n in s)!r(a,n)&&r(s,n)&&l.push(n);for(;e.length>c;)r(s,n=e[c++])&&(~i(l,n)||l.push(n));return l}},function(t,e,n){var r=n(71),o=n(135),i=n(273),a=function(t){return function(e,n,a){var s,c=r(e),l=o(c.length),u=i(a,l);if(t&&n!=n){for(;l>u;)if((s=c[u++])!=s)return!0}else for(;l>u;u++)if((t||u in c)&&c[u]===n)return t||u||0;return!t&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},function(t,e,n){var r=n(49),o=Math.min;t.exports=function(t){return t>0?o(r(t),9007199254740991):0}},function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var r=n(46);t.exports=function(t){return Object(r(t))}},function(t,e,n){var r=n(4);t.exports=!!Object.getOwnPropertySymbols&&!r((function(){return!String(Symbol())}))},function(t,e,n){"use strict";var r=n(70),o=n(76);r({target:"RegExp",proto:!0,forced:/./.exec!==o},{exec:o})},function(t,e,n){"use strict";var r=n(31);t.exports=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){"use strict";var r=n(77).MAX_SAFE_COMPONENT_LENGTH,o=n(143),i=(e=t.exports={}).re=[],a=e.src=[],s=e.t={},c=0,l=function(t,e,n){var r=c++;o(r,e),s[t]=r,a[r]=e,i[r]=new RegExp(e,n?"g":void 0)};l("NUMERICIDENTIFIER","0|[1-9]\\d*"),l("NUMERICIDENTIFIERLOOSE","[0-9]+"),l("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),l("MAINVERSION","(".concat(a[s.NUMERICIDENTIFIER],")\\.")+"(".concat(a[s.NUMERICIDENTIFIER],")\\.")+"(".concat(a[s.NUMERICIDENTIFIER],")")),l("MAINVERSIONLOOSE","(".concat(a[s.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(a[s.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(a[s.NUMERICIDENTIFIERLOOSE],")")),l("PRERELEASEIDENTIFIER","(?:".concat(a[s.NUMERICIDENTIFIER],"|").concat(a[s.NONNUMERICIDENTIFIER],")")),l("PRERELEASEIDENTIFIERLOOSE","(?:".concat(a[s.NUMERICIDENTIFIERLOOSE],"|").concat(a[s.NONNUMERICIDENTIFIER],")")),l("PRERELEASE","(?:-(".concat(a[s.PRERELEASEIDENTIFIER],"(?:\\.").concat(a[s.PRERELEASEIDENTIFIER],")*))")),l("PRERELEASELOOSE","(?:-?(".concat(a[s.PRERELEASEIDENTIFIERLOOSE],"(?:\\.").concat(a[s.PRERELEASEIDENTIFIERLOOSE],")*))")),l("BUILDIDENTIFIER","[0-9A-Za-z-]+"),l("BUILD","(?:\\+(".concat(a[s.BUILDIDENTIFIER],"(?:\\.").concat(a[s.BUILDIDENTIFIER],")*))")),l("FULLPLAIN","v?".concat(a[s.MAINVERSION]).concat(a[s.PRERELEASE],"?").concat(a[s.BUILD],"?")),l("FULL","^".concat(a[s.FULLPLAIN],"$")),l("LOOSEPLAIN","[v=\\s]*".concat(a[s.MAINVERSIONLOOSE]).concat(a[s.PRERELEASELOOSE],"?").concat(a[s.BUILD],"?")),l("LOOSE","^".concat(a[s.LOOSEPLAIN],"$")),l("GTLT","((?:<|>)?=?)"),l("XRANGEIDENTIFIERLOOSE","".concat(a[s.NUMERICIDENTIFIERLOOSE],"|x|X|\\*")),l("XRANGEIDENTIFIER","".concat(a[s.NUMERICIDENTIFIER],"|x|X|\\*")),l("XRANGEPLAIN","[v=\\s]*(".concat(a[s.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(a[s.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(a[s.XRANGEIDENTIFIER],")")+"(?:".concat(a[s.PRERELEASE],")?").concat(a[s.BUILD],"?")+")?)?"),l("XRANGEPLAINLOOSE","[v=\\s]*(".concat(a[s.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(a[s.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(a[s.XRANGEIDENTIFIERLOOSE],")")+"(?:".concat(a[s.PRERELEASELOOSE],")?").concat(a[s.BUILD],"?")+")?)?"),l("XRANGE","^".concat(a[s.GTLT],"\\s*").concat(a[s.XRANGEPLAIN],"$")),l("XRANGELOOSE","^".concat(a[s.GTLT],"\\s*").concat(a[s.XRANGEPLAINLOOSE],"$")),l("COERCE","".concat("(^|[^\\d])(\\d{1,").concat(r,"})")+"(?:\\.(\\d{1,".concat(r,"}))?")+"(?:\\.(\\d{1,".concat(r,"}))?")+"(?:$|[^\\d])"),l("COERCERTL",a[s.COERCE],!0),l("LONETILDE","(?:~>?)"),l("TILDETRIM","(\\s*)".concat(a[s.LONETILDE],"\\s+"),!0),e.tildeTrimReplace="$1~",l("TILDE","^".concat(a[s.LONETILDE]).concat(a[s.XRANGEPLAIN],"$")),l("TILDELOOSE","^".concat(a[s.LONETILDE]).concat(a[s.XRANGEPLAINLOOSE],"$")),l("LONECARET","(?:\\^)"),l("CARETTRIM","(\\s*)".concat(a[s.LONECARET],"\\s+"),!0),e.caretTrimReplace="$1^",l("CARET","^".concat(a[s.LONECARET]).concat(a[s.XRANGEPLAIN],"$")),l("CARETLOOSE","^".concat(a[s.LONECARET]).concat(a[s.XRANGEPLAINLOOSE],"$")),l("COMPARATORLOOSE","^".concat(a[s.GTLT],"\\s*(").concat(a[s.LOOSEPLAIN],")$|^$")),l("COMPARATOR","^".concat(a[s.GTLT],"\\s*(").concat(a[s.FULLPLAIN],")$|^$")),l("COMPARATORTRIM","(\\s*)".concat(a[s.GTLT],"\\s*(").concat(a[s.LOOSEPLAIN],"|").concat(a[s.XRANGEPLAIN],")"),!0),e.comparatorTrimReplace="$1$2$3",l("HYPHENRANGE","^\\s*(".concat(a[s.XRANGEPLAIN],")")+"\\s+-\\s+"+"(".concat(a[s.XRANGEPLAIN],")")+"\\s*$"),l("HYPHENRANGELOOSE","^\\s*(".concat(a[s.XRANGEPLAINLOOSE],")")+"\\s+-\\s+"+"(".concat(a[s.XRANGEPLAINLOOSE],")")+"\\s*$"),l("STAR","(<|>)?=?\\s*\\*"),l("GTE0","^\\s*>=\\s*0.0.0\\s*$"),l("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")},function(t,e,n){"use strict";(function(e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r="object"===(void 0===e?"undefined":n(e))&&e.env&&e.env.NODE_DEBUG&&/\bsemver\b/i.test(e.env.NODE_DEBUG)?function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=console).error.apply(t,["SEMVER"].concat(n))}:function(){};t.exports=r}).call(this,n(116))},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n(143),i=n(77),a=i.MAX_LENGTH,s=i.MAX_SAFE_INTEGER,c=n(142),l=c.re,u=c.t,f=n(145),d=n(296).compareIdentifiers,p=function(){function t(e,n){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n=f(n),e instanceof t){if(e.loose===!!n.loose&&e.includePrerelease===!!n.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: ".concat(e));if(e.length>a)throw new TypeError("version is longer than ".concat(a," characters"));o("SemVer",e,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;var r=e.trim().match(n.loose?l[u.LOOSE]:l[u.FULL]);if(!r)throw new TypeError("Invalid Version: ".concat(e));if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>s||this.major<0)throw new TypeError("Invalid major version");if(this.minor>s||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>s||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map((function(t){if(/^[0-9]+$/.test(t)){var e=+t;if(e>=0&&e<s)return e}return t})):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}var e,n,i;return e=t,(n=[{key:"format",value:function(){return this.version="".concat(this.major,".").concat(this.minor,".").concat(this.patch),this.prerelease.length&&(this.version+="-".concat(this.prerelease.join("."))),this.version}},{key:"toString",value:function(){return this.version}},{key:"compare",value:function(e){if(o("SemVer.compare",this.version,this.options,e),!(e instanceof t)){if("string"==typeof e&&e===this.version)return 0;e=new t(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}},{key:"compareMain",value:function(e){return e instanceof t||(e=new t(e,this.options)),d(this.major,e.major)||d(this.minor,e.minor)||d(this.patch,e.patch)}},{key:"comparePre",value:function(e){if(e instanceof t||(e=new t(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var n=0;do{var r=this.prerelease[n],i=e.prerelease[n];if(o("prerelease compare",n,r,i),void 0===r&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===r)return-1;if(r!==i)return d(r,i)}while(++n)}},{key:"compareBuild",value:function(e){e instanceof t||(e=new t(e,this.options));var n=0;do{var r=this.build[n],i=e.build[n];if(o("prerelease compare",n,r,i),void 0===r&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===r)return-1;if(r!==i)return d(r,i)}while(++n)}},{key:"inc",value:function(t,e){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",e),this.inc("pre",e);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var n=this.prerelease.length;--n>=0;)"number"==typeof this.prerelease[n]&&(this.prerelease[n]++,n=-2);-1===n&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error("invalid increment argument: ".concat(t))}return this.format(),this.raw=this.version,this}}])&&r(e.prototype,n),i&&r(e,i),t}();t.exports=p},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o=["includePrerelease","loose","rtl"];t.exports=function(t){return t?"object"!==r(t)?{loose:!0}:o.filter((function(e){return t[e]})).reduce((function(t,e){return t[e]=!0,t}),{}):{}}},function(t,e,n){var r=n(19),o=n(300),i=n(50),a=n(51),s=n(80),c=n(9),l=n(148),u=Object.getOwnPropertyDescriptor;e.f=r?u:function(t,e){if(t=a(t),e=s(e,!0),l)try{return u(t,e)}catch(t){}if(c(t,e))return i(!o.f.call(t,e),t[e])}},function(t,e,n){var r=n(2),o=n(78),i="".split;t.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==o(t)?i.call(t,""):Object(t)}:Object},function(t,e,n){var r=n(19),o=n(2),i=n(149);t.exports=!r&&!o((function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},function(t,e,n){var r=n(0),o=n(8),i=r.document,a=o(i)&&o(i.createElement);t.exports=function(t){return a?i.createElement(t):{}}},function(t,e,n){var r=n(82),o=Function.toString;"function"!=typeof r.inspectSource&&(r.inspectSource=function(t){return o.call(t)}),t.exports=r.inspectSource},function(t,e,n){var r=n(84),o=n(82);(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.9.0",mode:r?"pure":"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"})},function(t,e,n){var r=n(9),o=n(51),i=n(306).indexOf,a=n(53);t.exports=function(t,e){var n,s=o(t),c=0,l=[];for(n in s)!r(a,n)&&r(s,n)&&l.push(n);for(;e.length>c;)r(s,n=e[c++])&&(~i(l,n)||l.push(n));return l}},function(t,e,n){var r=n(2),o=/#|\.prototype\./,i=function(t,e){var n=s[a(t)];return n==l||n!=c&&("function"==typeof e?r(e):!!e)},a=i.normalize=function(t){return String(t).replace(o,".").toLowerCase()},s=i.data={},c=i.NATIVE="N",l=i.POLYFILL="P";t.exports=i},function(t,e,n){var r=n(78);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,e,n){var r=n(8),o=n(154),i=n(1)("species");t.exports=function(t,e){var n;return o(t)&&("function"!=typeof(n=t.constructor)||n!==Array&&!o(n.prototype)?r(n)&&null===(n=n[i])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===e?0:e)}},function(t,e,n){var r=n(2);t.exports=!!Object.getOwnPropertySymbols&&!r((function(){return!String(Symbol())}))},function(t,e,n){var r=n(2),o=n(1),i=n(158),a=o("species");t.exports=function(t){return i>=51||!r((function(){var e=[];return(e.constructor={})[a]=function(){return{foo:1}},1!==e[t](Boolean).foo}))}},function(t,e,n){var r,o,i=n(0),a=n(311),s=i.process,c=s&&s.versions,l=c&&c.v8;l?o=(r=l.split("."))[0]+r[1]:a&&(!(r=a.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/))&&(o=r[1]),t.exports=o&&+o},function(t,e,n){var r=n(89),o=n(147),i=n(88),a=n(55),s=n(155),c=[].push,l=function(t){var e=1==t,n=2==t,l=3==t,u=4==t,f=6==t,d=7==t,p=5==t||f;return function(h,v,m,g){for(var y,A,b=i(h),C=o(b),x=r(v,m,3),w=a(C.length),E=0,O=g||s,I=e?O(h,w):n||d?O(h,0):void 0;w>E;E++)if((p||E in C)&&(A=x(y=C[E],E,b),t))if(e)I[E]=A;else if(A)switch(t){case 3:return!0;case 5:return y;case 6:return E;case 2:c.call(I,y)}else switch(t){case 4:return!1;case 7:c.call(I,y)}return f?-1:l||u?u:I}};t.exports={forEach:l(0),map:l(1),filter:l(2),some:l(3),every:l(4),find:l(5),findIndex:l(6),filterOut:l(7)}},function(t,e,n){"use strict";var r=n(159).forEach,o=n(315)("forEach");t.exports=o?[].forEach:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}},function(t,e,n){"use strict";var r=n(51),o=n(316),i=n(34),a=n(52),s=n(91),c=a.set,l=a.getterFor("Array Iterator");t.exports=s(Array,"Array",(function(t,e){c(this,{type:"Array Iterator",target:r(t),index:0,kind:e})}),(function(){var t=l(this),e=t.target,n=t.kind,r=t.index++;return!e||r>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:e[r],done:!1}:{value:[r,e[r]],done:!1}}),"values"),i.Arguments=i.Array,o("keys"),o("values"),o("entries")},function(t,e,n){"use strict";var r,o,i,a=n(2),s=n(163),c=n(14),l=n(9),u=n(1),f=n(84),d=u("iterator"),p=!1;[].keys&&("next"in(i=[].keys())?(o=s(s(i)))!==Object.prototype&&(r=o):p=!0);var h=null==r||a((function(){var t={};return r[d].call(t)!==t}));h&&(r={}),f&&!h||l(r,d)||c(r,d,(function(){return this})),t.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:p}},function(t,e,n){var r=n(9),o=n(88),i=n(83),a=n(321),s=i("IE_PROTO"),c=Object.prototype;t.exports=a?Object.getPrototypeOf:function(t){return t=o(t),r(t,s)?t[s]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?c:null}},function(t,e,n){var r=n(20),o=n(322);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),e=n instanceof Array}catch(t){}return function(n,i){return r(n),o(i),e?t.call(n,i):n.__proto__=i,n}}():void 0)},function(t,e,n){var r=n(53),o=n(8),i=n(9),a=n(12).f,s=n(85),c=n(325),l=s("meta"),u=0,f=Object.isExtensible||function(){return!0},d=function(t){a(t,l,{value:{objectID:"O"+ ++u,weakData:{}}})},p=t.exports={REQUIRED:!1,fastKey:function(t,e){if(!o(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!i(t,l)){if(!f(t))return"F";if(!e)return"E";d(t)}return t[l].objectID},getWeakData:function(t,e){if(!i(t,l)){if(!f(t))return!0;if(!e)return!1;d(t)}return t[l].weakData},onFreeze:function(t){return c&&p.REQUIRED&&f(t)&&!i(t,l)&&d(t),t}};r[l]=!0},function(t,e,n){var r=n(20),o=n(326),i=n(55),a=n(89),s=n(327),c=n(328),l=function(t,e){this.stopped=t,this.result=e};t.exports=function(t,e,n){var u,f,d,p,h,v,m,g=n&&n.that,y=!(!n||!n.AS_ENTRIES),A=!(!n||!n.IS_ITERATOR),b=!(!n||!n.INTERRUPTED),C=a(e,g,1+y+b),x=function(t){return u&&c(u),new l(!0,t)},w=function(t){return y?(r(t),b?C(t[0],t[1],x):C(t[0],t[1])):b?C(t,x):C(t)};if(A)u=t;else{if("function"!=typeof(f=s(t)))throw TypeError("Target is not iterable");if(o(f)){for(d=0,p=i(t.length);p>d;d++)if((h=w(t[d]))&&h instanceof l)return h;return new l(!1)}u=f.call(t)}for(v=u.next;!(m=v.call(u)).done;){try{h=w(m.value)}catch(t){throw c(u),t}if("object"==typeof h&&h&&h instanceof l)return h}return new l(!1)}},function(t,e,n){var r=n(93),o=n(78),i=n(1)("toStringTag"),a="Arguments"==o(function(){return arguments}());t.exports=r?o:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),i))?n:a?o(e):"Object"==(r=o(e))&&"function"==typeof e.callee?"Arguments":r}},function(t,e){t.exports=function(t,e,n){if(!(t instanceof e))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return t}},function(t,e){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},,,,,,,,,function(t,e,n){var r=n(57),o=n(368),i=n(179),a=n(96),s=n(180),c=n(25),l=n(181),u=Object.getOwnPropertyDescriptor;e.f=r?u:function(t,e){if(t=a(t),e=s(e,!0),l)try{return u(t,e)}catch(t){}if(c(t,e))return i(!o.f.call(t,e),t[e])}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var r=n(59);t.exports=function(t,e){if(!r(t))return t;var n,o;if(e&&"function"==typeof(n=t.toString)&&!r(o=n.call(t)))return o;if("function"==typeof(n=t.valueOf)&&!r(o=n.call(t)))return o;if(!e&&"function"==typeof(n=t.toString)&&!r(o=n.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var r=n(57),o=n(17),i=n(370);t.exports=!r&&!o((function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},function(t,e,n){var r=n(57),o=n(181),i=n(45),a=n(180),s=Object.defineProperty;e.f=r?s:function(t,e,n){if(i(t),e=a(e,!0),i(n),o)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var r=n(184),o=Function.toString;"function"!=typeof r.inspectSource&&(r.inspectSource=function(t){return o.call(t)}),t.exports=r.inspectSource},function(t,e,n){var r=n(10),o=n(97),i=r["__core-js_shared__"]||o("__core-js_shared__",{});t.exports=i},function(t,e,n){var r=n(374),o=n(184);(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.6.5",mode:r?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++n+r).toString(36)}},function(t,e){t.exports={}},function(t,e,n){var r=n(60),o=Math.min;t.exports=function(t){return t>0?o(r(t),9007199254740991):0}},function(t,e,n){var r=n(17);t.exports=!!Object.getOwnPropertySymbols&&!r((function(){return!String(Symbol())}))},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;
/*
 * @copyright Copyright (c) 2019 Julius Härtl <jus@bitgrid.net>
 *
 * @author Julius Härtl <jus@bitgrid.net>
 *
 * @license GNU AGPL version 3 or any later version
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 *
 */
var o=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.values={},this.loadFromGlobal("userId"),this.loadFromGlobal("urlsrc"),this.loadFromGlobal("directEdit"),this.loadFromGlobal("permissions"),this.loadFromGlobal("instanceId")}var e,n,o;return e=t,(n=[{key:"loadFromGlobal",value:function(t){this.values[t]=window["richdocuments_"+t]}},{key:"update",value:function(t,e){this.values[t]=e}},{key:"get",value:function(t){return void 0===this.values[t]&&this.loadFromGlobal(t),this.values[t]}}])&&r(e.prototype,n),o&&r(e,o),t}());e.default=o},,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){var r=n(10),o=n(185),i=n(25),a=n(186),s=n(189),c=n(388),l=o("wks"),u=r.Symbol,f=c?u:u&&u.withoutSetter||a;t.exports=function(t){return i(l,t)||(s&&i(u,t)?l[t]=u[t]:l[t]=f("Symbol."+t)),l[t]}},,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.splitPath=e.getNextcloudVersion=e.languageToBCP47=void 0;var r=n(366);
/*
 * @copyright Copyright (c) 2019 Julius Härtl <jus@bitgrid.net>
 *
 * @author Julius Härtl <jus@bitgrid.net>
 *
 * @license GNU AGPL version 3 or any later version
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 *
 */e.languageToBCP47=function(){var t=(0,r.getLanguage)().replace(/_/g,"-"),e=(0,r.getLocale)();"de-DE"===t&&(t="de");var n={de:{de_CH:"de-CH",gsw:"de-CH",gsw_CH:"de-CH"},fr:{fr_CH:"fr-CH"},it:{it_CH:"it-CH"}}[t];return void 0!==n&&void 0!==n[e]?n[e]:t};e.getNextcloudVersion=function(){return parseInt(OC.config.version.split(".")[0])};e.splitPath=function(t){var e=t.split("\\").pop().split("/").pop();return[t.substr(0,t.length-e.length-1),e]}},function(t,e,n){"use strict";var r=n(45);t.exports=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){"use strict";var r=n(387),o=n(45),i=n(389),a=n(188),s=n(60),c=n(58),l=n(390),u=n(392),f=Math.max,d=Math.min,p=Math.floor,h=/\$([$&'`]|\d\d?|<[^>]*>)/g,v=/\$([$&'`]|\d\d?)/g;r("replace",2,(function(t,e,n,r){var m=r.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,g=r.REPLACE_KEEPS_$0,y=m?"$":"$0";return[function(n,r){var o=c(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,o,r):e.call(String(o),n,r)},function(t,r){if(!m&&g||"string"==typeof r&&-1===r.indexOf(y)){var i=n(e,t,this,r);if(i.done)return i.value}var c=o(t),p=String(this),h="function"==typeof r;h||(r=String(r));var v=c.global;if(v){var b=c.unicode;c.lastIndex=0}for(var C=[];;){var x=u(c,p);if(null===x)break;if(C.push(x),!v)break;""===String(x[0])&&(c.lastIndex=l(p,a(c.lastIndex),b))}for(var w,E="",O=0,I=0;I<C.length;I++){x=C[I];for(var S=String(x[0]),T=f(d(s(x.index),p.length),0),L=[],N=1;N<x.length;N++)L.push(void 0===(w=x[N])?w:String(w));var k=x.groups;if(h){var M=[S].concat(L,T,p);void 0!==k&&M.push(k);var P=String(r.apply(void 0,M))}else P=A(S,p,T,L,k,r);T>=O&&(E+=p.slice(O,T)+P,O=T+S.length)}return E+p.slice(O)}];function A(t,n,r,o,a,s){var c=r+t.length,l=o.length,u=v;return void 0!==a&&(a=i(a),u=h),e.call(s,u,(function(e,i){var s;switch(i.charAt(0)){case"$":return"$";case"&":return t;case"`":return n.slice(0,r);case"'":return n.slice(c);case"<":s=a[i.slice(1,-1)];break;default:var u=+i;if(0===u)return e;if(u>l){var f=p(u/10);return 0===f?e:f<=l?void 0===o[f-1]?i.charAt(1):o[f-1]+i.charAt(1):e}s=o[u-1]}return void 0===s?"":s}))}}))},,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var r=n(70),o=n(134).indexOf,i=n(275),a=n(276),s=[].indexOf,c=!!s&&1/[1].indexOf(1,-0)<0,l=i("indexOf"),u=a("indexOf",{ACCESSORS:!0,1:0});r({target:"Array",proto:!0,forced:c||!l||!u},{indexOf:function(t){return c?s.apply(this,arguments)||0:o(this,t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){var r=n(7),o=n(47),i=r.document,a=o(i)&&o(i.createElement);t.exports=function(t){return a?i.createElement(t):{}}},function(t,e,n){var r,o,i,a=n(265),s=n(7),c=n(47),l=n(30),u=n(18),f=n(266),d=n(132),p=s.WeakMap;if(a){var h=new p,v=h.get,m=h.has,g=h.set;r=function(t,e){return g.call(h,t,e),e},o=function(t){return v.call(h,t)||{}},i=function(t){return m.call(h,t)}}else{var y=f("state");d[y]=!0,r=function(t,e){return l(t,y,e),e},o=function(t){return u(t,y)?t[y]:{}},i=function(t){return u(t,y)}}t.exports={set:r,get:o,has:i,enforce:function(t){return i(t)?o(t):r(t,{})},getterFor:function(t){return function(e){var n;if(!c(e)||(n=o(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}}}},function(t,e,n){var r=n(7),o=n(128),i=r.WeakMap;t.exports="function"==typeof i&&/native code/.test(o(i))},function(t,e,n){var r=n(130),o=n(131),i=r("keys");t.exports=function(t){return i[t]||(i[t]=o(t))}},function(t,e){t.exports=!1},function(t,e,n){var r=n(18),o=n(269),i=n(121),a=n(127);t.exports=function(t,e){for(var n=o(e),s=a.f,c=i.f,l=0;l<n.length;l++){var u=n[l];r(t,u)||s(t,u,c(e,u))}}},function(t,e,n){var r=n(270),o=n(272),i=n(137),a=n(31);t.exports=r("Reflect","ownKeys")||function(t){var e=o.f(a(t)),n=i.f;return n?e.concat(n(t)):e}},function(t,e,n){var r=n(271),o=n(7),i=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?i(r[t])||i(o[t]):r[t]&&r[t][e]||o[t]&&o[t][e]}},function(t,e,n){var r=n(7);t.exports=r},function(t,e,n){var r=n(133),o=n(136).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,o)}},function(t,e,n){var r=n(49),o=Math.max,i=Math.min;t.exports=function(t,e){var n=r(t);return n<0?o(n+e,0):i(n,e)}},function(t,e,n){var r=n(4),o=/#|\.prototype\./,i=function(t,e){var n=s[a(t)];return n==l||n!=c&&("function"==typeof e?r(e):!!e)},a=i.normalize=function(t){return String(t).replace(o,".").toLowerCase()},s=i.data={},c=i.NATIVE="N",l=i.POLYFILL="P";t.exports=i},function(t,e,n){"use strict";var r=n(4);t.exports=function(t,e){var n=[][t];return!!n&&r((function(){n.call(null,e||function(){throw 1},1)}))}},function(t,e,n){var r=n(23),o=n(4),i=n(18),a=Object.defineProperty,s={},c=function(t){throw t};t.exports=function(t,e){if(i(s,t))return s[t];e||(e={});var n=[][t],l=!!i(e,"ACCESSORS")&&e.ACCESSORS,u=i(e,0)?e[0]:c,f=i(e,1)?e[1]:void 0;return s[t]=!!n&&!o((function(){if(l&&!r)return!0;var t={length:-1};l?a(t,1,{enumerable:!0,get:c}):t[1]=1,n.call(t,u,f)}))}},function(t,e,n){var r=n(70),o=n(278);r({target:"Object",stat:!0,forced:Object.assign!==o},{assign:o})},function(t,e,n){"use strict";var r=n(23),o=n(4),i=n(279),a=n(137),s=n(122),c=n(138),l=n(124),u=Object.assign,f=Object.defineProperty;t.exports=!u||o((function(){if(r&&1!==u({b:1},u(f({},"a",{enumerable:!0,get:function(){f(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},n=Symbol();return t[n]=7,"abcdefghijklmnopqrst".split("").forEach((function(t){e[t]=t})),7!=u({},t)[n]||"abcdefghijklmnopqrst"!=i(u({},e)).join("")}))?function(t,e){for(var n=c(t),o=arguments.length,u=1,f=a.f,d=s.f;o>u;)for(var p,h=l(arguments[u++]),v=f?i(h).concat(f(h)):i(h),m=v.length,g=0;m>g;)p=v[g++],r&&!d.call(h,p)||(n[p]=h[p]);return n}:u},function(t,e,n){var r=n(133),o=n(136);t.exports=Object.keys||function(t){return r(t,o)}},function(t,e,n){var r=n(74),o=n(48),i=n(282);r||o(Object.prototype,"toString",i,{unsafe:!0})},function(t,e,n){var r=n(139);t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(t,e,n){"use strict";var r=n(74),o=n(283);t.exports=r?{}.toString:function(){return"[object "+o(this)+"]"}},function(t,e,n){var r=n(74),o=n(72),i=n(75)("toStringTag"),a="Arguments"==o(function(){return arguments}());t.exports=r?o:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),i))?n:a?o(e):"Object"==(r=o(e))&&"function"==typeof e.callee?"Arguments":r}},function(t,e,n){"use strict";var r=n(4);function o(t,e){return RegExp(t,e)}e.UNSUPPORTED_Y=r((function(){var t=o("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),e.BROKEN_CARET=r((function(){var t=o("^r","gy");return t.lastIndex=2,null!=t.exec("str")}))},function(t,e,n){"use strict";var r=n(48),o=n(31),i=n(4),a=n(141),s=RegExp.prototype,c=s.toString,l=i((function(){return"/a/b"!=c.call({source:"a",flags:"b"})})),u="toString"!=c.name;(l||u)&&r(RegExp.prototype,"toString",(function(){var t=o(this),e=String(t.source),n=t.flags;return"/"+e+"/"+String(void 0===n&&t instanceof RegExp&&!("flags"in s)?a.call(t):n)}),{unsafe:!0})},function(t,e,n){"use strict";var r=n(287),o=n(31),i=n(138),a=n(135),s=n(49),c=n(46),l=n(288),u=n(290),f=Math.max,d=Math.min,p=Math.floor,h=/\$([$&'`]|\d\d?|<[^>]*>)/g,v=/\$([$&'`]|\d\d?)/g;r("replace",2,(function(t,e,n,r){var m=r.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,g=r.REPLACE_KEEPS_$0,y=m?"$":"$0";return[function(n,r){var o=c(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,o,r):e.call(String(o),n,r)},function(t,r){if(!m&&g||"string"==typeof r&&-1===r.indexOf(y)){var i=n(e,t,this,r);if(i.done)return i.value}var c=o(t),p=String(this),h="function"==typeof r;h||(r=String(r));var v=c.global;if(v){var b=c.unicode;c.lastIndex=0}for(var C=[];;){var x=u(c,p);if(null===x)break;if(C.push(x),!v)break;""===String(x[0])&&(c.lastIndex=l(p,a(c.lastIndex),b))}for(var w,E="",O=0,I=0;I<C.length;I++){x=C[I];for(var S=String(x[0]),T=f(d(s(x.index),p.length),0),L=[],N=1;N<x.length;N++)L.push(void 0===(w=x[N])?w:String(w));var k=x.groups;if(h){var M=[S].concat(L,T,p);void 0!==k&&M.push(k);var P=String(r.apply(void 0,M))}else P=A(S,p,T,L,k,r);T>=O&&(E+=p.slice(O,T)+P,O=T+S.length)}return E+p.slice(O)}];function A(t,n,r,o,a,s){var c=r+t.length,l=o.length,u=v;return void 0!==a&&(a=i(a),u=h),e.call(s,u,(function(e,i){var s;switch(i.charAt(0)){case"$":return"$";case"&":return t;case"`":return n.slice(0,r);case"'":return n.slice(c);case"<":s=a[i.slice(1,-1)];break;default:var u=+i;if(0===u)return e;if(u>l){var f=p(u/10);return 0===f?e:f<=l?void 0===o[f-1]?i.charAt(1):o[f-1]+i.charAt(1):e}s=o[u-1]}return void 0===s?"":s}))}}))},function(t,e,n){"use strict";n(140);var r=n(48),o=n(4),i=n(75),a=n(76),s=n(30),c=i("species"),l=!o((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),u="$0"==="a".replace(/./,"$0"),f=i("replace"),d=!!/./[f]&&""===/./[f]("a","$0"),p=!o((function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));t.exports=function(t,e,n,f){var h=i(t),v=!o((function(){var e={};return e[h]=function(){return 7},7!=""[t](e)})),m=v&&!o((function(){var e=!1,n=/a/;return"split"===t&&((n={}).constructor={},n.constructor[c]=function(){return n},n.flags="",n[h]=/./[h]),n.exec=function(){return e=!0,null},n[h](""),!e}));if(!v||!m||"replace"===t&&(!l||!u||d)||"split"===t&&!p){var g=/./[h],y=n(h,""[t],(function(t,e,n,r,o){return e.exec===a?v&&!o?{done:!0,value:g.call(e,n,r)}:{done:!0,value:t.call(n,e,r)}:{done:!1}}),{REPLACE_KEEPS_$0:u,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:d}),A=y[0],b=y[1];r(String.prototype,t,A),r(RegExp.prototype,h,2==e?function(t,e){return b.call(t,this,e)}:function(t){return b.call(t,this)})}f&&s(RegExp.prototype[h],"sham",!0)}},function(t,e,n){"use strict";var r=n(289).charAt;t.exports=function(t,e,n){return e+(n?r(t,e).length:1)}},function(t,e,n){var r=n(49),o=n(46),i=function(t){return function(e,n){var i,a,s=String(o(e)),c=r(n),l=s.length;return c<0||c>=l?t?"":void 0:(i=s.charCodeAt(c))<55296||i>56319||c+1===l||(a=s.charCodeAt(c+1))<56320||a>57343?t?s.charAt(c):i:t?s.slice(c,c+2):a-56320+(i-55296<<10)+65536}};t.exports={codeAt:i(!1),charAt:i(!0)}},function(t,e,n){var r=n(72),o=n(76);t.exports=function(t,e){var n=t.exec;if("function"==typeof n){var i=n.call(t,e);if("object"!=typeof i)throw TypeError("RegExp exec method returned something other than an Object or null");return i}if("RegExp"!==r(t))throw TypeError("RegExp#exec called on incompatible receiver");return o.call(t,e)}},,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ProxyBus=void 0;var r=i(n(294)),o=i(n(297));function i(t){return t&&t.__esModule?t:{default:t}}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s="1.2.0",c=function(){function t(e){var n,i,a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),a=void 0,(i="bus")in(n=this)?Object.defineProperty(n,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[i]=a,"function"==typeof e.getVersion&&(0,r.default)(e.getVersion())?(0,o.default)(e.getVersion())!==(0,o.default)(this.getVersion())&&console.warn("Proxying an event bus of version "+e.getVersion()+" with "+this.getVersion()):console.warn("Proxying an event bus with an unknown or invalid version"),this.bus=e}var e,n,i;return e=t,(n=[{key:"getVersion",value:function(){return s}},{key:"subscribe",value:function(t,e){this.bus.subscribe(t,e)}},{key:"unsubscribe",value:function(t,e){this.bus.unsubscribe(t,e)}},{key:"emit",value:function(t,e){this.bus.emit(t,e)}}])&&a(e.prototype,n),i&&a(e,i),t}();e.ProxyBus=c},function(t,e,n){"use strict";var r=n(295);t.exports=function(t,e){var n=r(t,e);return n?n.version:null}},function(t,e,n){"use strict";var r=n(77).MAX_LENGTH,o=n(142),i=o.re,a=o.t,s=n(144),c=n(145);t.exports=function(t,e){if(e=c(e),t instanceof s)return t;if("string"!=typeof t)return null;if(t.length>r)return null;if(!(e.loose?i[a.LOOSE]:i[a.FULL]).test(t))return null;try{return new s(t,e)}catch(t){return null}}},function(t,e,n){"use strict";var r=/^[0-9]+$/,o=function(t,e){var n=r.test(t),o=r.test(e);return n&&o&&(t=+t,e=+e),t===e?0:n&&!o?-1:o&&!n?1:t<e?-1:1};t.exports={compareIdentifiers:o,rcompareIdentifiers:function(t,e){return o(e,t)}}},function(t,e,n){"use strict";var r=n(144);t.exports=function(t,e){return new r(t,e).major}},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n(299),n(312),n(314),n(161),n(323),n(334),n(336),n(338),n(339),Object.defineProperty(e,"__esModule",{value:!0}),e.SimpleBus=void 0;var o="1.2.0",i=function(){function t(){var e,n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=this,n="handlers",r=new Map,n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r}var e,n,i;return e=t,(n=[{key:"getVersion",value:function(){return o}},{key:"subscribe",value:function(t,e){this.handlers.set(t,(this.handlers.get(t)||[]).concat(e))}},{key:"unsubscribe",value:function(t,e){this.handlers.set(t,(this.handlers.get(t)||[]).filter((function(t){return t!=e})))}},{key:"emit",value:function(t,e){(this.handlers.get(t)||[]).forEach((function(t){try{t(e)}catch(t){console.error("could not invoke event listener",t)}}))}}])&&r(e.prototype,n),i&&r(e,i),t}();e.SimpleBus=i},function(t,e,n){"use strict";var r=n(32),o=n(2),i=n(154),a=n(8),s=n(88),c=n(55),l=n(309),u=n(155),f=n(157),d=n(1),p=n(158),h=d("isConcatSpreadable"),v=p>=51||!o((function(){var t=[];return t[h]=!1,t.concat()[0]!==t})),m=f("concat"),g=function(t){if(!a(t))return!1;var e=t[h];return void 0!==e?!!e:i(t)};r({target:"Array",proto:!0,forced:!v||!m},{concat:function(t){var e,n,r,o,i,a=s(this),f=u(a,0),d=0;for(e=-1,r=arguments.length;e<r;e++)if(g(i=-1===e?a:arguments[e])){if(d+(o=c(i.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(n=0;n<o;n++,d++)n in i&&l(f,d,i[n])}else{if(d>=9007199254740991)throw TypeError("Maximum allowed index exceeded");l(f,d++,i)}return f.length=d,f}})},function(t,e,n){"use strict";var r={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,i=o&&!r.call({1:2},1);e.f=i?function(t){var e=o(this,t);return!!e&&e.enumerable}:r},function(t,e,n){var r=n(0),o=n(150),i=r.WeakMap;t.exports="function"==typeof i&&/native code/.test(o(i))},function(t,e,n){var r=n(9),o=n(303),i=n(146),a=n(12);t.exports=function(t,e){for(var n=o(e),s=a.f,c=i.f,l=0;l<n.length;l++){var u=n[l];r(t,u)||s(t,u,c(e,u))}}},function(t,e,n){var r=n(54),o=n(305),i=n(308),a=n(20);t.exports=r("Reflect","ownKeys")||function(t){var e=o.f(a(t)),n=i.f;return n?e.concat(n(t)):e}},function(t,e,n){var r=n(0);t.exports=r},function(t,e,n){var r=n(152),o=n(87).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,o)}},function(t,e,n){var r=n(51),o=n(55),i=n(307),a=function(t){return function(e,n,a){var s,c=r(e),l=o(c.length),u=i(a,l);if(t&&n!=n){for(;l>u;)if((s=c[u++])!=s)return!0}else for(;l>u;u++)if((t||u in c)&&c[u]===n)return t||u||0;return!t&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},function(t,e,n){var r=n(86),o=Math.max,i=Math.min;t.exports=function(t,e){var n=r(t);return n<0?o(n+e,0):i(n,e)}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){"use strict";var r=n(80),o=n(12),i=n(50);t.exports=function(t,e,n){var a=r(e);a in t?o.f(t,a,i(0,n)):t[a]=n}},function(t,e,n){var r=n(156);t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(t,e,n){var r=n(54);t.exports=r("navigator","userAgent")||""},function(t,e,n){"use strict";var r=n(32),o=n(159).filter;r({target:"Array",proto:!0,forced:!n(157)("filter")},{filter:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}})},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}},function(t,e,n){"use strict";var r=n(32),o=n(160);r({target:"Array",proto:!0,forced:[].forEach!=o},{forEach:o})},function(t,e,n){"use strict";var r=n(2);t.exports=function(t,e){var n=[][t];return!!n&&r((function(){n.call(null,e||function(){throw 1},1)}))}},function(t,e,n){var r=n(1),o=n(90),i=n(12),a=r("unscopables"),s=Array.prototype;null==s[a]&&i.f(s,a,{configurable:!0,value:o(null)}),t.exports=function(t){s[a][t]=!0}},function(t,e,n){var r=n(19),o=n(12),i=n(20),a=n(318);t.exports=r?Object.defineProperties:function(t,e){i(t);for(var n,r=a(e),s=r.length,c=0;s>c;)o.f(t,n=r[c++],e[n]);return t}},function(t,e,n){var r=n(152),o=n(87);t.exports=Object.keys||function(t){return r(t,o)}},function(t,e,n){var r=n(54);t.exports=r("document","documentElement")},function(t,e,n){"use strict";var r=n(162).IteratorPrototype,o=n(90),i=n(50),a=n(92),s=n(34),c=function(){return this};t.exports=function(t,e,n){var l=e+" Iterator";return t.prototype=o(r,{next:i(1,n)}),a(t,l,!1,!0),s[l]=c,t}},function(t,e,n){var r=n(2);t.exports=!r((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},function(t,e,n){var r=n(8);t.exports=function(t){if(!r(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype");return t}},function(t,e,n){"use strict";var r=n(324),o=n(331);t.exports=r("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),o)},function(t,e,n){"use strict";var r=n(32),o=n(0),i=n(153),a=n(33),s=n(165),c=n(166),l=n(168),u=n(8),f=n(2),d=n(329),p=n(92),h=n(330);t.exports=function(t,e,n){var v=-1!==t.indexOf("Map"),m=-1!==t.indexOf("Weak"),g=v?"set":"add",y=o[t],A=y&&y.prototype,b=y,C={},x=function(t){var e=A[t];a(A,t,"add"==t?function(t){return e.call(this,0===t?0:t),this}:"delete"==t?function(t){return!(m&&!u(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return m&&!u(t)?void 0:e.call(this,0===t?0:t)}:"has"==t?function(t){return!(m&&!u(t))&&e.call(this,0===t?0:t)}:function(t,n){return e.call(this,0===t?0:t,n),this})};if(i(t,"function"!=typeof y||!(m||A.forEach&&!f((function(){(new y).entries().next()})))))b=n.getConstructor(e,t,v,g),s.REQUIRED=!0;else if(i(t,!0)){var w=new b,E=w[g](m?{}:-0,1)!=w,O=f((function(){w.has(1)})),I=d((function(t){new y(t)})),S=!m&&f((function(){for(var t=new y,e=5;e--;)t[g](e,e);return!t.has(-0)}));I||((b=e((function(e,n){l(e,b,t);var r=h(new y,e,b);return null!=n&&c(n,r[g],{that:r,AS_ENTRIES:v}),r}))).prototype=A,A.constructor=b),(O||S)&&(x("delete"),x("has"),v&&x("get")),(S||E)&&x(g),m&&A.clear&&delete A.clear}return C[t]=b,r({global:!0,forced:b!=y},C),p(b,t),m||n.setStrong(b,t,v),b}},function(t,e,n){var r=n(2);t.exports=!r((function(){return Object.isExtensible(Object.preventExtensions({}))}))},function(t,e,n){var r=n(1),o=n(34),i=r("iterator"),a=Array.prototype;t.exports=function(t){return void 0!==t&&(o.Array===t||a[i]===t)}},function(t,e,n){var r=n(167),o=n(34),i=n(1)("iterator");t.exports=function(t){if(null!=t)return t[i]||t["@@iterator"]||o[r(t)]}},function(t,e,n){var r=n(20);t.exports=function(t){var e=t.return;if(void 0!==e)return r(e.call(t)).value}},function(t,e,n){var r=n(1)("iterator"),o=!1;try{var i=0,a={next:function(){return{done:!!i++}},return:function(){o=!0}};a[r]=function(){return this},Array.from(a,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!o)return!1;var n=!1;try{var i={};i[r]=function(){return{next:function(){return{done:n=!0}}}},t(i)}catch(t){}return n}},function(t,e,n){var r=n(8),o=n(164);t.exports=function(t,e,n){var i,a;return o&&"function"==typeof(i=e.constructor)&&i!==n&&r(a=i.prototype)&&a!==n.prototype&&o(t,a),t}},function(t,e,n){"use strict";var r=n(12).f,o=n(90),i=n(332),a=n(89),s=n(168),c=n(166),l=n(91),u=n(333),f=n(19),d=n(165).fastKey,p=n(52),h=p.set,v=p.getterFor;t.exports={getConstructor:function(t,e,n,l){var u=t((function(t,r){s(t,u,e),h(t,{type:e,index:o(null),first:void 0,last:void 0,size:0}),f||(t.size=0),null!=r&&c(r,t[l],{that:t,AS_ENTRIES:n})})),p=v(e),m=function(t,e,n){var r,o,i=p(t),a=g(t,e);return a?a.value=n:(i.last=a={index:o=d(e,!0),key:e,value:n,previous:r=i.last,next:void 0,removed:!1},i.first||(i.first=a),r&&(r.next=a),f?i.size++:t.size++,"F"!==o&&(i.index[o]=a)),t},g=function(t,e){var n,r=p(t),o=d(e);if("F"!==o)return r.index[o];for(n=r.first;n;n=n.next)if(n.key==e)return n};return i(u.prototype,{clear:function(){for(var t=p(this),e=t.index,n=t.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete e[n.index],n=n.next;t.first=t.last=void 0,f?t.size=0:this.size=0},delete:function(t){var e=p(this),n=g(this,t);if(n){var r=n.next,o=n.previous;delete e.index[n.index],n.removed=!0,o&&(o.next=r),r&&(r.previous=o),e.first==n&&(e.first=r),e.last==n&&(e.last=o),f?e.size--:this.size--}return!!n},forEach:function(t){for(var e,n=p(this),r=a(t,arguments.length>1?arguments[1]:void 0,3);e=e?e.next:n.first;)for(r(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!g(this,t)}}),i(u.prototype,n?{get:function(t){var e=g(this,t);return e&&e.value},set:function(t,e){return m(this,0===t?0:t,e)}}:{add:function(t){return m(this,t=0===t?0:t,t)}}),f&&r(u.prototype,"size",{get:function(){return p(this).size}}),u},setStrong:function(t,e,n){var r=e+" Iterator",o=v(e),i=v(r);l(t,e,(function(t,e){h(this,{type:r,target:t,state:o(t),kind:e,last:void 0})}),(function(){for(var t=i(this),e=t.kind,n=t.last;n&&n.removed;)n=n.previous;return t.target&&(t.last=n=n?n.next:t.state.first)?"keys"==e?{value:n.key,done:!1}:"values"==e?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(t.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),u(e)}}},function(t,e,n){var r=n(33);t.exports=function(t,e,n){for(var o in e)r(t,o,e[o],n);return t}},function(t,e,n){"use strict";var r=n(54),o=n(12),i=n(1),a=n(19),s=i("species");t.exports=function(t){var e=r(t),n=o.f;a&&e&&!e[s]&&n(e,s,{configurable:!0,get:function(){return this}})}},function(t,e,n){var r=n(93),o=n(33),i=n(335);r||o(Object.prototype,"toString",i,{unsafe:!0})},function(t,e,n){"use strict";var r=n(93),o=n(167);t.exports=r?{}.toString:function(){return"[object "+o(this)+"]"}},function(t,e,n){"use strict";var r=n(337).charAt,o=n(52),i=n(91),a=o.set,s=o.getterFor("String Iterator");i(String,"String",(function(t){a(this,{type:"String Iterator",string:String(t),index:0})}),(function(){var t,e=s(this),n=e.string,o=e.index;return o>=n.length?{value:void 0,done:!0}:(t=r(n,o),e.index+=t.length,{value:t,done:!1})}))},function(t,e,n){var r=n(86),o=n(79),i=function(t){return function(e,n){var i,a,s=String(o(e)),c=r(n),l=s.length;return c<0||c>=l?t?"":void 0:(i=s.charCodeAt(c))<55296||i>56319||c+1===l||(a=s.charCodeAt(c+1))<56320||a>57343?t?s.charAt(c):i:t?s.slice(c,c+2):a-56320+(i-55296<<10)+65536}};t.exports={codeAt:i(!1),charAt:i(!0)}},function(t,e,n){var r=n(0),o=n(169),i=n(160),a=n(14);for(var s in o){var c=r[s],l=c&&c.prototype;if(l&&l.forEach!==i)try{a(l,"forEach",i)}catch(t){l.forEach=i}}},function(t,e,n){var r=n(0),o=n(169),i=n(161),a=n(14),s=n(1),c=s("iterator"),l=s("toStringTag"),u=i.values;for(var f in o){var d=r[f],p=d&&d.prototype;if(p){if(p[c]!==u)try{a(p,c,u)}catch(t){p[c]=u}if(p[l]||a(p,l,f),o[f])for(var h in i)if(p[h]!==i[h])try{a(p,h,i[h])}catch(t){p[h]=i[h]}}}},,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getDocumentUrlForFile=e.getDocumentUrlForPublicFile=e.getDocumentUrlFromTemplate=e.getWopiUrl=e.getSearchParam=void 0;var r,o=n(120),i=n(242),a=(r=n(190))&&r.__esModule?r:{default:r};e.getSearchParam=function(t){var e=new RegExp("[?&]"+t+"=([^&#]*)").exec(window.location.href);return null===e?null:decodeURI(e[1])||""};e.getWopiUrl=function(t){var e=t.fileId,n=t.title,r=t.readOnly,s=t.closeButton,c=t.revisionHistory,l=window.location.protocol+"//"+window.location.host+(0,o.getRootUrl)()+"/index.php/apps/richdocuments/wopi/files/"+e;console.debug("[getWopiUrl] "+l);var u=encodeURIComponent(l);return a.default.get("urlsrc")+"WOPISrc="+u+"&title="+encodeURIComponent(n)+"&lang="+(0,i.languageToBCP47)()+(s?"&closebutton=1":"")+(c?"&revisionhistory=1":"")+(r?"&permission=readonly":"")};e.getDocumentUrlFromTemplate=function(t,e,n,r){return OC.generateUrl("apps/richdocuments/indexTemplate?templateId={templateId}&fileName={fileName}&dir={dir}&requesttoken={requesttoken}",{templateId:t,fileName:e,dir:n,requesttoken:OC.requestToken})};e.getDocumentUrlForPublicFile=function(t,e){return OC.generateUrl("apps/richdocuments/public?shareToken={shareToken}&fileName={fileName}&requesttoken={requesttoken}&fileId={fileId}",{shareToken:document.getElementById("sharingToken").value,fileName:t,fileId:e,requesttoken:OC.requestToken})};e.getDocumentUrlForFile=function(t,e){return OC.generateUrl("apps/richdocuments/index?fileId={fileId}&requesttoken={requesttoken}",{fileId:e,dir:t,requesttoken:OC.requestToken})}},function(t,e,n){"use strict";function r(){return"undefined"==typeof OC?(console.warn("No OC found"),"en"):OC.getLocale()}n(114),n(244),Object.defineProperty(e,"__esModule",{value:!0}),e.getLocale=r,e.getCanonicalLocale=function(){return r().replace(/_/g,"-")},e.getLanguage=function(){if("undefined"==typeof OC)return console.warn("No OC found"),"en";return OC.getLanguage()},e.translate=function(t,e,n,r,o){if("undefined"==typeof OC)return console.warn("No OC found"),e;return OC.L10N.translate(t,e,n,r,o)},e.translatePlural=function(t,e,n,r,o,i){if("undefined"==typeof OC)return console.warn("No OC found"),e;return OC.L10N.translatePlural(t,e,n,r,o,i)},e.getFirstDay=function(){if(void 0===window.firstDay)return console.warn("No firstDay found"),1;return window.firstDay},e.getDayNames=function(){if(void 0===window.dayNames)return console.warn("No dayNames found"),["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return window.dayNames},e.getDayNamesShort=function(){if(void 0===window.dayNamesShort)return console.warn("No dayNamesShort found"),["Sun.","Mon.","Tue.","Wed.","Thu.","Fri.","Sat."];return window.dayNamesShort},e.getDayNamesMin=function(){if(void 0===window.dayNamesMin)return console.warn("No dayNamesMin found"),["Su","Mo","Tu","We","Th","Fr","Sa"];return window.dayNamesMin},e.getMonthNames=function(){if(void 0===window.monthNames)return console.warn("No monthNames found"),["January","February","March","April","May","June","July","August","September","October","November","December"];return window.monthNames},e.getMonthNamesShort=function(){if(void 0===window.monthNamesShort)return console.warn("No monthNamesShort found"),["Jan.","Feb.","Mar.","Apr.","May.","Jun.","Jul.","Aug.","Sep.","Oct.","Nov.","Dec."];return window.monthNamesShort}},function(t,e,n){var r=n(10),o=n(178).f,i=n(39),a=n(110),s=n(97),c=n(375),l=n(385);t.exports=function(t,e){var n,u,f,d,p,h=t.target,v=t.global,m=t.stat;if(n=v?r:m?r[h]||s(h,{}):(r[h]||{}).prototype)for(u in e){if(d=e[u],f=t.noTargetGet?(p=o(n,u))&&p.value:n[u],!l(v?u:h+(m?".":"#")+u,t.forced)&&void 0!==f){if(typeof d==typeof f)continue;c(d,f)}(t.sham||f&&f.sham)&&i(d,"sham",!0),a(n,u,d,t)}}},function(t,e,n){"use strict";var r={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,i=o&&!r.call({1:2},1);e.f=i?function(t){var e=o(this,t);return!!e&&e.enumerable}:r},function(t,e,n){var r=n(17),o=n(115),i="".split;t.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==o(t)?i.call(t,""):Object(t)}:Object},function(t,e,n){var r=n(10),o=n(59),i=r.document,a=o(i)&&o(i.createElement);t.exports=function(t){return a?i.createElement(t):{}}},function(t,e,n){var r,o,i,a=n(372),s=n(10),c=n(59),l=n(39),u=n(25),f=n(373),d=n(187),p=s.WeakMap;if(a){var h=new p,v=h.get,m=h.has,g=h.set;r=function(t,e){return g.call(h,t,e),e},o=function(t){return v.call(h,t)||{}},i=function(t){return m.call(h,t)}}else{var y=f("state");d[y]=!0,r=function(t,e){return l(t,y,e),e},o=function(t){return u(t,y)?t[y]:{}},i=function(t){return u(t,y)}}t.exports={set:r,get:o,has:i,enforce:function(t){return i(t)?o(t):r(t,{})},getterFor:function(t){return function(e){var n;if(!c(e)||(n=o(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}}}},function(t,e,n){var r=n(10),o=n(183),i=r.WeakMap;t.exports="function"==typeof i&&/native code/.test(o(i))},function(t,e,n){var r=n(185),o=n(186),i=r("keys");t.exports=function(t){return i[t]||(i[t]=o(t))}},function(t,e){t.exports=!1},function(t,e,n){var r=n(25),o=n(376),i=n(178),a=n(182);t.exports=function(t,e){for(var n=o(e),s=a.f,c=i.f,l=0;l<n.length;l++){var u=n[l];r(t,u)||s(t,u,c(e,u))}}},function(t,e,n){var r=n(377),o=n(379),i=n(384),a=n(45);t.exports=r("Reflect","ownKeys")||function(t){var e=o.f(a(t)),n=i.f;return n?e.concat(n(t)):e}},function(t,e,n){var r=n(378),o=n(10),i=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?i(r[t])||i(o[t]):r[t]&&r[t][e]||o[t]&&o[t][e]}},function(t,e,n){var r=n(10);t.exports=r},function(t,e,n){var r=n(380),o=n(383).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,o)}},function(t,e,n){var r=n(25),o=n(96),i=n(381).indexOf,a=n(187);t.exports=function(t,e){var n,s=o(t),c=0,l=[];for(n in s)!r(a,n)&&r(s,n)&&l.push(n);for(;e.length>c;)r(s,n=e[c++])&&(~i(l,n)||l.push(n));return l}},function(t,e,n){var r=n(96),o=n(188),i=n(382),a=function(t){return function(e,n,a){var s,c=r(e),l=o(c.length),u=i(a,l);if(t&&n!=n){for(;l>u;)if((s=c[u++])!=s)return!0}else for(;l>u;u++)if((t||u in c)&&c[u]===n)return t||u||0;return!t&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},function(t,e,n){var r=n(60),o=Math.max,i=Math.min;t.exports=function(t,e){var n=r(t);return n<0?o(n+e,0):i(n,e)}},function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var r=n(17),o=/#|\.prototype\./,i=function(t,e){var n=s[a(t)];return n==l||n!=c&&("function"==typeof e?r(e):!!e)},a=i.normalize=function(t){return String(t).replace(o,".").toLowerCase()},s=i.data={},c=i.NATIVE="N",l=i.POLYFILL="P";t.exports=i},function(t,e,n){"use strict";var r=n(17);function o(t,e){return RegExp(t,e)}e.UNSUPPORTED_Y=r((function(){var t=o("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),e.BROKEN_CARET=r((function(){var t=o("^r","gy");return t.lastIndex=2,null!=t.exec("str")}))},function(t,e,n){"use strict";n(114);var r=n(110),o=n(17),i=n(217),a=n(98),s=n(39),c=i("species"),l=!o((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),u="$0"==="a".replace(/./,"$0"),f=i("replace"),d=!!/./[f]&&""===/./[f]("a","$0"),p=!o((function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));t.exports=function(t,e,n,f){var h=i(t),v=!o((function(){var e={};return e[h]=function(){return 7},7!=""[t](e)})),m=v&&!o((function(){var e=!1,n=/a/;return"split"===t&&((n={}).constructor={},n.constructor[c]=function(){return n},n.flags="",n[h]=/./[h]),n.exec=function(){return e=!0,null},n[h](""),!e}));if(!v||!m||"replace"===t&&(!l||!u||d)||"split"===t&&!p){var g=/./[h],y=n(h,""[t],(function(t,e,n,r,o){return e.exec===a?v&&!o?{done:!0,value:g.call(e,n,r)}:{done:!0,value:t.call(n,e,r)}:{done:!1}}),{REPLACE_KEEPS_$0:u,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:d}),A=y[0],b=y[1];r(String.prototype,t,A),r(RegExp.prototype,h,2==e?function(t,e){return b.call(t,this,e)}:function(t){return b.call(t,this)})}f&&s(RegExp.prototype[h],"sham",!0)}},function(t,e,n){var r=n(189);t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(t,e,n){var r=n(58);t.exports=function(t){return Object(r(t))}},function(t,e,n){"use strict";var r=n(391).charAt;t.exports=function(t,e,n){return e+(n?r(t,e).length:1)}},function(t,e,n){var r=n(60),o=n(58),i=function(t){return function(e,n){var i,a,s=String(o(e)),c=r(n),l=s.length;return c<0||c>=l?t?"":void 0:(i=s.charCodeAt(c))<55296||i>56319||c+1===l||(a=s.charCodeAt(c+1))<56320||a>57343?t?s.charAt(c):i:t?s.slice(c,c+2):a-56320+(i-55296<<10)+65536}};t.exports={codeAt:i(!1),charAt:i(!0)}},function(t,e,n){var r=n(115),o=n(98);t.exports=function(t,e){var n=t.exec;if("function"==typeof n){var i=n.call(t,e);if("object"!=typeof i)throw TypeError("RegExp exec method returned something other than an Object or null");return i}if("RegExp"!==r(t))throw TypeError("RegExp#exec called on incompatible receiver");return o.call(t,e)}},,,,,,,,,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;
/*
 * @copyright Copyright (c) 2019 Julius Härtl <jus@bitgrid.net>
 *
 * @author Julius Härtl <jus@bitgrid.net>
 *
 * @license GNU AGPL version 3 or any later version
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 *
 */
var r="ooxml"===OC.getCapabilities().richdocuments.config.doc_format,o=function(){return r?{document:{extension:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"},spreadsheet:{extension:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},presentation:{extension:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"}}:{document:{extension:"odt",mime:"application/vnd.oasis.opendocument.text"},spreadsheet:{extension:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"},presentation:{extension:"odp",mime:"application/vnd.oasis.opendocument.presentation"}}},i={getFileTypes:o,getFileType:function(t){return o()[t]}};e.default=i},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(106);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.postMessageHandlers=[],this.targets=e,window.addEventListener("message",(function(t){n.handlePostMessage(t.data)}),!1)}var e,n,a;return e=t,a=[{key:"parsePostMessage",value:function(t){var e,n,r;try{var o=JSON.parse(t);e=o.MessageId,n=o.Values,r=!!o.Values.Deprecated}catch(n){e=t}return{msgId:e,args:n,deprecated:r}}}],(n=[{key:"sendPostMessage",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"*";("function"==typeof this.targets[t]?this.targets[t]():this.targets[t]).postMessage(e,n),console.debug("PostMessageService.sendPostMessage",t,e)}},{key:"sendWOPIPostMessage",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={MessageId:e,SendTime:Date.now(),Values:n};this.sendPostMessage(t,JSON.stringify(r))}},{key:"registerPostMessageHandler",value:function(t){this.postMessageHandlers.push(t)}},{key:"unregisterPostMessageHandler",value:function(t){var e=this.postMessageHandlers.findIndex((function(e){return e===t}));delete this.postMessageHandlers[e]}},{key:"handlePostMessage",value:function(e){var n=t.parsePostMessage(e);if(null!=n){try{var i=JSON.parse(e);"object"===o(i)&&null!==i&&(0,r.emit)("richdocuments:wopi-post",i)}catch(t){}this.postMessageHandlers.forEach((function(t){n.deprecated?console.debug("PostMessageService.handlePostMessage","Ignoring deprecated post message",n.msgId):t({data:e,parsed:n})}))}}}])&&i(e.prototype,n),a&&i(e,a),t}();e.default=a},,,,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(365),o=(0,r.getSearchParam)("richdocuments_create"),i=(0,r.getSearchParam)("richdocuments_open"),a={};
/*
 * @copyright Copyright (c) 2020 Julius Härtl <jus@bitgrid.net>
 *
 * @author Julius Härtl <jus@bitgrid.net>
 *
 * @license GNU AGPL version 3 or any later version
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 *
 */o&&(a.create={type:(0,r.getSearchParam)("richdocuments_create"),filename:(0,r.getSearchParam)("richdocuments_filename")}),i&&(a.open={filename:i,id:(0,r.getSearchParam)("richdocuments_fileId")});var s=a;e.default=s},function(e,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o,i=(o=r(405))&&o.__esModule?o:{default:o};
/*
 * @copyright Copyright (c) 2020 Julius Härtl <jus@bitgrid.net>
 *
 * @author Julius Härtl <jus@bitgrid.net>
 *
 * @license GNU AGPL version 3 or any later version
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 *
 */
var a={attach:function(e){var n=this,r=i.default.getFileType("document"),o=i.default.getFileType("spreadsheet"),a=i.default.getFileType("presentation");e.addMenuEntry({id:"add-"+r.extension,displayName:t("richdocuments","New Document"),templateName:t("richdocuments","New Document")+"."+r.extension,iconClass:"icon-filetype-document",fileType:"x-office-document",actionHandler:function(t){OC.getCapabilities().richdocuments.templates?n._openTemplatePicker("document",r.mime,t):n._createDocument(r.mime,t)}}),e.addMenuEntry({id:"add-"+o.extension,displayName:t("richdocuments","New Spreadsheet"),templateName:t("richdocuments","New Spreadsheet")+"."+o.extension,iconClass:"icon-filetype-spreadsheet",fileType:"x-office-spreadsheet",actionHandler:function(t){OC.getCapabilities().richdocuments.templates?n._openTemplatePicker("spreadsheet",o.mime,t):n._createDocument(o.mime,t)}}),e.addMenuEntry({id:"add-"+a.extension,displayName:t("richdocuments","New Presentation"),templateName:t("richdocuments","New Presentation")+"."+a.extension,iconClass:"icon-filetype-presentation",fileType:"x-office-presentation",actionHandler:function(t){OC.getCapabilities().richdocuments.templates?n._openTemplatePicker("presentation",a.mime,t):n._createDocument(a.mime,t)}})},_createDocument:function(e,n){OCA.Files.Files.isFileNameValid(n),n=FileList.getUniqueName(n),$.post(OC.generateUrl("apps/richdocuments/ajax/documents/create"),{mimetype:e,filename:n,dir:document.getElementById("dir").value},(function(e){e&&"success"===e.status?FileList.add(e.data,{animate:!0,scrollTo:!0}):OC.dialogs.alert(e.data.message,t("core","Could not create file"))}))},_createDocumentFromTemplate:function(e,n,r){OCA.Files.Files.isFileNameValid(r),r=FileList.getUniqueName(r),$.post(OC.generateUrl("apps/richdocuments/ajax/documents/create"),{mimetype:n,filename:r,dir:document.getElementById("dir").value},(function(n){if(n&&"success"===n.status){FileList.add(n.data,{animate:!1,scrollTo:!1});var o=FileList.getModelForFile(r),i=document.getElementById("dir").value+"/"+r;OCA.RichDocuments.openWithTemplate({fileId:-1,path:i,templateId:e,fileList:window.FileList,fileModel:o})}else OC.dialogs.alert(n.data.message,t("core","Could not create file"))}))},_openTemplatePicker:function(e,n,r){var o=this;$.ajax({url:OC.linkToOCS("apps/richdocuments/api/v1/templates",2)+e,dataType:"json"}).then((function(e){if(1!==e.ocs.data.length)o._buildTemplatePicker(e.ocs.data).then((function(){var e=[{text:t("core","Cancel"),classes:"cancel",click:function(){$(this).ocdialog("close")}},{text:t("richdocuments","Create"),classes:"primary",click:function(){var t=this.dataset.templateId;o._createDocumentFromTemplate(t,n,r),$(this).ocdialog("close")}}];$("#template-picker").ocdialog({closeOnEscape:!0,modal:!0,buttons:e}).on("click",".foldersTab label",(function(){$(".folderWrapper").each((function(){$(this).toggleClass("hidden")}))}))}));else{var i=e.ocs.data[0].id;o._createDocumentFromTemplate(i,n,r)}}))},_buildTemplatePicker:function(e){var n=this;return $.get(OC.filePath("richdocuments","templates","templatePicker.html"),(function(r){var o=$(r).octemplate({dialog_name:"template-picker",dialog_title:t("richdocuments","Select template"),defultTemplate_title:t("richdocuments","User Templates"),templaterepo_title:t("richdocuments","Templaterepo")});if(_.values(e).forEach((function(t){n._appendTemplateFromData(o[0],t)})),$("body").append(o),$(".templaterepoFolder").children().length<1){var i="<em>".concat(t("richdocuments","No Template"),"</em>");$(".templaterepoFolder").append(i).css("justify-content","center")}}))},_appendTemplateFromData:function(t,e){var n=t.querySelector(".template-model").cloneNode(!0);n.className="",n.querySelector("img").src=OC.generateUrl("apps/richdocuments/template/preview/"+e.id),e.preview?n.querySelector("img").src=e.preview:n.querySelector("img").classList.add("emptyImg"),n.querySelector("h2").textContent=e.name,n.onclick=function(){t.dataset.templateId=e.id},t.dataset.templateId||(t.dataset.templateId=e.id),e.templaterepoFolder?t.querySelector(".templaterepoFolder").appendChild(n):t.querySelector(".defultFolder").appendChild(n)}};n.default=a},,,,,,,,,,,,,,,function(t,e,n){"use strict";t.exports=function(t,e){return e||(e={}),"string"!=typeof(t=t&&t.__esModule?t.default:t)?t:(/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),e.hash&&(t+=e.hash),/["'() \t\n]/.test(t)||e.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t)}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=l(r(551)),i=r(242),a=l(r(405)),s=l(r(190)),c=l(r(552));function l(t){return t&&t.__esModule?t:{default:t}}function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var d=document.getElementById("isPublic")&&"1"===document.getElementById("isPublic").value,p={fileModel:null,fileList:void 0,filePath:void 0,views:{},followingEditor:!1,following:null,handlers:{},startLoading:function(){this.getFileList()&&(this.getFileList().setViewerMode&&this.getFileList().setViewerMode(!0),this.getFileList().showMask&&this.getFileList().showMask())},init:function(t){var e=this,n=t.fileName,r=t.fileId,o=t.filePath,i=t.sendPostMessage,a=t.fileList,s=t.fileModel;this.fileName=n,this.fileId=r,this.fileList=a,this.filePath=o,this.fileModel=s,this.sendPostMessage=i,this.fileModel&&this.fileModel.on&&this.fileModel.on("change",(function(){e._addHeaderFileActions()}))},registerHandler:function(t,e){this.handlers[t]=e},initAfterReady:function(){if(!this.handlers.initAfterReady||!this.handlers.initAfterReady(this)){this.getFileList()&&(this.getFileModel(),this.getFileList().hideMask&&this.getFileList().hideMask(),this.getFileList().setPageTitle&&this.getFileList().setPageTitle(this.fileName));var t=document.querySelector("#header .header-right");if(!document.getElementById("richdocuments-header")){var e=document.createElement("div");e.id="richdocuments-header",t.insertBefore(e,t.firstChild),this._addAvatarList(),d||(this._addHeaderShareButton(),this._addHeaderFileActions(),this.addVersionSidebarEvents())}}},close:function(){this.handlers.close&&this.handlers.close(this)||(this.getFileList()&&(this.getFileList().setViewerMode&&this.getFileList().setViewerMode(!1),this.getFileList().reload&&this.getFileList().reload()),this.fileModel=null,d||this.removeVersionSidebarEvents(),$("#richdocuments-header").remove())},saveAs:function(t){this.handlers.saveAs&&this.handlers.saveAs(this)||(t&&(this.fileName=t),this.getFileList()&&(this.getFileList().reload(),OC.Apps.hideAppSidebar()))},share:function(){this.handlers.share&&this.handlers.share(this)||(!d&&this.getFileList()?(this.getFileList().showDetailsView&&this.getFileList().showDetailsView(this.fileName,"shareTabView"),OC.Apps.showAppSidebar()):console.error("[FilesAppIntegration] Sharing is not supported"))},rename:function(t){this.fileName=t,this.handlers.rename&&this.handlers.rename(this)||this.getFileList()&&(this.getFileList().reload&&this.getFileList().reload(),OC.Apps.hideAppSidebar())},insertGraphic:function(e){d&&console.error("[FilesAppIntegration] insertGraphic is not supported");var n=function(t){var n=t.substring(t.lastIndexOf("/")+1);$.ajax({type:"POST",url:OC.generateUrl("apps/richdocuments/assets"),data:{path:t}}).done((function(t){e(n,t.url)}))};this.handlers.insertGraphic&&this.handlers.insertGraphic(this,{insertFileFromPath:n})||OC.dialogs.filepicker(t("richdocuments","Insert from {name}",{name:OC.theme.name}),(function(t,e){e===OC.dialogs.FILEPICKER_TYPE_CHOOSE&&n(t)}),!1,["image/png","image/gif","image/jpeg","image/svg"],!0,OC.dialogs.FILEPICKER_TYPE_CHOOSE)},getFileList:function(){return this.fileList?this.fileList:OCA.Files&&OCA.Files.App?OCA.Files.App.fileList:OCA.Sharing&&OCA.Sharing.PublicApp?OCA.Sharing.PublicApp.fileList:null},getFileModel:function(){var t=this;return this.fileModel?this.fileModel:this.getFileList()?(this.getFileList()._updateDetailsView&&this.getFileList()._updateDetailsView(this.fileName,!1),this.fileModel=this.getFileList().getModelForFile(this.fileName),this.fileModel&&this.fileModel.on&&this.fileModel.on("change",(function(){t._addHeaderFileActions()})),this.fileModel):null},setViews:function(t){var e=this;this.views={},t.forEach((function(t){e.views[t.ViewId]=t})),this.renderAvatars()},followReset:function(t){this.sendPostMessage("Action_FollowUser",{Follow:!1}),this.following=null,this.followingEditor=!1,this.renderAvatars()},followCurrentEditor:function(t){this.sendPostMessage("Action_FollowUser",{Follow:!0}),this.following=null,this.followingEditor=!0,this.renderAvatars()},followView:function(t){this.sendPostMessage("Action_FollowUser",{ViewId:t.ViewId,Follow:!0}),this.following=t.ViewId,this.followingEditor=!1,this.renderAvatars()},_addAvatarList:function(){var t=$('<div id="richdocuments-avatars">');t.on("click",(function(t){t.stopPropagation(),$("#editors-menu").toggle()})),$("#richdocuments-header").append(t)},_addHeaderShareButton:function(){var t=this;if($("header").length){var e=$('<div id="richdocuments-sharing"><a class="icon-shared icon-white"></a></div>');$("#richdocuments-header").append(e),e.on("click",(function(){if(!$("#app-sidebar").is(":visible"))return t.share();OC.Apps.hideAppSidebar()})),$(".searchbox").hide()}},_addHeaderFileActions:function(){var e=this;console.debug("[FilesAppIntegration] Adding header file actions"),OC.unregisterMenu($("#richdocuments-actions .icon-more"),$("#richdocuments-actions-menu")),$("#richdocuments-actions").remove();var n,r=$('<div id="richdocuments-actions"><div class="icon-more icon-white"></div><ul id="richdocuments-actions-menu" class="popovermenu"></ul></div>'),o=r.find("#richdocuments-actions-menu").empty(),i=function(){return{$file:e.getFileList().$el?e.getFileList().$el.find("[data-id="+e.fileId+"]").first():null,fileActions:e.getFileList().fileActions,fileList:e.getFileList(),fileInfoModel:e.getFileModel()}},a=$("<li><a></a></li>").click((function(t){a.find("a").removeClass("icon-starred").removeClass("icon-star-dark").addClass("icon-loading-small"),e.handlers.actionFavorite&&e.handlers.actionFavorite(e)||(e.getFileList().fileActions.triggerAction("Favorite",e.getFileModel(),e.getFileList()),e.getFileModel().trigger("change",e.getFileModel()))}));(n=this.getFileModel()).get("tags")&&n.get("tags").indexOf(OC.TAG_FAVORITE)>=0?(a.find("a").text(t("files","Remove from favorites")),a.find("a").addClass("icon-starred")):(a.find("a").text(t("files","Add to favorites")),a.find("a").addClass("icon-star-dark"));var s=$('<li><a class="icon-info"></a></li>').click((function(){e.handlers.actionDetails&&e.handlers.actionDetails(e)||(e.getFileList().fileActions.actions.all.Details.action(e.fileName,i()),OC.hideMenus())}));s.find("a").text(t("files","Details"));var c=$('<li><a class="icon-download">Download</a></li>').click((function(){e.handlers.actionDownload&&e.handlers.actionDownload(e)||(e.getFileList().fileActions.actions.all.Download.action(e.fileName,i()),OC.hideMenus())}));c.find("a").text(t("files","Download")),o.append(a).append(s).append(c),$("#richdocuments-header").append(r),OC.registerMenu($("#richdocuments-actions .icon-more"),$("#richdocuments-actions-menu"),!1,!0)},_userEntry:function(e){var n=this,r=$("<li></li>");r.append(this._avatarForView(e));var o=$('<div class="label"></div>');o.text(e.UserName),"1"===e.ReadOnly&&o.text(e.UserName+" "+t("richdocuments","(read only)")),o.click((function(t){t.stopPropagation(),n.followView(e)})),this.following===e.ViewId&&($("#editors-menu").find("li").removeClass("active"),r.addClass("active")),r.append(o);var i=!d&&this.getFileModel()&&void 0===this.getFileModel().get("shareOwner"),a=this.getFileModel()&&!!(this.getFileModel().get("permissions")&OC.PERMISSION_UPDATE);if(i&&a&&!e.IsCurrentView){var s=$('<div class="icon-close" title="'+t("richdocuments","Remove user")+'"/>');s.click((function(){n.sendPostMessage("Action_RemoveView",{ViewId:e.ViewId})})),r.append(s)}return r},_avatarForView:function(e){var n=""===e.UserId?e.UserName:e.UserId,r=$('<div class="richdocuments-avatar"><div class="avatar" title="'+e.UserName+'" data-user="'+n+'"></div></div>'),o=r.find(".avatar");return o.css({"border-color":"#"+("000000"+Number(e.Color).toString(16)).substr(-6),"border-width":"2px","border-style":"solid"}),"1"===e.ReadOnly?(r.addClass("read-only"),$(o).attr("title",e.UserName+" "+t("richdocuments","(read only)"))):$(o).attr("title",e.UserName),$(o).avatar(n,32,void 0,!0,void 0,e.UserName),r},renderAvatars:function(){var e=this,n=$("#header .header-right #richdocuments-avatars");n.empty();var r=$('<div id="editors-menu" class="popovermenu menu-center"><ul></ul></div>'),o=[],i=0;for(var a in this.views){var s=this.views[a];s.UserName=""!==s.UserName?s.UserName:t("richdocuments","Guest"),r.find("ul").append(this._userEntry(s)),s.UserId!==OC.currentUser&&(""!==s.UserId&&o.indexOf(s.UserId)>-1||(o.push(s.UserId),i++<4&&n.append(this._avatarForView(s))))}var c=$('<li><input type="checkbox" class="checkbox" /><label class="label">'+t("richdocuments","Follow current editor")+"</label></li>");c.find("label").click((function(t){t.stopPropagation(),e.followingEditor?e.followReset():e.followCurrentEditor()})),c.find(".checkbox").prop("checked",this.followingEditor),r.find("ul").append(c),n.append(r)},_originalOnClickRevertVersion:null,addVersionSidebarEvents:function(){var t=OCA.Files.App.fileList._detailsView._tabViews.find((function(t){return"versionsTabView"===t.el.id}));t&&(this._originalOnClickRevertVersion=t._onClickRevertVersion,OCA.Files.App.fileList._detailsView._tabViews.find((function(t){return"versionsTabView"===t.el.id}))._onClickRevertVersion=function(){}),$(document.querySelector("#content")).on("click.revisions","#app-sidebar .preview-container",this.showVersionPreview.bind(this)),$(document.querySelector("#content")).on("click.revisions","#app-sidebar .downloadVersion",this.showVersionPreview.bind(this)),$(document.querySelector("#content")).on("mousedown.revisions","#app-sidebar .revertVersion",this.restoreVersion.bind(this)),$(document.querySelector("#content")).on("click.revisionsTab","#app-sidebar [data-tabid=versionsTabView]",this.addCurrentVersion.bind(this))},removeVersionSidebarEvents:function(){var t=OCA.Files.App.fileList._detailsView._tabViews.find((function(t){return"versionsTabView"===t.el.id}));t&&(t._onClickRevertVersion=this._originalOnClickRevertVersion),$(document.querySelector("#content")).off("click.revisions"),$(document.querySelector("#content")).off("click.revisions"),$(document.querySelector("#content")).off("mousedown.revisions"),$(document.querySelector("#content")).off("click.revisionsTab")},addCurrentVersion:function(){if($("#lastSavedVersion").remove(),$("#currentVersion").remove(),this.getFileModel()){var e=OC.MimeType.getIconUrl(this.getFileModel().get("mimetype")),n=this.getFileModel().get("mtime");$("#versionsTabView").prepend('<ul id="lastSavedVersion"><li data-revision="0"><div><div class="preview-container"><img src="'+e+'" width="44" /></div><div class="version-container">\n<div><a class="downloadVersion">'+t("richdocuments","Last saved version")+'<br /><span class="versiondate has-tooltip live-relative-timestamp" data-timestamp="'+n+'"></span></div></div></li></ul>'),$("#versionsTabView").prepend('<ul id="currentVersion"><li data-revision="" class="active"><div><div class="preview-container"><img src="'+e+'" width="44" /></div><div class="version-container">\n<div><a class="downloadVersion">'+t("richdocuments","Current version")+"</a></div></div></li></ul>"),$(".live-relative-timestamp").each((function(){$(this).text(OC.Util.relativeModifiedDate(parseInt($(this).attr("data-timestamp"),10)))}))}},showRevHistory:function(){this.handlers.showRevHistory&&this.handlers.showRevHistory(this)||this.getFileList()&&(this.getFileList().showDetailsView(this.fileName,"versionsTabView"),this.addCurrentVersion())},showVersionPreview:function(t){t.preventDefault();var e=t.currentTarget.parentElement.parentElement;$(t.currentTarget).hasClass("downloadVersion")&&(e=t.currentTarget.parentElement.parentElement.parentElement.parentElement);var n=e.dataset.revision,r=this.fileId,o=this.fileName;console.debug("[FilesAppIntegration] showVersionPreview",n,r,o),this.sendPostMessage("Action_loadRevViewer",{fileId:r,title:o,version:n}),$(e.parentElement.parentElement).find("li").removeClass("active"),$(e).addClass("active")},restoreVersion:function(t){var e=this;t.preventDefault(),t.stopPropagation(),this.sendPostMessage("Host_VersionRestore",{Status:"Pre_Restore"});var n=t.currentTarget.parentElement.parentElement.dataset.revision;return this._restoreVersionCallback=function(){e._restoreDAV(n),e._restoreVersionCallback=null},!1},restoreVersionExecute:function(){null!==this._restoreVersionCallback&&this._restoreVersionCallback()},restoreVersionAbort:function(){this._restoreVersionCallback=null},_restoreSuccess:function(e){"error"===e.status&&OC.Notification.showTemporary(t("richdocuments","Failed to revert the document to older version")),document.getElementById("richdocumentsframe").src=document.getElementById("richdocumentsframe").src,OC.Apps.hideAppSidebar()},_restoreError:function(){OC.Notification.showTemporary(t("richdocuments","Failed to revert the document to older version"))},_restoreDAV:function(t){var e=OC.linkToRemoteBase("dav")+"/versions/"+OC.getCurrentUser().uid+"/versions/"+this.fileId+"/"+t;$.ajax({type:"MOVE",url:e,headers:{Destination:OC.linkToRemote("dav")+"/versions/"+OC.getCurrentUser().uid+"/restore/target"},success:this._restoreSuccess.bind(this),error:this._restoreError.bind(this)})},createNewFile:function(e){this.handlers.createNewFile&&this.handlers.createNewFile(this,{type:e})||OC.dialogs.prompt(t("richdocuments","Please enter the filename for the new document"),t("richdocuments","Save As"),(function(t,n){if(!0===t&&n){"text"===e&&(e="document");var r=parent.$("#dir").val(),o=OC.generateUrl("/apps/files/?dir="+r+"&richdocuments_create="+e+"&richdocuments_filename="+encodeURI(n));window.open(o,"_blank")}}),!0,t("richdocuments","New filename"),!1).then((function(){var e=parent.$(".oc-dialog:visible").find("button");e.eq(0).text(t("richdocuments","Cancel")),e.eq(1).text(t("richdocuments","Create a new document"))}))},preloadOpen:function(){if(!this.handlers.preloadOpen||!this.handlers.preloadOpen(this)){var t=o.default.open.id,e=o.default.open.filename;setTimeout((function(){window.FileList.$fileList.one("updated",(function(){var n=u((0,i.splitPath)(e),2)[1],r=FileList.getModelForFile(n);OCA.RichDocuments.open({path:e,fileId:t,fileModel:r,fileList:window.FileList})}))}),250)}},preloadCreate:function(){this.handlers.preloadCreate&&this.handlers.preloadCreate(this)||setTimeout((function(){window.FileList.$fileList.one("updated",(function(){var t=a.default.getFileType(o.default.create.type,s.default.get("ooxml"));c.default._openTemplatePicker(o.default.create.type,t.mime,o.default.create.filename+"."+t.extension)}))}),250)},loggingContext:function(){var t,e,n;return{currentUser:null===(t=OC.getCurrentUser())||void 0===t?void 0:t.uid,file:{sharingToken:null===(e=document.getElementById("sharingToken"))||void 0===e?void 0:e.value,fileId:this.fileId,filePath:(null!==(n=this.filePath)&&void 0!==n?n:"")+"/"+this.fileName}}}};n.default=p},,,,function(t,e,n){"use strict";var r=n(41),o=n.n(r),i=n(42),a=n.n(i),s=n(567),c=n.n(s),l=n(833),u=n(834),f=n(835),d=a()(o.a),p=c()(l.a),h=c()(u.a),v=c()(f.a);d.push([t.i,"#odf-canvas{position:relative;top:37px;left:0px;border:1px solid darkgray;border-left:0 none;box-shadow:0px 4px 10px #000;-moz-box-shadow:0px 4px 10px #000;-webkit-box-shadow:0px 4px 10px #000}.icon-filetype-document{background-image:url("+p+")}.icon-filetype-spreadsheet{background-image:url("+h+")}.icon-filetype-presentation{background-image:url("+v+")}.richdocuments-sharing .icon-shared{display:block;width:16px;height:16px;padding:16px;opacity:0.6}.richdocuments-sharing .icon-shared:hover,.richdocuments-sharing .icon-shared:focus{opacity:1}#richdocumentsframe{background-color:#fff;width:100%;height:calc(100vh - 50px);display:block;position:absolute;top:0;z-index:110}#editors-menu{min-width:200px;top:50px}#editors-menu ul li{display:flex;padding:3px;border-left:3px solid transparent}#editors-menu ul li.active{border-left:3px solid var(--color-primary)}#editors-menu ul li .label{padding:6px;flex-grow:1}#editors-menu ul li .label .icon-play-next{opacity:.5;display:inline-block;padding-left:10px;vertical-align:top}#editors-menu ul li label.label::before{margin-right:16px;margin-left:7px}#editors-menu ul li .icon-close{padding:8px}#richdocuments-avatars{position:relative;right:-15px}#richdocuments-avatars>.richdocuments-avatar{float:right;border-radius:50%;margin:8px;margin-left:-20px;box-shadow:0px 0px 3px rgba(0,0,0,0.5);position:relative}#richdocuments-avatars>.richdocuments-avatar.read-only{opacity:0.8}#richdocuments-header{display:flex}#richdocuments-header>div .icon-shared,#richdocuments-header>div .icon-more{display:block;min-width:50px;height:50px}#richdocuments-actions{position:relative}#richdocuments-actions li{white-space:nowrap}#richdocuments-actions li a.icon-loading-small:after{left:19px}#versionsTabView li{padding-left:15px;margin-left:-15px}#versionsTabView li.active{border-left:3px solid var(--color-primary, #000);padding-left:12px}#currentVersion li,#lastSavedVersion li{border-bottom:1px solid rgba(100,100,100,0.1)}#currentVersion li .version-container .downloadVersion,#lastSavedVersion li .version-container .downloadVersion{display:flex;flex-direction:column;margin-left:12px}#template-picker .template-container:not(.hidden){display:flex;flex-wrap:wrap}#template-picker .template-container:not(.hidden) a{border-radius:var(--border-radius);border:1px solid var(--color-border);margin:10px;position:relative}#template-picker .template-container:not(.hidden) a:hover,#template-picker .template-container:not(.hidden) a:focus{border-color:var(--color-primary-element)}#template-picker .template-container:not(.hidden) a>span{display:flex;flex-direction:column;width:170px;margin:10px;cursor:pointer}#template-picker .template-container:not(.hidden) a>span>img,#template-picker .template-container:not(.hidden) a>span>span{width:170px;height:240.42857px;background-color:var(--color-background-dark);background-size:24px}#template-picker .template-container:not(.hidden) a>span>h2{margin-top:10px;font-size:inherit}#template-picker .template-container:not(.hidden) .folderWrapper{width:100%}#template-picker .template-container:not(.hidden) .folderWrapper>div:not(.foldersTab){display:flex;flex-wrap:wrap}#template-picker .template-container:not(.hidden) .folderWrapper>div:not(.foldersTab) a{border-radius:3px;border-radius:var(--border-radius);border:1px solid var(--color-border);margin:10px;position:relative}#template-picker .template-container:not(.hidden) .folderWrapper>div:not(.foldersTab) a:hover,#template-picker .template-container:not(.hidden) .folderWrapper>div:not(.foldersTab) a:focus{background-color:var(--color-primary-element);transition:all 0.2s ease-out}#template-picker .template-container:not(.hidden) .folderWrapper>div:not(.foldersTab) a>span{display:flex;flex-direction:column;width:170px;margin:10px;cursor:pointer}#template-picker .template-container:not(.hidden) .folderWrapper>div:not(.foldersTab) a>span>img,#template-picker .template-container:not(.hidden) .folderWrapper>div:not(.foldersTab) a>span>span{width:170px;height:240.42857px;background-color:var(--color-background-dark);background-size:24px}#template-picker .template-container:not(.hidden) .folderWrapper>div:not(.foldersTab) a>span>h2{margin-top:10px;font-size:inherit;word-break:break-all}#template-picker .template-container:not(.hidden) .folderWrapper>div:not(.foldersTab) .emptyImg{position:relative}#template-picker .template-container:not(.hidden) .folderWrapper>div:not(.foldersTab) .emptyImg::before{content:'';position:absolute;background-color:#e9e9e9;width:100%;height:100%}#template-picker .template-container:not(.hidden) .foldersTab{width:100%;margin:35px 10px 30px 10px;display:flex;justify-content:space-between}#template-picker .template-container:not(.hidden) .foldersTab input{display:none}#template-picker .template-container:not(.hidden) .foldersTab input:checked+label{color:gray;background-color:var(--color-border);pointer-events:none;position:relative}#template-picker .template-container:not(.hidden) .foldersTab input:checked+label:after{content:' ';display:block;height:0;width:0;position:absolute;pointer-events:none;border:0 solid #fff;border-top-color:var(--color-border);border-width:15px;bottom:-29px;left:47%}#template-picker .template-container:not(.hidden) .foldersTab input:not(:checked)+label{font-weight:normal;color:gray;border:1px solid var(--color-border)}#template-picker .template-container:not(.hidden) .foldersTab input:not(:checked)+label:hover{color:gray;font-weight:bold;cursor:pointer}#template-picker .template-container:not(.hidden) .foldersTab label{width:100%;display:inline-block;font-size:15px;font-weight:bold;text-align:center;padding:8px 20px;transition:0.1s}\n","",{version:3,sources:["webpack://./css/viewer.scss","webpack://./css/templatePicker.scss"],names:[],mappings:"AAAA,YACC,iBAAkB,CAClB,QAAS,CACT,QAAS,CACT,yBAAyB,CACzB,kBAAkB,CAClB,4BAA6B,CAC7B,iCAAkC,CAClC,oCAAqC,CACrC,wBAGA,wDAAqD,CACrD,2BAGA,wDAAwD,CACxD,4BAGA,wDAAyD,CACzD,oCAGA,aAAc,CACd,UAAW,CACX,WAAY,CACZ,YAAa,CACb,WAAY,CACZ,oFAIA,SAAU,CACV,oBAGA,qBAAsB,CACtB,UAAU,CACV,yBAA0B,CAC1B,aAAa,CACb,iBAAiB,CACjB,KAAK,CACL,WAAW,CACX,cAGA,eAAgB,CAChB,QAAS,CAFV,oBAKE,YAAa,CACb,WAAY,CACZ,iCAAkC,CAPpC,2BASG,0CAA2C,CAT9C,2BAaG,WAAY,CACZ,WAAY,CAdf,2CAiBI,UAAW,CACX,oBAAqB,CACrB,iBAAkB,CAClB,kBAAmB,CApBvB,wCAwBG,iBAAkB,CAClB,eAAgB,CAzBnB,gCA4BG,WAAY,CACZ,uBAKF,iBAAkB,CAClB,WAAY,CAFb,6CAKE,WAAY,CACZ,iBAAkB,CAClB,UAAW,CACX,iBAAkB,CAClB,sCAA0C,CAC1C,iBAAkB,CAVpB,uDAYG,WAAY,CACZ,sBAKF,YAAa,CADd,4EAIE,aAAc,CACd,cAAe,CACf,WAAY,CACZ,uBAID,iBAAkB,CADnB,0BAGE,kBAAmB,CAHrB,qDAKG,SAAU,CACV,oBAKF,iBAAkB,CAClB,iBAAkB,CAClB,2BAGA,gDAAiD,CACjD,iBAAkB,CAClB,wCAIA,6CAA6C,CAF9C,gHAKE,YAAa,CACb,qBAAsB,CACtB,gBAAiB,CACjB,kDC9GA,YAAa,CACb,cAAe,CAHhB,oDAQE,kCAAmC,CACnC,oCAAqC,CACrC,WAHY,CAIZ,iBAAkB,CAXpB,oHAeG,yCAA0C,CAf7C,yDAmBG,YAAa,CACb,qBAAsB,CACtB,WAhBW,CAiBX,WAfW,CAgBX,cAAe,CAvBlB,2HA0BI,WArBU,CAsBV,kBArBuB,CAsBvB,6CAA8C,CAC9C,oBAAqB,CA7BzB,4DAgCI,eAzBU,CA0BV,iBAAkB,CAClB,iEAaF,UAAW,CAHd,sFAKI,YAAa,CACb,cAAe,CANnB,wFAWK,iBAAkB,CAClB,kCAAmC,CACnC,oCAAqC,CACrC,WAJY,CAKZ,iBAAkB,CAfvB,4LAmBM,6CAA8C,CAC9C,4BAA6B,CApBnC,6FAwBM,YAAa,CACb,qBAAsB,CACtB,WAlBW,CAmBX,WAjBW,CAkBX,cAAe,CA5BrB,mMA+BO,WAvBU,CAwBV,kBAvBuB,CAwBvB,6CAA8C,CAC9C,oBAAqB,CAlC5B,gGAqCO,eA3BU,CA4BV,iBAAkB,CAClB,oBAAqB,CAvC5B,gGA6CK,iBAAkB,CA7CvB,wGA+CM,UAAW,CACX,iBAAkB,CAClB,wBAAyB,CACzB,UAAW,CACX,WAAY,CAnDlB,8DA2DG,UAAW,CACX,0BAA2B,CAC3B,YAAa,CACV,6BAA8B,CA9DpC,oEAgEI,YAAa,CAhEjB,kFAkEK,UAAW,CACX,oCAAqC,CACrC,mBAAoB,CACpB,iBAAkB,CArEvB,wFAuEM,WAAY,CACZ,aAAc,CACd,QAAS,CACT,OAAQ,CACR,iBAAkB,CAClB,mBAAoB,CACpB,mBAAoB,CACpB,oCAAqC,CACrC,iBAAkB,CAClB,YAAa,CACb,QAAS,CAjFf,wFAsFK,kBAAmB,CACnB,UAAW,CACX,oCAAqC,CAxF1C,8FA0FM,UAAW,CACX,gBAAiB,CACjB,cAAe,CA5FrB,oEAiGI,UAAW,CACX,oBAAqB,CACrB,cAAe,CACf,gBAAiB,CACjB,iBAAkB,CAClB,gBAAiB,CACjB,eAAgB",sourcesContent:["#odf-canvas{\n\tposition: relative;\n\ttop: 37px;\n\tleft: 0px;\n\tborder:1px solid darkgray;\n\tborder-left:0 none;\n\tbox-shadow: 0px 4px 10px #000;\n\t-moz-box-shadow: 0px 4px 10px #000;\n\t-webkit-box-shadow: 0px 4px 10px #000;\n}\n\n.icon-filetype-document{\n\tbackground-image: url('../img/x-office-document.svg')\n}\n\n.icon-filetype-spreadsheet{\n\tbackground-image: url('../img/x-office-spreadsheet.svg');\n}\n\n.icon-filetype-presentation{\n\tbackground-image: url('../img/x-office-presentation.svg');\n}\n\n.richdocuments-sharing .icon-shared {\n\tdisplay: block;\n\twidth: 16px;\n\theight: 16px;\n\tpadding: 16px;\n\topacity: 0.6;\n}\n\n.richdocuments-sharing .icon-shared:hover,\n.richdocuments-sharing .icon-shared:focus {\n\topacity: 1;\n}\n\n#richdocumentsframe {\n\tbackground-color: #fff;\n\twidth:100%;\n\theight: calc(100vh - 50px);\n\tdisplay:block;\n\tposition:absolute;\n\ttop:0;\n\tz-index:110;\n}\n\n#editors-menu {\n\tmin-width: 200px;\n\ttop: 50px;\n\n\tul li {\n\t\tdisplay: flex;\n\t\tpadding: 3px;\n\t\tborder-left: 3px solid transparent;\n\t\t&.active {\n\t\t\tborder-left: 3px solid var(--color-primary);\n\t\t}\n\n\t\t.label {\n\t\t\tpadding: 6px;\n\t\t\tflex-grow: 1;\n\n\t\t\t.icon-play-next {\n\t\t\t\topacity: .5;\n\t\t\t\tdisplay: inline-block;\n\t\t\t\tpadding-left: 10px;\n\t\t\t\tvertical-align: top;\n\t\t\t}\n\t\t}\n\t\tlabel.label::before {\n\t\t\tmargin-right: 16px;\n\t\t\tmargin-left: 7px;\n\t\t}\n\t\t.icon-close {\n\t\t\tpadding: 8px;\n\t\t}\n\t}\n}\n\n#richdocuments-avatars {\n\tposition: relative;\n\tright: -15px;\n\n\t& > .richdocuments-avatar {\n\t\tfloat: right;\n\t\tborder-radius: 50%;\n\t\tmargin: 8px;\n\t\tmargin-left: -20px;\n\t\tbox-shadow: 0px 0px 3px rgba(0, 0, 0, 0.5);\n\t\tposition: relative;\n\t\t&.read-only {\n\t\t\topacity: 0.8;\n\t\t}\n\t}\n}\n\n#richdocuments-header {\n\tdisplay: flex;\n\t& > div .icon-shared,\n\t& > div .icon-more {\n\t\tdisplay: block;\n\t\tmin-width: 50px;\n\t\theight: 50px;\n\t}\n}\n\n#richdocuments-actions {\n\tposition: relative;\n\tli {\n\t\twhite-space: nowrap;\n\t\ta.icon-loading-small:after {\n\t\t\tleft: 19px;\n\t\t}\n\t}\n}\n\n#versionsTabView li {\n\tpadding-left: 15px;\n\tmargin-left: -15px;\n}\n\n#versionsTabView li.active {\n\tborder-left: 3px solid var(--color-primary, #000);\n\tpadding-left: 12px;\n}\n\n#currentVersion li,\n#lastSavedVersion li {\n\tborder-bottom: 1px solid rgba(100,100,100,.1);\n\n\t.version-container .downloadVersion {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tmargin-left: 12px;\n\t}\n}\n\n@import 'templatePicker';\n","/**\n * @copyright Copyright (c) 2018, John Molakvoæ (skjnldsv@protonmail.com)\n *\n * @author John Molakvoæ (skjnldsv) <skjnldsv@protonmail.com>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n #template-picker {\n\t.template-container:not(.hidden) {\n\t\tdisplay: flex;\n\t\tflex-wrap: wrap;\n\t\ta {\n\t\t\t$size: 170px;\n\t\t\t$sizeY: $size / 210 * 297;\n\t\t\t$space: 10px;\n\t\t\tborder-radius: var(--border-radius);\n\t\t\tborder: 1px solid var(--color-border);\n\t\t\tmargin: $space;\n\t\t\tposition: relative;\n\n\t\t\t&:hover,\n\t\t\t&:focus {\n\t\t\t\tborder-color: var(--color-primary-element);\n\t\t\t}\n\n\t\t\t> span {\n\t\t\t\tdisplay: flex;\n\t\t\t\tflex-direction: column;\n\t\t\t\twidth: $size;\n\t\t\t\tmargin: $space;\n\t\t\t\tcursor: pointer;\n\t\t\t\t> img,\n\t\t\t\t> span {\n\t\t\t\t\twidth: $size;\n\t\t\t\t\theight: $sizeY;\n\t\t\t\t\tbackground-color: var(--color-background-dark);\n\t\t\t\t\tbackground-size: 24px;\n\t\t\t\t}\n\t\t\t\t> h2 {\n\t\t\t\t\tmargin-top: $space;\n\t\t\t\t\tfont-size: inherit;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\nodfweb 新增/修改的內容\n需要在 templatePicker.scss import\n*/\n#template-picker {\n\t.template-container:not(.hidden) {\n\t\t.folderWrapper {\n\t\t\twidth: 100%;\n\t\t\t& > div:not(.foldersTab) {\n\t\t\t\tdisplay: flex;\n\t\t\t\tflex-wrap: wrap;\n\t\t\t\ta {\n\t\t\t\t\t$size: 170px;\n\t\t\t\t\t$sizeY: $size / 210 * 297;\n\t\t\t\t\t$space: 10px;\n\t\t\t\t\tborder-radius: 3px;\n\t\t\t\t\tborder-radius: var(--border-radius);\n\t\t\t\t\tborder: 1px solid var(--color-border);\n\t\t\t\t\tmargin: $space;\n\t\t\t\t\tposition: relative;\n\n\t\t\t\t\t&:hover,\n\t\t\t\t\t&:focus {\n\t\t\t\t\t\tbackground-color: var(--color-primary-element);\n\t\t\t\t\t\ttransition: all 0.2s ease-out;\n\t\t\t\t\t}\n\n\t\t\t\t\t> span {\n\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\tflex-direction: column;\n\t\t\t\t\t\twidth: $size;\n\t\t\t\t\t\tmargin: $space;\n\t\t\t\t\t\tcursor: pointer;\n\t\t\t\t\t\t> img,\n\t\t\t\t\t\t> span {\n\t\t\t\t\t\t\twidth: $size;\n\t\t\t\t\t\t\theight: $sizeY;\n\t\t\t\t\t\t\tbackground-color: var(--color-background-dark);\n\t\t\t\t\t\t\tbackground-size: 24px;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t> h2 {\n\t\t\t\t\t\t\tmargin-top: $space;\n\t\t\t\t\t\t\tfont-size: inherit;\n\t\t\t\t\t\t\tword-break: break-all;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t.emptyImg {\n\t\t\t\t\tposition: relative;\n\t\t\t\t\t&::before {\n\t\t\t\t\t\tcontent: '';\n\t\t\t\t\t\tposition: absolute;\n\t\t\t\t\t\tbackground-color: #e9e9e9;\n\t\t\t\t\t\twidth: 100%;\n\t\t\t\t\t\theight: 100%;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\t.foldersTab {\n\t\t\twidth: 100%;\n\t\t\tmargin: 35px 10px 30px 10px;\n\t\t\tdisplay: flex;\n    \t\tjustify-content: space-between;\n\t\t\tinput {\n\t\t\t\tdisplay: none;\n\t\t\t\t&:checked + label {\n\t\t\t\t\tcolor: gray;\n\t\t\t\t\tbackground-color: var(--color-border);\n\t\t\t\t\tpointer-events: none;\n\t\t\t\t\tposition: relative;\n\t\t\t\t\t&:after {\n\t\t\t\t\t\tcontent: ' ';\n\t\t\t\t\t\tdisplay: block;\n\t\t\t\t\t\theight: 0;\n\t\t\t\t\t\twidth: 0;\n\t\t\t\t\t\tposition: absolute;\n\t\t\t\t\t\tpointer-events: none;\n\t\t\t\t\t\tborder: 0 solid #fff;\n\t\t\t\t\t\tborder-top-color: var(--color-border);\n\t\t\t\t\t\tborder-width: 15px;\n\t\t\t\t\t\tbottom: -29px;\n\t\t\t\t\t\tleft: 47%;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\t&:not(:checked) + label {\n\t\t\t\t\tfont-weight: normal;\n\t\t\t\t\tcolor: gray;\n\t\t\t\t\tborder: 1px solid var(--color-border);\n\t\t\t\t\t&:hover {\n\t\t\t\t\t\tcolor: gray;\n\t\t\t\t\t\tfont-weight: bold;\n\t\t\t\t\t\tcursor: pointer;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tlabel {\n\t\t\t\twidth: 100%;\n\t\t\t\tdisplay: inline-block;\n\t\t\t\tfont-size: 15px;\n\t\t\t\tfont-weight: bold;\n\t\t\t\ttext-align: center;\n\t\t\t\tpadding: 8px 20px;\n\t\t\t\ttransition: 0.1s;\n\t\t\t}\n\t\t}\n\t}\n}\n"],sourceRoot:""}]),e.a=d},,,,,,,,,,,,,,,,,function(t,e,n){"use strict";e.a="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiIgd2lkdGg9IjE2IiB2ZXJzaW9uPSIxLjEiIGhlaWdodD0iMTYiPjxwYXRoIGZpbGw9IiM0OWFiZWEiIGQ9Im0yLjUgMWMtMC4yOCAwLTAuNSAwLjIyLTAuNSAwLjV2MTNjMCAwLjI4IDAuMjIgMC41IDAuNSAwLjVoMTFjMC4yOCAwIDAuNS0wLjIyIDAuNS0wLjV2LTEwLjVsLTMtM2gtOC41em0xLjUgMmg2djFoLTZ2LTF6bTAgM2g1djFoLTV2LTF6bTAgM2g4djFoLTh2LTF6bTAgM2g0djFoLTR2LTF6Ii8+PC9zdmc+Cg=="},function(t,e,n){"use strict";e.a="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiIgd2lkdGg9IjE2IiB2ZXJzaW9uPSIxLjEiIGhlaWdodD0iMTYiPjxwYXRoIGZpbGw9IiM5YWJkNGUiIGQ9Im0yLjUgMWMtMC4yOCAwLTAuNSAwLjIyLTAuNSAwLjV2MTNjMCAwLjI4IDAuMjIgMC41IDAuNSAwLjVoMTFjMC4yOCAwIDAuNS0wLjIyIDAuNS0wLjV2LTEwLjVsLTMtM2gtOC41em0xLjUgM2gydjJoLTJ2LTJ6bTMgMGg1djJoLTV2LTJ6bS0zIDNoMnYyaC0ydi0yem0zIDBoNXYyaC01di0yem0tMyAzaDJ2MmgtMnYtMnptMyAwaDV2MmgtNXYtMnoiLz48L3N2Zz4K"},function(t,e,n){"use strict";e.a="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiIgaGVpZ2h0PSIxNiIgd2lkdGg9IjE2IiB2ZXJzaW9uPSIxLjEiPjxwYXRoIGZpbGw9IiNmMDk2NWYiIGQ9Im0xLjUgMmMtMC4yNSAwLTAuNSAwLjI1LTAuNSAwLjV2MTFjMCAwLjI1IDAuMjUgMC41IDAuNSAwLjVoMTNjMC4yNSAwIDAuNS0wLjI1IDAuNS0wLjV2LTExYzAtMC4yNS0wLjI1LTAuNS0wLjUtMC41em0wLjUgM2gxMnY2aC0xMnoiLz48L3N2Zz4K"},,,,function(e,n,r){"use strict";var o=r(106),i=r(365),a=p(r(543)),s=p(r(190)),c=p(r(551)),l=p(r(405)),u=p(r(812));r(840);var f=r(242),d=p(r(552));function p(t){return t&&t.__esModule?t:{default:t}}function h(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(t,e)||y(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){g(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function g(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y(t,e){if(t){if("string"==typeof t)return A(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(t,e):void 0}}function A(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var C=new a.default({FRAME_DOCUMENT:function(){return document.getElementById("richdocumentsframe").contentWindow}}),x=function(){document.getElementById("richdocumentsframe").style.maxHeight=window.innerHeight-60+"px"};window.addEventListener("resize",x),window&&window.visualViewport&&visualViewport.addEventListener("resize",x);var w=document.getElementById("hideDownload")&&"true"===document.getElementById("hideDownload").value,E=document.getElementById("isPublic")&&"1"===document.getElementById("isPublic").value,O={open:!1,receivedLoading:!1,isProxyStarting:!1,isCollaboraConfigured:-1!==OC.getCapabilities().richdocuments.config.wopi_url.indexOf("proxy.php")||"object"===b(OC.getCapabilities().richdocuments.collabora)&&0!==OC.getCapabilities().richdocuments.collabora.length,supportedMimes:OC.getCapabilities().richdocuments.mimetypes.concat(OC.getCapabilities().richdocuments.mimetypesNoDefaultOpen),excludeMimeFromDefaultOpen:OC.getCapabilities().richdocuments.mimetypesNoDefaultOpen,hideDownloadMimes:["image/jpeg","image/svg+xml","image/cgm","image/vnd.dxf","image/x-emf","image/x-wmf","image/x-wpg","image/x-freehand","image/bmp","image/png","image/gif","image/tiff","image/jpg","image/jpeg","text/plain","application/pdf"],registerFileActions:function(){var e,n=this,r="Edit with "+OC.getCapabilities().richdocuments.productName,o=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=y(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(O.supportedMimes);try{for(o.s();!(e=o.n()).done;){var i=e.value;OCA.Files.fileActions.register(i,r,OC.PERMISSION_READ,OC.imagePath("core","actions/rename"),(function(t,e){var r=e.fileList.findFile(t),o=null==r?void 0:r.shareOwnerId;return n.onEdit(t,m(m({},e),{},{shareOwnerId:o}))}),t("richdocuments","Edit with {productName}",{productName:OC.getCapabilities().richdocuments.productName},void 0,{escape:!1})),(-1===O.excludeMimeFromDefaultOpen.indexOf(i)||w)&&OCA.Files.fileActions.setDefault(i,r)}}catch(t){o.e(t)}finally{o.f()}},onEdit:function(e,n){if(O.isCollaboraConfigured){if(!0!==O.open){if(O.open=!0,n){var r,a;if("external-session"===(null==n||null===(r=n.$file)||void 0===r?void 0:r.attr("data-mounttype")))return OCP.Toast.error(t("richdocuments","Opening the file is not supported, since the credentials for the external storage are not available without a session"),{timeout:0}),void(O.open=!1);var s=n.dir,l=n.fileId||(null===(a=n.$file)||void 0===a?void 0:a.attr("data-id")),f=n.templateId}u.default.startLoading(),O.receivedLoading=!1;var d=(0,i.getDocumentUrlForFile)(s,l);E&&(d=(0,i.getDocumentUrlForPublicFile)(e,l)),void 0!==f&&(d=(0,i.getDocumentUrlFromTemplate)(f,e,s));n&&function(t,e){var n,r,o,i,a=c.default.open?parseInt(c.default.open.id):-1;if(void 0!==e){var s=e.lastIndexOf("@");-1!==e.substr(s).indexOf("/")&&l!==a&&(n="https://"+e.substr(s)+"/ocs/v2.php/apps/richdocuments/api/v1/federation",r=function(){console.debug("Cannot load federated instance though CSP, navigating to ",OC.generateUrl("/apps/richdocuments/open?fileId="+l)),window.location=OC.generateUrl("/apps/richdocuments/open?fileId="+l)},o=!1,(i=document.createElement("iframe")).style.display="none",i.onload=function(){o=!0},document.body.appendChild(i),i.setAttribute("src",n),setTimeout((function(){o||r(),document.body.removeChild(i)}),1e3))}}(0,null==n?void 0:n.shareOwnerId),$("head").append($('<link rel="stylesheet" type="text/css" href="'+OC.filePath("richdocuments","css","mobile.css")+'"/>')),$('link[href*="richdocuments/css/mobile"]').removeAttr("disabled");var p=$('<iframe id="richdocumentsframe" nonce="'+btoa(OC.requestToken)+'" scrolling="no" allowfullscreen src="'+d+'" />');O.loadingTimeout=setTimeout(O.onTimeout,1e3*OC.getCapabilities().richdocuments.config.timeout||15e3),p.src=d,(OC.appswebroots.richdocumentscode||OC.appswebroots.richdocumentscode_arm64)&&OC.getCapabilities().richdocuments.config.wopi_url.indexOf("proxy.php")>=0&&O.checkProxyStatus(),$("body").css("overscroll-behavior-y","none"),document.querySelector("meta[name=viewport]").setAttribute("content","width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"),E?($("#preview").append(p).css({height:"100%"}),$("body").css({height:"100%"}),$("#content").addClass("full-height"),$("footer").addClass("hidden"),$("#imgframe").addClass("hidden"),$(".directLink").addClass("hidden"),$(".directDownload").addClass("hidden"),$("#controls").addClass("hidden"),$("#content").addClass("loading")):($("body").css("overflow","hidden"),$("#app-content").append(p),p.hide()),$("#app-content #controls").addClass("hidden"),setTimeout((function(){u.default.init({fileName:e,fileId:l,filePath:s,fileList:n?n.fileList:void 0,fileModel:n?n.fileModel:void 0,sendPostMessage:function(t,e){C.sendWOPIPostMessage("FRAME_DOCUMENT",t,e)}}),(0,o.emit)("richdocuments:file-open:started",m({},u.default.loggingContext()))}))}}else $.get(OC.linkToOCS("cloud")+"/capabilities?format=json").then((function(r){if(-1!==OC.getCapabilities().richdocuments.config.wopi_url.indexOf("proxy.php")||"object"===b(r.ocs.data.capabilities.richdocuments.collabora)&&0!==r.ocs.data.capabilities.richdocuments.collabora.length)O.isCollaboraConfigured=!0,O.onEdit(e,n);else{var o=OC.generateUrl("/settings/admin/richdocuments"),i=OC.isUserAdmin()?'<a href="'.concat(o,'">Collabora Online is not setup yet. <br />Click here to configure your own server or connect to a demo server.</a>'):t("richdocuments","Collabora Online is not setup yet. Please contact your administrator.");OCP.Toast?OCP.Toast.error(i,{isHTML:!0,timeout:0}):OC.Notification.showHtml(i)}}))},onReceiveLoading:function(){O.receivedLoading=!0,$("#richdocumentsframe").prop("title","Collabora Online"),$("#richdocumentsframe").show(),$("html, body").scrollTop(0),$("#content").removeClass("loading"),u.default.initAfterReady()},onClose:function(){O.open=!1,clearTimeout(O.loadingTimeout),O.receivedLoading=!1,$('link[href*="richdocuments/css/mobile"]').attr("disabled","disabled"),$("#app-content #controls").removeClass("hidden"),$("#richdocumentsframe").remove(),$(".searchbox").show(),$("body").css("overflow","auto"),E&&($("#content").removeClass("full-height"),$("footer").removeClass("hidden"),$("#imgframe").removeClass("hidden"),$(".directLink").removeClass("hidden"),$(".directDownload").removeClass("hidden")),OC.Util.History.replaceState(),u.default.close()},onTimeout:function(){O.receivedLoading||O.isProxyStarting?O.receivedLoading||(O.loadingTimeout=setTimeout(O.onTimeout,1e3*OC.getCapabilities().richdocuments.config.timeout||15e3)):((0,o.emit)("richdocuments:file-open:failed",m({reason:"timeout"},u.default.loggingContext())),O.onClose(),OC.Notification.showTemporary(t("richdocuments","Failed to load {productName} - please try again later",{productName:OC.getCapabilities().richdocuments.productName||"Collabora Online"})))},checkProxyStatus:function(){var t=OC.getCapabilities().richdocuments.config.wopi_url,e=t.substr(0,t.indexOf("proxy.php")+"proxy.php".length);$.get(e+"?status").done((function(t){t&&t.status&&("OK"===t.status||"error"===t.status?O.isProxyStarting=!1:"starting"!==t.status&&"stopped"!==t.status&&"restarting"!==t.status||(O.isProxyStarting=!0,setTimeout((function(){O.checkProxyStatus()}),1e3)))}))}},I=OC.getCapabilities().richdocuments.config||{};s.default.update("ooxml","ooxml"===I.doc_format),window.OCA.RichDocuments={config:{create:l.default.getFileTypes()},open:function(t){var e=t.path,n=t.fileId,r=t.fileModel,o=t.fileList,i=void 0===o?{}:o,a=h((0,f.splitPath)(e),2),s=a[0],c=a[1];O.onEdit(c,{fileId:n,dir:s,shareOwnerId:r.get("shareOwnerId"),fileList:i,fileModel:r})},openWithTemplate:function(t){var e=t.path,n=t.fileId,r=t.templateId,o=t.fileModel,i=t.fileList,a=void 0===i?{}:i,s=h((0,f.splitPath)(e),2),c=s[0],l=s[1];O.onEdit(l,{fileId:n,dir:c,templateId:r,shareOwnerId:o.get("shareOwnerId"),fileList:a,fileModel:o})},FilesAppIntegration:{registerHandler:u.default.registerHandler.bind(u.default)}},window.addEventListener("DOMContentLoaded",(function(){"undefined"!=typeof OCA&&void 0!==OCA.Files&&void 0!==OCA.Files.fileActions&&(void 0===OCA.Files_Texteditor&&void 0===OCA.Text&&O.supportedMimes.push("text/plain"),O.registerFileActions(),OC.Plugins.register("OCA.Files.NewFileMenu",d.default)),c.default.create&&c.default.create.type&&c.default.create.filename&&u.default.preloadCreate(),c.default.open&&u.default.preloadOpen();var e=E&&-1!==O.supportedMimes.indexOf($("#mimetype").val())&&-1===O.excludeMimeFromDefaultOpen.indexOf($("#mimetype").val()),n=E&&w&&-1!==O.hideDownloadMimes.indexOf($("#mimetype").val());(e||n)&&O.onEdit(document.getElementById("filename").value),C.registerPostMessageHandler((function(e){var n=e.parsed;console.debug("[viewer] Received post message",n);var r=n.msgId,i=n.args;if(!n.deprecated){switch(r){case"loading":O.onReceiveLoading();break;case"Action_Load_Resp":var a;if(null!=i&&i.success)(0,o.emit)("richdocuments:file-open:succeeded",m({},u.default.loggingContext()));else(0,o.emit)("richdocuments:file-open:failed",m({reason:"collabora",collaboraResponse:null==n||null===(a=n.args)||void 0===a?void 0:a.errorMsg},u.default.loggingContext()));break;case"App_LoadingStatus":"Timeout"===i.Status&&((0,o.emit)("richdocuments:file-open:failed",m({reason:"timeout"},u.default.loggingContext())),O.onClose(),OC.Notification.showTemporary(t("richdocuments","Failed to connect to {productName}. Please try again later or contact your server administrator.",{productName:OC.getCapabilities().richdocuments.productName})));break;case"UI_Share":u.default.share();break;case"UI_CreateFile":u.default.createNewFile(i.DocumentType);break;case"UI_InsertGraphic":u.default.insertGraphic((function(t,e){C.sendWOPIPostMessage("FRAME_DOCUMENT","postAsset",{FileName:t,Url:e})}));break;case"File_Rename":u.default.rename(i.NewName);break;case"Action_Save_Resp":u.default.saveAs(i.fileName);break;case"close":O.onClose();break;case"Get_Views_Resp":case"Views_List":u.default.setViews(i);break;case"UI_FileVersions":case"rev-history":u.default.showRevHistory();break;case"App_VersionRestore":"Pre_Restore_Ack"===i.Status&&u.default.restoreVersionExecute()}"View_Added"===r?(u.default.views[i.ViewId]=i,u.default.renderAvatars()):"View_Removed"===r?(delete u.default.views[i.ViewId],u.default.renderAvatars()):"FollowUser_Changed"===r&&(i.IsFollowEditor?u.default.followingEditor=!0:u.default.followingEditor=!1,i.IsFollowUser?u.default.following=i.FollowedViewId:u.default.following=null,u.default.renderAvatars())}}))}))},function(t,e,n){"use strict";n.r(e);var r=n(40),o=n.n(r),i=n(816),a={insert:"head",singleton:!1};o()(i.a,a);e.default=i.a.locals||{}}]);
//# sourceMappingURL=files.js.map